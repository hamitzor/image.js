(()=>{"use strict";var t,e=function(){function t(t,e,n,r){if(void 0===n&&(n=1),this.channelNumber=n,this.width=t,this.height=e,Array.isArray(r)){if(r.length!==t*e*n)throw new Error("Given pixel array does not match the dimension and the channel count.");this.pixels=r}else this.pixels=new Array(t*e*n).fill(r||0)}return t.fromImageData=function(e,n){void 0===n&&(n=1);var r=new Array(e.width*e.height*n);if(n<2)for(var o=function(t){r[t]=[0,1,2].reduce((function(n,r){return n+e.data[4*t+r]}),0)/3},i=0;i<e.width*e.height;i++)o(i);else for(i=0;i<e.width*e.height;i++)for(var s=0;s<n&&s<3;s++)r[i*n+s]=e.data[4*i+s];return new t(e.width,e.height,n,r)},t.prototype.max=function(){return this.pixels.reduce((function(t,e){return t>e?t:e}))},t.prototype.get=function(t,e,n){return void 0===n&&(n=0),this.pixels[(t*this.width+e)*this.channelNumber+n]},t.prototype.set=function(t,e,n,r){void 0===r&&(r=0),this.pixels[(t*this.width+e)*this.channelNumber+r]=n},t.prototype.toImageData=function(){for(var t=new Uint8ClampedArray(this.width*this.height*4),e=0;e<this.width*this.height;e++)t[4*e]=this.pixels[e*this.channelNumber],t[4*e+1]=this.pixels[e*this.channelNumber+(this.channelNumber>1?1:0)],t[4*e+2]=this.pixels[e*this.channelNumber+(this.channelNumber>1?2:0)],t[4*e+3]=255;return new ImageData(t,this.width,this.height)},t.prototype.clone=function(){return new t(this.width,this.height,this.channelNumber,this.pixels.map((function(t){return t})))},t.prototype.toGrayScale=function(){if(this.channelNumber<2)return this.clone();for(var e=new Array(this.width*this.height).fill(0),n=0;n<this.width*this.height;n++){for(var r=0;r<this.channelNumber;r++)e[n]+=this.pixels[n*this.channelNumber+r];e[n]/=this.channelNumber}return new t(this.width,this.height,1,e)},t.prototype.toMultiChannel=function(e){if(this.channelNumber>1)throw new Error("Image is already multi channel");for(var n=new Array(this.width*this.height*e),r=0;r<this.width*this.height;r++)for(var o=0;o<e;o++)n[r*e+o]=this.pixels[r];return new t(this.width,this.height,e,n)},t}(),n=function(){function t(t,e,n){if("number"==typeof t){if("number"!=typeof e)throw new Error("Bad parameters for the constructor.");this.rows=t,this.cols=e,this.data=Array.isArray(n)?n:new Array(t*e).fill(n)}else r=t,Array.isArray(r)&&Array.isArray(r[0])&&(this.cols=t.length,this.rows=t[0].length,this.data=t.reduce((function(t,e){return t.concat(e)}),[]));var r}return t.prototype.get=function(t,e){return this.data[t*this.cols+e]},t.prototype.set=function(t,e,n){this.data[t*this.cols+e]=n},t.prototype.toString=function(){var t="";t+="Matrix ("+this.rows+", "+this.cols+"):";for(var e=0;e<this.rows;e++){t+="\n";for(var n=0;n<this.cols;n++)t+=this.get(e,n)+"\t"}return t},t.prototype.transpose=function(){for(var t=Array(this.rows*this.cols),e=0;e<this.rows;e++)for(var n=0;n<this.cols;n++)t[n*this.rows+e]=this.get(e,n);var r=this.rows;return this.rows=this.cols,this.cols=r,this.data=t,this},t}(),r=function(t,e){return void 0===e&&(e=0),e+Math.floor(Math.random()*Math.floor(t))},o=(t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,o){try{for(var i=new e(t.width,t.height,t.channelNumber),s=0;s<i.height;s++)for(var a=0;a<i.width;a++)for(var p=0;p<n.rows;p++)for(var u=0;u<n.cols;u++)for(var h=0;h<t.channelNumber;h++){var c=t.get(s-((n.rows-1)/2-p),a-((n.cols-1)/2-u),h);c=c||0,i.set(s,a,i.get(s,a,h)+c*n.get(p,u),h)}r(i)}catch(t){o(t)}}))},n}(n),s=function(){function t(t){this.opts={sigma:1,n:5},t&&this.setOpts(t),this.updateFilter()}return t.prototype.setOpts=function(t){if(void 0!==t.n&&("number"!=typeof t.n||t.n<3||t.n%2==0))throw new Error("Kernel size should be an odd number greater than 3");if(void 0!==t.sigma&&t.sigma<=0)throw new Error("Sigma should be a positive real number");this.opts=Object.assign(this.opts,t),this.updateFilter()},t.prototype.updateFilter=function(){var t=this,e=Array.from({length:this.opts.n},(function(){return new Array(t.opts.n).fill(0)})),n=Array.from({length:this.opts.n},(function(e,n){return function(t,e){return void 0===e&&(e=1),1/(e*Math.sqrt(2*Math.PI))*Math.exp(-.5*Math.pow(t/e,2))}(n*(4/(t.opts.n-1))-2,t.opts.sigma)})),r=n.reduce((function(t,e){return t+e}),0);n=n.map((function(t){return t/r}));for(var o=0;o<this.opts.n;o++)for(var s=0;s<this.opts.n;s++)e[o][s]=n[o]*n[s];this.filter=new i(e)},t.prototype.run=function(t){return this.filter.run(t)},t}(),a=function(){function t(){this.dxFilter=new i([[1,0,-1],[2,0,-2],[1,0,-1]])}return t.prototype.run=function(t){return t.channelNumber>1&&(t=t.toGrayScale()),Promise.all([this.dxFilter.run(t),this.dxFilter.transpose().run(t)]).then((function(n){for(var r=n[0],o=n[1],i=new e(t.width,t.height),s=new e(t.width,t.height),a=0;a<t.height;a++)for(var p=0;p<t.width;p++)s.set(a,p,Math.atan2(o.get(a,p),r.get(a,p))),i.set(a,p,Math.sqrt(Math.pow(o.get(a,p),2)+Math.pow(r.get(a,p),2)));return{g:i,theta:s}}))},t}(),p=function(){function t(t){this.opts={lowThresholdRatio:.2,highThresholdRatio:.5,gaussianBlurOpts:{n:5,sigma:1}},t&&this.setOpts(t)}return t.prototype.setOpts=function(t){if(t.gaussianBlurOpts&&(this.opts.gaussianBlurOpts=Object.assign(this.opts.gaussianBlurOpts,t.gaussianBlurOpts),delete t.gaussianBlurOpts),this.opts=Object.assign(this.opts,t),"number"!=typeof this.opts.lowThresholdRatio||"number"!=typeof this.opts.highThresholdRatio)throw new Error("High and low threshold values should be real numbers between 0 and 1");if(this.opts.lowThresholdRatio>=this.opts.highThresholdRatio)throw new Error("Low threshold value should be smaller than high threshold value.")},t.prototype.nonMaximumSuppression=function(t,n){for(var r=new e(t.width,t.height),o=2;o<r.height-2;o++)for(var i=2;i<r.width-2;i++){var s=255,a=255,p=180*n.get(o,i)/Math.PI;p<0&&(p+=180),0<=p&&p<22.5||157.5<=p&&p<=180?(s=t.get(o,i+1),a=t.get(o,i-1)):22.5<=p&&p<67.5?(s=t.get(o+1,i+1),a=t.get(o-1,i-1)):67.5<=p&&p<112.5?(s=t.get(o+1,i),a=t.get(o-1,i)):112.5<=p&&p<157.5&&(s=t.get(o-1,i+1),a=t.get(o+1,i-1)),t.get(o,i)>=s&&t.get(o,i)>=a?r.set(o,i,t.get(o,i)):r.set(o,i,0)}return r},t.prototype.threshold=function(e,n,r){for(var o=e.clone(),i=2;i<o.height-2;i++)for(var s=2;s<o.width-2;s++){var a=o.get(i,s);a<n?o.set(i,s,0):a<r?o.set(i,s,t.WEAK):o.set(i,s,t.STRONG)}return o},t.prototype.hysteresis=function(e){for(var n=2;n<e.height-2;n++)for(var r=2;r<e.width-2;r++)e.get(n,r)===t.WEAK&&(e.get(n-1,r-1)===t.STRONG||e.get(n-1,r)===t.STRONG||e.get(n-1,r+1)===t.STRONG||e.get(n,r-1)===t.STRONG||e.get(n,r+1)===t.STRONG||e.get(n+1,r-1)===t.STRONG||e.get(n+1,r)===t.STRONG||e.get(n+1,r+1)===t.STRONG?e.set(n,r,t.STRONG):e.set(n,r,0));return e},t.prototype.run=function(t){var e=this;return new s(this.opts.gaussianBlurOpts).run(t).then((function(t){return(new a).run(t)})).then((function(n){var r=n.g,o=n.theta,i=t.max()*e.opts.highThresholdRatio,s=i*e.opts.lowThresholdRatio;return e.hysteresis(e.threshold(e.nonMaximumSuppression(r,o),s,i))}))},t}();!function(t){t.WEAK=100,t.STRONG=255}(p||(p={}));var u=function(){function t(t){this.opts={maxIterations:0,clusterNumber:2},t&&this.setOpts(t)}return t.prototype.setOpts=function(t){this.opts=Object.assign(this.opts,t)},t.prototype.run=function(t){var e=this;return new Promise((function(n,o){try{for(var i=Array.from({length:e.opts.clusterNumber},(function(){return new Array(t.dimensionNumber).fill(0)})),s=new Array(t.length).fill(0),a=0,p=0,u=0,h=[],c=function(){var e=r(t.length-1);h.filter((function(n){return n.map((function(n,r){return n-t.get(e,r)})).filter((function(t){return 0===t})).length===n.length})).length<1&&(i[h.length]=i[h.length].map((function(n,r){return t.get(e,r)})),h.push(i[h.length]))};h.length<e.opts.clusterNumber;)c();do{for(var l=!1,d=0;d<t.length;d++){for(var g=0,m=1/0,y=0;y<i.length;y++){for(var f=0,E=0;E<t.dimensionNumber;E++)f+=Math.pow(i[y][E]-t.get(d,E),2);(f=Math.sqrt(f))<m&&(m=f,g=y)}l||s[d]===g||(l=!0),s[d]=g}l?u=0:u++;var w=Array.from({length:e.opts.clusterNumber},(function(){return new Array(t.dimensionNumber).fill(0)}));for(d=0;d<t.length;d++)for(E=0;E<t.dimensionNumber;E++)w[s[d]][E]+=t.get(d,E);w=w.map((function(t,e){return t.map((function(t){return t/s.filter((function(t){return t===e})).length}))}));for(var I=!1,v=0;v<i.length;v++)for(E=0;E<t.dimensionNumber;E++)i[v][E]!==w[v][E]&&(i[v][E]=w[v][E],I=!0);I?p=0:p++,a++}while(!(p>2||u>2||0!==e.opts.maxIterations&&a>e.opts.maxIterations));n({clusters:s,centroids:i})}catch(t){o(t)}}))},t}(),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(e){return t.call(this,e.width,e.height,e.channelNumber,e.pixels)||this}return h(e,t),e.prototype.get=function(t,e){return this.pixels[t*this.channelNumber+e]},Object.defineProperty(e.prototype,"length",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dimensionNumber",{get:function(){return this.channelNumber},enumerable:!1,configurable:!0}),e}(e),l=function(){function t(t){this.opts={byIntensity:!1,colors:3},t&&this.setOpts(t),this.updateKmeans()}return t.prototype.updateKmeans=function(){this.kmeans=new u({clusterNumber:Array.isArray(this.opts.colors)?this.opts.colors.length:this.opts.colors,maxIterations:10})},t.prototype.setOpts=function(t){this.opts=Object.assign(this.opts,t),this.updateKmeans()},t.prototype.run=function(t){var e=this,n=new c(this.opts.byIntensity?t.toGrayScale():t);return this.kmeans.run(n).then((function(t){var r=t.clusters,o=t.centroids,i=e.opts.byIntensity?n.toMultiChannel(3):n;if(Array.isArray(e.opts.colors))for(s=0;s<i.width*i.height;s++)i.pixels[3*s]=e.opts.colors[r[s]][0],i.pixels[3*s+1]=e.opts.colors[r[s]][1],i.pixels[3*s+2]=e.opts.colors[r[s]][2];else for(var s=0;s<i.width*i.height;s++)i.pixels[3*s]=o[r[s]][0],i.pixels[3*s+1]=o[r[s]][e.opts.byIntensity?0:1],i.pixels[3*s+2]=o[r[s]][e.opts.byIntensity?0:2];return i}))},t}(),d=800,g=function(){function t(){var t=this;this.ELS={app:document.getElementById("app"),overlay:document.getElementById("overlay"),input:document.getElementById("input"),imageInput:document.getElementById("imageInput"),loadImage:document.getElementById("loadImage"),loadImage2:document.getElementById("loadImage2"),undo:document.getElementById("undo"),redo:document.getElementById("redo"),grayscale:document.getElementById("grayscale"),sobel:document.getElementById("sobel"),popups:{kernel:{open:document.getElementById("kernelOpen"),popup:document.getElementById("kernelPopup"),size:document.getElementById("kernelOptionsSize"),matrix:document.getElementById("kernelOptionsMatrix"),apply:document.getElementById("kernelApply"),cancel:document.getElementById("kernelCancel"),error:document.getElementById("kernelError"),transpose:document.getElementById("kernelTranspose")},gauss:{open:document.getElementById("gaussOpen"),popup:document.getElementById("gaussPopup"),size:document.getElementById("gaussSize"),sigma:document.getElementById("gaussSigma"),apply:document.getElementById("gaussApply"),cancel:document.getElementById("gaussCancel"),error:document.getElementById("gaussError")},canny:{open:document.getElementById("cannyOpen"),popup:document.getElementById("cannyPopup"),low:document.getElementById("cannyLow"),high:document.getElementById("cannyHigh"),size:document.getElementById("cannyGaussSize"),sigma:document.getElementById("cannyGaussSigma"),apply:document.getElementById("cannyApply"),cancel:document.getElementById("cannyCancel"),error:document.getElementById("cannyError")},segment:{open:document.getElementById("segmentOpen"),popup:document.getElementById("segmentPopup"),number:document.getElementById("segmentNumber"),rgb:document.getElementById("segmentRGB"),intensity:document.getElementById("segmentIntensity"),apply:document.getElementById("segmentApply"),cancel:document.getElementById("segmentCancel"),error:document.getElementById("segmentError")},compress:{open:document.getElementById("compressOpen"),popup:document.getElementById("compressPopup"),depth:document.getElementById("compressDepth"),apply:document.getElementById("compressApply"),cancel:document.getElementById("compressCancel"),error:document.getElementById("compressError")}}},this.gauss=new s,this.canny=new p,this.segmentation=new l,this.compression=new l,this.history=[],this.hide(this.ELS.overlay),Object.keys(this.ELS.popups).forEach((function(e){var n=t.ELS.popups[e];t.hide(n.popup),t.hide(n.error),n.open.onclick=function(){return t.showPopup(n.popup)},n.cancel.onclick=function(){return t.hidePopup(n.popup)}})),this.ELS.undo.onclick=function(){return t.undo()},this.ELS.redo.onclick=function(){return t.redo()},document.addEventListener("keydown",(function(e){e.ctrlKey&&"z"===e.key&&t.undo()})),document.addEventListener("keydown",(function(e){e.ctrlKey&&"y"===e.key&&t.redo()})),this.ELS.grayscale.onclick=function(){t.do((function(){return t.renderImage(t.ELS.input,e.fromImageData(t.getImageData(t.ELS.input)))}))};var n=function(){try{t.hide(t.ELS.popups.gauss.error);var e=parseInt(t.ELS.popups.gauss.size.value,10),n=parseFloat(t.ELS.popups.gauss.sigma.value);t.gauss.setOpts({sigma:n,n:e})}catch(e){t.ELS.popups.gauss.error.innerText=e,t.show(t.ELS.popups.gauss.error)}},o=function(){try{t.hide(t.ELS.popups.canny.error);var e=parseInt(t.ELS.popups.canny.size.value,10),n=parseFloat(t.ELS.popups.canny.sigma.value),r=parseFloat(t.ELS.popups.canny.low.value),o=parseFloat(t.ELS.popups.canny.high.value);t.canny.setOpts({lowThresholdRatio:r,highThresholdRatio:o,gaussianBlurOpts:{n:e,sigma:n}})}catch(e){t.ELS.popups.canny.error.innerText=e,t.show(t.ELS.popups.canny.error)}},u=function(){try{t.hide(t.ELS.popups.segment.error);var e=parseInt(t.ELS.popups.segment.number.value,10);if("number"!=typeof e||!Number.isInteger(e))throw new Error("Segment number should be an integer.");var n=t.ELS.popups.segment.rgb.checked;t.segmentation.setOpts({colors:Array.from({length:e},(function(){return[r(255,10),r(255,10),r(255,10)]})),byIntensity:!n})}catch(e){t.ELS.popups.segment.error.innerText=e,t.show(t.ELS.popups.segment.error)}};this.ELS.popups.compress.depth.onkeyup=function(){try{t.hide(t.ELS.popups.compress.error);var e=parseInt(t.ELS.popups.compress.depth.value,10);if("number"!=typeof e||!Number.isInteger(e))throw new Error("Color depth should be an integer.");t.compression.setOpts({colors:Math.pow(2,e)})}catch(e){t.ELS.popups.compress.error.innerText=e,t.show(t.ELS.popups.compress.error)}},this.ELS.popups.segment.number.onkeyup=u,this.ELS.popups.segment.rgb.onchange=u,this.ELS.popups.segment.intensity.onchange=u,this.ELS.popups.canny.sigma.onkeyup=o,this.ELS.popups.canny.size.onkeyup=o,this.ELS.popups.canny.low.onkeyup=o,this.ELS.popups.canny.high.onkeyup=o,this.ELS.popups.gauss.sigma.onkeyup=n,this.ELS.popups.gauss.size.onkeyup=n,this.ELS.popups.kernel.transpose.onclick=function(){t.kernel.matrix.transpose();for(var e=0;e<t.kernel.size;e++)for(var n=0;n<t.kernel.size;n++)document.getElementById("kernelCell_"+e+"_"+n).value=""+t.kernel.matrix.get(e,n)},this.ELS.popups.kernel.size.onkeyup=function(){t.hide(t.ELS.popups.kernel.error);var e=parseInt(t.ELS.popups.kernel.size.value,10);if("number"!=typeof e||e%2==0||e<3)return t.ELS.popups.kernel.error.innerText="Kernel size should be an odd number greater than 3.",void t.show(t.ELS.popups.kernel.error);var n=new i(e,e,0);n.set((e-1)/2,(e-1)/2,1),t.kernel={matrix:n,size:e},t.ELS.popups.kernel.matrix.innerHTML="";for(var r=function(r){t.ELS.popups.kernel.matrix.appendChild(t.createElement('\n                <div class="d-flex">\n                    '+new Array(e).fill(void 0).map((function(t,e){return'<div>\n                            <input id="kernelCell_'+r+"_"+e+'" type="text" class="form-control text-center" onchange="" value="'+n.get(r,e)+'">\n                        </div>'})).join("")+"\n                </div>\n            "))},o=0;o<e;o++)r(o);var s=function(t){for(var r=function(e){var r=document.getElementById("kernelCell_"+t+"_"+e);r&&(r.onchange=function(){n.set(t,e,parseFloat(r.value))})},o=0;o<e;o++)r(o)};for(o=0;o<e;o++)s(o)},this.ELS.popups.compress.apply.onclick=function(){t.hidePopup(t.ELS.popups.compress.popup),t.compression.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.segment.apply.onclick=function(){t.hidePopup(t.ELS.popups.segment.popup),u(),t.segmentation.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.kernel.apply.onclick=function(){t.hidePopup(t.ELS.popups.kernel.popup),t.kernel.matrix.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.gauss.apply.onclick=function(){t.hidePopup(t.ELS.popups.gauss.popup),t.gauss.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.sobel.onclick=function(){t.hidePopup(t.ELS.popups.gauss.popup),(new a).run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){var n=e.g;return t.do((function(){return t.renderImage(t.ELS.input,n)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.canny.apply.onclick=function(){t.hidePopup(t.ELS.popups.canny.popup),t.canny.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.kernel.size.dispatchEvent(new Event("keyup")),this.ELS.popups.gauss.size.dispatchEvent(new Event("keyup")),this.ELS.popups.segment.number.dispatchEvent(new Event("keyup")),this.ELS.popups.compress.depth.dispatchEvent(new Event("keyup")),[this.ELS.input].forEach((function(e){e.width=d,e.height=d,e.onwheel=function(t){var n;null===(n=e.getContext("2d"))||void 0===n||n.scale(2,2)},t.clearCanvas(e)})),this.ELS.loadImage.onclick=function(){return t.ELS.imageInput.click()},this.ELS.loadImage2.onclick=function(){return t.ELS.imageInput.click()},this.ELS.imageInput.onchange=function(){var n;t.ELS.grayscale.disabled=!1,t.ELS.sobel.disabled=!1,t.ELS.loadImage2.style.display="none",Object.keys(t.ELS.popups).forEach((function(e){t.ELS.popups[e].open.disabled=!1}));var r=null===(n=t.ELS.imageInput.files)||void 0===n?void 0:n[0],o=new FileReader;o.readAsDataURL(r),o.onload=function(){var n=document.createElement("img");n.src=o.result.toString(),n.onload=function(){t.imageWidth=n.naturalWidth,t.imageHeight=n.naturalHeight,(t.imageWidth>d||t.imageHeight>d)&&(t.imageWidth>t.imageHeight?(t.imageHeight=t.imageHeight*(d/t.imageWidth),t.imageWidth=d):(t.imageWidth=t.imageWidth*(d/t.imageHeight),t.imageHeight=d)),t.renderImage(t.ELS.input,n),t.history=[e.fromImageData(t.getImageData(t.ELS.input),3)],t.historyIndex=0,t.ELS.imageInput.value=""}}}}return t.prototype.createElement=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},t.prototype.show=function(t){null==t||t.classList.remove("hidden")},t.prototype.hide=function(t){null==t||t.classList.add("hidden")},t.prototype.showPopup=function(t){this.show(t),this.show(this.ELS.overlay)},t.prototype.hidePopup=function(t){this.hide(t),this.hide(this.ELS.overlay)},t.prototype.do=function(t){this.historyIndex!==this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),t(),this.history.push(e.fromImageData(this.getImageData(this.ELS.input),3)),this.historyIndex++,this.ELS.redo.disabled=!0,this.ELS.undo.disabled=!1},t.prototype.undo=function(){this.historyIndex>0?(this.historyIndex--,this.renderImage(this.ELS.input,this.history[this.historyIndex]),this.historyIndex<1&&(this.ELS.undo.disabled=!0),this.historyIndex<this.history.length-1&&(this.ELS.redo.disabled=!1)):new Audio("https://mygit.th-deg.de/hz29287/image.js/-/blob/master/public/alert.mp3").play()},t.prototype.redo=function(){this.historyIndex<this.history.length-1?(this.historyIndex++,this.renderImage(this.ELS.input,this.history[this.historyIndex]),this.historyIndex===this.history.length-1&&(this.ELS.redo.disabled=!0),this.historyIndex>0&&(this.ELS.undo.disabled=!1)):new Audio("/alert.mp3").play()},t.prototype.clearCanvas=function(t){var e=t.getContext("2d");e.fillStyle="#ccc",e.fillRect(0,0,t.width,t.height)},t.prototype.getImageData=function(t){return t.getContext("2d").getImageData((d-this.imageWidth)/2,(d-this.imageHeight)/2,this.imageWidth,this.imageHeight)},t.prototype.renderImage=function(t,e){this.clearCanvas(t);var n=t.getContext("2d"),r=(d-this.imageWidth)/2,o=(d-this.imageHeight)/2;e instanceof HTMLImageElement?n.drawImage(e,r,o,this.imageWidth,this.imageHeight):n.putImageData(e.toImageData(),r,o)},t}();document.addEventListener("DOMContentLoaded",(function(){var t=new g;window.app=t}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9pbWFnZS50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9tYXRyaXgudHMiLCJ3ZWJwYWNrOi8vaW1hZ2UuanMvLi9zcmMvdXRpbC50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9maWx0ZXIudHMiLCJ3ZWJwYWNrOi8vaW1hZ2UuanMvLi9zcmMvZmVhdHVyZS50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9rLW1lYW5zLnRzIiwid2VicGFjazovL2ltYWdlLmpzLy4vc3JjL3NlZ21lbnRhdGlvbi50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL2V4YW1wbGVzL2RlbW8udHMiXSwibmFtZXMiOlsid2lkdGgiLCJoZWlnaHQiLCJjaGFubmVsTnVtYmVyIiwiZmlsbCIsInRoaXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJFcnJvciIsInBpeGVscyIsImZyb21JbWFnZURhdGEiLCJpbWFnZURhdGEiLCJpIiwicmVkdWNlIiwiYWNjIiwiaiIsImRhdGEiLCJjIiwiQml0bWFwIiwibWF4IiwidmFsIiwiZ2V0IiwiY2hhbm5lbElkeCIsInNldCIsInRvSW1hZ2VEYXRhIiwiVWludDhDbGFtcGVkQXJyYXkiLCJJbWFnZURhdGEiLCJjbG9uZSIsIm1hcCIsIngiLCJ0b0dyYXlTY2FsZSIsInRvTXVsdGlDaGFubmVsIiwiYXJnMSIsImFyZzIiLCJhcmczIiwicm93cyIsImNvbHMiLCJjb25jYXQiLCJ0b1N0cmluZyIsInN0ciIsInRyYW5zcG9zZSIsInJlc3VsdCIsInJhbmRvbSIsIm1pbiIsIk1hdGgiLCJmbG9vciIsInJ1biIsInNvdXJjZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZmlsdGVyZWQiLCJtIiwibiIsIm5laWdoYm9yUGl4ZWwiLCJlcnIiLCJNYXRyaXgiLCJvcHRzIiwic2lnbWEiLCJzZXRPcHRzIiwidXBkYXRlRmlsdGVyIiwidW5kZWZpbmVkIiwiT2JqZWN0IiwiYXNzaWduIiwibWF0cml4IiwiZnJvbSIsImRpc3QiLCJfIiwic3FydCIsIlBJIiwiZXhwIiwicG93IiwiZ2F1c3NpYW4iLCJzdW0iLCJ5IiwiZmlsdGVyIiwiQmFzaWNGaWx0ZXIiLCJkeEZpbHRlciIsImFsbCIsInRoZW4iLCJneCIsImd5IiwiZyIsInRoZXRhIiwiYXRhbjIiLCJsb3dUaHJlc2hvbGRSYXRpbyIsImhpZ2hUaHJlc2hvbGRSYXRpbyIsImdhdXNzaWFuQmx1ck9wdHMiLCJub25NYXhpbXVtU3VwcHJlc3Npb24iLCJ0aGlubmVkRWRnZXMiLCJhIiwiYiIsImFuZ2xlIiwidGhyZXNob2xkIiwibG93IiwiaGlnaCIsInJlcyIsInBpeGVsIiwiQ2FubnkiLCJXRUFLIiwiU1RST05HIiwiaHlzdGVyZXNpcyIsIkdhdXNzaWFuQmx1ciIsIlNvYmVsIiwiaGlnaFRocmVzaG9sZCIsImxvd1RocmVzaG9sZCIsIm1heEl0ZXJhdGlvbnMiLCJjbHVzdGVyTnVtYmVyIiwic2FtcGxlcyIsImNlbnRyb2lkcyIsImRpbWVuc2lvbk51bWJlciIsIm51bWJlck9mSXRlcmF0aW9ucyIsImNlbnRyb2lkc0RvTm90Q2hhbmdlRm9yIiwiY2x1c3RlcnNEb05vdENoYW5nZUZvciIsInJhbmRvbUNlbnRyb2lkcyIsInJhbmRJZHgiLCJjZW50cm9pZCIsInYiLCJkIiwicHVzaCIsImNsdXN0ZXJDaGFuZ2VkIiwic2FtcGxlSWR4IiwiY2xvc2VzdENlbnRyb2lkSWR4IiwiY2xvc2VzdENlbnRyb2lkRGlzdGFuY2UiLCJJbmZpbml0eSIsImNsdXN0ZXJJZHgiLCJkaXN0YW5jZSIsIm5ld0NlbnRyb2lkcyIsImlkeCIsImNlbnRyb2lkc0NoYW5nZWQiLCJjZW50cm9pZElkeCIsImNsdXN0ZXJzIiwiaW1hZ2UiLCJkaW1lbnNpb24iLCJieUludGVuc2l0eSIsImNvbG9ycyIsInVwZGF0ZUttZWFucyIsImttZWFucyIsIktNZWFucyIsIktNZWFuc1NlZ21lbnRhdGlvbkJpdG1hcCIsIkNBTlZBU19TSVpFIiwiRUxTIiwiYXBwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm92ZXJsYXkiLCJpbnB1dCIsImltYWdlSW5wdXQiLCJsb2FkSW1hZ2UiLCJsb2FkSW1hZ2UyIiwidW5kbyIsInJlZG8iLCJncmF5c2NhbGUiLCJzb2JlbCIsInBvcHVwcyIsImtlcm5lbCIsIm9wZW4iLCJwb3B1cCIsInNpemUiLCJhcHBseSIsImNhbmNlbCIsImVycm9yIiwiZ2F1c3MiLCJjYW5ueSIsInNlZ21lbnQiLCJudW1iZXIiLCJyZ2IiLCJpbnRlbnNpdHkiLCJjb21wcmVzcyIsImRlcHRoIiwic2VnbWVudGF0aW9uIiwiS01lYW5zU2VnbWVudGF0aW9uIiwiY29tcHJlc3Npb24iLCJoaXN0b3J5IiwiaGlkZSIsImtleXMiLCJmb3JFYWNoIiwibmFtZSIsImVscyIsIm9uY2xpY2siLCJzaG93UG9wdXAiLCJoaWRlUG9wdXAiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJjdHJsS2V5Iiwia2V5IiwiZG8iLCJyZW5kZXJJbWFnZSIsImdldEltYWdlRGF0YSIsIm9uR2F1c3NDaGFuZ2UiLCJwYXJzZUludCIsInZhbHVlIiwicGFyc2VGbG9hdCIsImlubmVyVGV4dCIsInNob3ciLCJvbkNhbm55Q2hhbmdlIiwib25TZWdtZW50Q2hhbmdlIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiY2hlY2tlZCIsIm9ua2V5dXAiLCJvbmNoYW5nZSIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiY3JlYXRlRWxlbWVudCIsImpvaW4iLCJlbCIsImNhdGNoIiwiYWxlcnQiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJjYW52YXMiLCJvbndoZWVsIiwiZSIsImdldENvbnRleHQiLCJzY2FsZSIsImNsZWFyQ2FudmFzIiwiY2xpY2siLCJkaXNhYmxlZCIsInN0eWxlIiwiZGlzcGxheSIsImZpbGUiLCJmaWxlcyIsImZpbGVSZWFkZXIiLCJGaWxlUmVhZGVyIiwicmVhZEFzRGF0YVVSTCIsIm9ubG9hZCIsImltZyIsInNyYyIsImltYWdlV2lkdGgiLCJuYXR1cmFsV2lkdGgiLCJpbWFnZUhlaWdodCIsIm5hdHVyYWxIZWlnaHQiLCJoaXN0b3J5SW5kZXgiLCJodG1sIiwiZGl2IiwidHJpbSIsImZpcnN0Q2hpbGQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJjYiIsInNsaWNlIiwiQXVkaW8iLCJwbGF5IiwiY3R4IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJkeCIsImR5IiwiSFRNTEltYWdlRWxlbWVudCIsImRyYXdJbWFnZSIsInB1dEltYWdlRGF0YSIsImRlbW8iLCJEZW1vQXBwIiwid2luZG93Il0sIm1hcHBpbmdzIjoibUJBY0EsSSxFQUFBLGFBOEJJLFdBQVlBLEVBQWVDLEVBQWdCQyxFQUFtQkMsR0FJMUQsUUFKdUMsSUFBQUQsTUFBQSxHQUN2Q0UsS0FBS0YsY0FBZ0JBLEVBQ3JCRSxLQUFLSixNQUFRQSxFQUNiSSxLQUFLSCxPQUFTQSxFQUNWSSxNQUFNQyxRQUFRSCxHQUFPLENBQ3JCLEdBQUlBLEVBQUtJLFNBQVdQLEVBQVFDLEVBQVNDLEVBQ2pDLE1BQU0sSUFBSU0sTUFBTSx5RUFFcEJKLEtBQUtLLE9BQVNOLE9BRWRDLEtBQUtLLE9BQVMsSUFBSUosTUFBTUwsRUFBUUMsRUFBU0MsR0FBZUMsS0FBS0EsR0FBYyxHQXdIdkYsT0E5R1csRUFBQU8sY0FBUCxTQUFxQkMsRUFBc0JULFFBQUEsSUFBQUEsTUFBQSxHQUN2QyxJQUFNTyxFQUFTLElBQUlKLE1BQU1NLEVBQVVYLE1BQVFXLEVBQVVWLE9BQVNDLEdBRTlELEdBQUlBLEVBQWdCLEVBRWhCLEksZUFBU1UsR0FDTEgsRUFBT0csR0FBSyxDQUFDLEVBQUcsRUFBRyxHQUFHQyxRQUFPLFNBQUNDLEVBQUtDLEdBQU0sT0FBQUQsRUFBTUgsRUFBVUssS0FBUyxFQUFKSixFQUFRRyxLQUFJLEdBQUssR0FEMUVILEVBQUksRUFBR0EsRUFBSUQsRUFBVVgsTUFBUVcsRUFBVVYsT0FBUVcsSSxFQUEvQ0EsUUFJVCxJQUFTQSxFQUFJLEVBQUdBLEVBQUlELEVBQVVYLE1BQVFXLEVBQVVWLE9BQVFXLElBQ3BELElBQUssSUFBSUssRUFBSSxFQUFHQSxFQUFJZixHQUFpQmUsRUFBSSxFQUFHQSxJQUN4Q1IsRUFBT0csRUFBSVYsRUFBZ0JlLEdBQUtOLEVBQVVLLEtBQVMsRUFBSkosRUFBUUssR0FJbkUsT0FBTyxJQUFJQyxFQUFPUCxFQUFVWCxNQUFPVyxFQUFVVixPQUFRQyxFQUFlTyxJQU94RSxZQUFBVSxJQUFBLFdBQ0ksT0FBT2YsS0FBS0ssT0FBT0ksUUFBTyxTQUFDTSxFQUFLQyxHQUFRLE9BQUFELEVBQU1DLEVBQU1ELEVBQU1DLE1BVTlELFlBQUFDLElBQUEsU0FBSVQsRUFBV0csRUFBV08sR0FDdEIsWUFEc0IsSUFBQUEsTUFBQSxHQUNmbEIsS0FBS0ssUUFBUUcsRUFBSVIsS0FBS0osTUFBUWUsR0FBS1gsS0FBS0YsY0FBZ0JvQixJQVVuRSxZQUFBQyxJQUFBLFNBQUlYLEVBQVdHLEVBQVdLLEVBQWFFLFFBQUEsSUFBQUEsTUFBQSxHQUNuQ2xCLEtBQUtLLFFBQVFHLEVBQUlSLEtBQUtKLE1BQVFlLEdBQUtYLEtBQUtGLGNBQWdCb0IsR0FBY0YsR0FPMUUsWUFBQUksWUFBQSxXQUVJLElBREEsSUFBTVIsRUFBTyxJQUFJUyxrQkFBa0JyQixLQUFLSixNQUFRSSxLQUFLSCxPQUFTLEdBQ3JEVyxFQUFJLEVBQUdBLEVBQUlSLEtBQUtKLE1BQVFJLEtBQUtILE9BQVFXLElBQzFDSSxFQUFTLEVBQUpKLEdBQVNSLEtBQUtLLE9BQU9HLEVBQUlSLEtBQUtGLGVBR25DYyxFQUFTLEVBQUpKLEVBQVEsR0FBS1IsS0FBS0ssT0FBT0csRUFBSVIsS0FBS0YsZUFBaUJFLEtBQUtGLGNBQWdCLEVBQUksRUFBSSxJQUNyRmMsRUFBUyxFQUFKSixFQUFRLEdBQUtSLEtBQUtLLE9BQU9HLEVBQUlSLEtBQUtGLGVBQWlCRSxLQUFLRixjQUFnQixFQUFJLEVBQUksSUFFckZjLEVBQVMsRUFBSkosRUFBUSxHQUFLLElBRXRCLE9BQU8sSUFBSWMsVUFBVVYsRUFBTVosS0FBS0osTUFBT0ksS0FBS0gsU0FPaEQsWUFBQTBCLE1BQUEsV0FDSSxPQUFPLElBQUlULEVBQU9kLEtBQUtKLE1BQU9JLEtBQUtILE9BQVFHLEtBQUtGLGNBQWVFLEtBQUtLLE9BQU9tQixLQUFJLFNBQUFDLEdBQUssT0FBQUEsT0FPeEYsWUFBQUMsWUFBQSxXQUNJLEdBQUkxQixLQUFLRixjQUFnQixFQUNyQixPQUFPRSxLQUFLdUIsUUFJaEIsSUFEQSxJQUFNbEIsRUFBUyxJQUFJSixNQUFNRCxLQUFLSixNQUFRSSxLQUFLSCxRQUFRRSxLQUFLLEdBQy9DUyxFQUFJLEVBQUdBLEVBQUlSLEtBQUtKLE1BQVFJLEtBQUtILE9BQVFXLElBQUssQ0FDL0MsSUFBSyxJQUFJSyxFQUFJLEVBQUdBLEVBQUliLEtBQUtGLGNBQWVlLElBQ3BDUixFQUFPRyxJQUFNUixLQUFLSyxPQUFPRyxFQUFJUixLQUFLRixjQUFnQmUsR0FFdERSLEVBQU9HLElBQU1SLEtBQUtGLGNBRXRCLE9BQU8sSUFBSWdCLEVBQU9kLEtBQUtKLE1BQU9JLEtBQUtILE9BQVEsRUFBR1EsSUFPbEQsWUFBQXNCLGVBQUEsU0FBZTdCLEdBRVgsR0FBSUUsS0FBS0YsY0FBZ0IsRUFDckIsTUFBTSxJQUFJTSxNQUFNLGtDQUdwQixJQURBLElBQU1DLEVBQVMsSUFBSUosTUFBTUQsS0FBS0osTUFBUUksS0FBS0gsT0FBU0MsR0FDM0NVLEVBQUksRUFBR0EsRUFBSVIsS0FBS0osTUFBUUksS0FBS0gsT0FBUVcsSUFDMUMsSUFBSyxJQUFJSyxFQUFJLEVBQUdBLEVBQUlmLEVBQWVlLElBQy9CUixFQUFPRyxFQUFJVixFQUFnQmUsR0FBS2IsS0FBS0ssT0FBT0csR0FHcEQsT0FBTyxJQUFJTSxFQUFPZCxLQUFLSixNQUFPSSxLQUFLSCxPQUFRQyxFQUFlTyxJQUVsRSxFQWhLQSxHQ1BBLGFBK0JJLFdBQVl1QixFQUEyQ0MsRUFBZUMsR0FDbEUsR0FBb0IsaUJBQVRGLEVBQW1CLENBQzFCLEdBQW9CLGlCQUFUQyxFQUtQLE1BQU0sSUFBSXpCLE1BQU0sdUNBSmhCSixLQUFLK0IsS0FBT0gsRUFDWjVCLEtBQUtnQyxLQUFPSCxFQUNaN0IsS0FBS1ksS0FBT1gsTUFBTUMsUUFBUTRCLEdBQVFBLEVBQU8sSUFBSTdCLE1BQU0yQixFQUFPQyxHQUFNOUIsS0FBSytCLFFBM0N6RGQsRUErQ09ZLEVBOUN4QjNCLE1BQU1DLFFBQVFjLElBQVFmLE1BQU1DLFFBQVFjLEVBQUksTUErQ3ZDaEIsS0FBS2dDLEtBQU9KLEVBQUt6QixPQUNqQkgsS0FBSytCLEtBQU9ILEVBQUssR0FBR3pCLE9BQ3BCSCxLQUFLWSxLQUFPZ0IsRUFBS25CLFFBQU8sU0FBQ0MsRUFBS00sR0FBUSxPQUFBTixFQUFJdUIsT0FBT2pCLEtBQU0sS0FsRG5FLElBQTRCQSxFQTJHNUIsT0EvQ0ksWUFBQUMsSUFBQSxTQUFJVCxFQUFXRyxHQUNYLE9BQU9YLEtBQUtZLEtBQUtKLEVBQUlSLEtBQUtnQyxLQUFPckIsSUFTckMsWUFBQVEsSUFBQSxTQUFJWCxFQUFXRyxFQUFXSyxHQUN0QmhCLEtBQUtZLEtBQUtKLEVBQUlSLEtBQUtnQyxLQUFPckIsR0FBS0ssR0FPbkMsWUFBQWtCLFNBQUEsV0FDSSxJQUFJQyxFQUFNLEdBQ1ZBLEdBQU8sV0FBV25DLEtBQUsrQixLQUFJLEtBQUsvQixLQUFLZ0MsS0FBSSxLQUN6QyxJQUFLLElBQUl4QixFQUFJLEVBQUdBLEVBQUlSLEtBQUsrQixLQUFNdkIsSUFBSyxDQUNoQzJCLEdBQU8sS0FDUCxJQUFLLElBQUl4QixFQUFJLEVBQUdBLEVBQUlYLEtBQUtnQyxLQUFNckIsSUFDM0J3QixHQUFVbkMsS0FBS2lCLElBQUlULEVBQUdHLEdBQUUsS0FHaEMsT0FBT3dCLEdBT1gsWUFBQUMsVUFBQSxXQUVJLElBREEsSUFBTUMsRUFBU3BDLE1BQU1ELEtBQUsrQixLQUFPL0IsS0FBS2dDLE1BQzdCeEIsRUFBSSxFQUFHQSxFQUFJUixLQUFLK0IsS0FBTXZCLElBQzNCLElBQUssSUFBSUcsRUFBSSxFQUFHQSxFQUFJWCxLQUFLZ0MsS0FBTXJCLElBQzNCMEIsRUFBTzFCLEVBQUlYLEtBQUsrQixLQUFPdkIsR0FBS1IsS0FBS2lCLElBQUlULEVBQUdHLEdBR2hELElBQU1vQixFQUFPL0IsS0FBSytCLEtBSWxCLE9BSEEvQixLQUFLK0IsS0FBTy9CLEtBQUtnQyxLQUNqQmhDLEtBQUtnQyxLQUFPRCxFQUNaL0IsS0FBS1ksS0FBT3lCLEVBQ0xyQyxNQUVmLEVBcEdBLEdDRGFzQyxFQUFTLFNBQUN2QixFQUFhd0IsR0FBWSxZQUFaLElBQUFBLE1BQUEsR0FBWUEsRUFBTUMsS0FBS0MsTUFBTUQsS0FBS0YsU0FBV0UsS0FBS0MsTUFBTTFCLEssMFVDRTVGLDJCLCtDQWtDQSxPQWxDaUMsT0FPN0IsWUFBQTJCLElBQUEsU0FBSUMsR0FBSixXQUNJLE9BQU8sSUFBSUMsU0FBUSxTQUFDQyxFQUFTQyxHQUN6QixJQUlJLElBRkEsSUFBTUMsRUFBVyxJQUFJakMsRUFBTzZCLEVBQU8vQyxNQUFPK0MsRUFBTzlDLE9BQVE4QyxFQUFPN0MsZUFFdkRVLEVBQUksRUFBR0EsRUFBSXVDLEVBQVNsRCxPQUFRVyxJQUNqQyxJQUFLLElBQUlHLEVBQUksRUFBR0EsRUFBSW9DLEVBQVNuRCxNQUFPZSxJQUNoQyxJQUFLLElBQUlxQyxFQUFJLEVBQUdBLEVBQUksRUFBS2pCLEtBQU1pQixJQUMzQixJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSSxFQUFLakIsS0FBTWlCLElBRTNCLElBQUssSUFBSXBDLEVBQUksRUFBR0EsRUFBSThCLEVBQU83QyxjQUFlZSxJQUFLLENBQzNDLElBQUlxQyxFQUFnQlAsRUFBTzFCLElBQUlULElBQU0sRUFBS3VCLEtBQU8sR0FBSyxFQUFJaUIsR0FBSXJDLElBQU0sRUFBS3FCLEtBQU8sR0FBSyxFQUFJaUIsR0FBSXBDLEdBRTdGcUMsRUFBZ0JBLEdBQWdDLEVBQ2hESCxFQUFTNUIsSUFBSVgsRUFBR0csRUFBR29DLEVBQVM5QixJQUFJVCxFQUFHRyxFQUFHRSxHQUFLcUMsRUFBZ0IsRUFBS2pDLElBQUkrQixFQUFHQyxHQUFJcEMsR0FNL0ZnQyxFQUFRRSxHQUNWLE1BQU9JLEdBQ0xMLEVBQU9LLFFBSXZCLEVBbENBLENBQWlDQyxHQXVDakMsYUFpQkksV0FBWUMsR0FaSixLQUFBQSxLQUFvQyxDQUFFQyxNQUFPLEVBQUdMLEVBQUcsR0FhbkRJLEdBQ0FyRCxLQUFLdUQsUUFBUUYsR0FFakJyRCxLQUFLd0QsZUF1RGIsT0FoREksWUFBQUQsUUFBQSxTQUFRRixHQUNKLFFBQWVJLElBQVhKLEVBQUtKLElBQXNDLGlCQUFYSSxFQUFLSixHQUFrQkksRUFBS0osRUFBSSxHQUFLSSxFQUFLSixFQUFJLEdBQU0sR0FDcEYsTUFBTSxJQUFJN0MsTUFBTSxzREFHcEIsUUFBbUJxRCxJQUFmSixFQUFLQyxPQUF1QkQsRUFBS0MsT0FBUyxFQUMxQyxNQUFNLElBQUlsRCxNQUFNLDBDQUdwQkosS0FBS3FELEtBQU9LLE9BQU9DLE9BQU8zRCxLQUFLcUQsS0FBTUEsR0FHckNyRCxLQUFLd0QsZ0JBT0QsWUFBQUEsYUFBUixzQkFFVUksRUFBcUIzRCxNQUFNNEQsS0FBSyxDQUFFMUQsT0FBUUgsS0FBS3FELEtBQUtKLElBQUssV0FBTSxXQUFJaEQsTUFBTSxFQUFLb0QsS0FBS0osR0FBR2xELEtBQUssTUFHN0YrRCxFQUFPN0QsTUFBTTRELEtBQUssQ0FBRTFELE9BQVFILEtBQUtxRCxLQUFLSixJQUFLLFNBQUNjLEVBQUd0QyxHQUFNLE9EckZ6QyxTQUFDQSxFQUFXNkIsR0FBYyxZQUFkLElBQUFBLE1BQUEsR0FBZSxHQUFLQSxFQUFRZCxLQUFLd0IsS0FBSyxFQUFJeEIsS0FBS3lCLEtBQVF6QixLQUFLMEIsS0FBSyxHQUFNMUIsS0FBSzJCLElBQUkxQyxFQUFJNkIsRUFBTyxJQ3FGOURjLENBQWMzQyxHQUFLLEdBQUssRUFBSzRCLEtBQUtKLEVBQUksSUFBNUIsRUFBaUMsRUFBS0ksS0FBS0MsVUFHeEdlLEVBQU1QLEVBQUtyRCxRQUFPLFNBQUNDLEVBQUtNLEdBQVEsT0FBQU4sRUFBTU0sSUFBSyxHQUNqRDhDLEVBQU9BLEVBQUt0QyxLQUFJLFNBQUFDLEdBQUssT0FBQUEsRUFBSTRDLEtBSXpCLElBQUssSUFBSTVDLEVBQUksRUFBR0EsRUFBSXpCLEtBQUtxRCxLQUFLSixFQUFHeEIsSUFDN0IsSUFBSyxJQUFJNkMsRUFBSSxFQUFHQSxFQUFJdEUsS0FBS3FELEtBQUtKLEVBQUdxQixJQUM3QlYsRUFBT25DLEdBQUc2QyxHQUFLUixFQUFLckMsR0FBS3FDLEVBQUtRLEdBR3RDdEUsS0FBS3VFLE9BQVMsSUFBSUMsRUFBWVosSUFRbEMsWUFBQWxCLElBQUEsU0FBSUMsR0FDQSxPQUFPM0MsS0FBS3VFLE9BQU83QixJQUFJQyxJQUUvQixFQTVFQSxHQWlHQSxhQVVJLGFBQ0kzQyxLQUFLeUUsU0FBVyxJQUFJRCxFQUFZLENBQzVCLENBQUMsRUFBRyxHQUFJLEdBQ1IsQ0FBQyxFQUFHLEdBQUksR0FDUixDQUFDLEVBQUcsR0FBSSxLQWtDcEIsT0F6QkksWUFBQTlCLElBQUEsU0FBSUMsR0FNQSxPQUpJQSxFQUFPN0MsY0FBZ0IsSUFDdkI2QyxFQUFTQSxFQUFPakIsZUFHYmtCLFFBQVE4QixJQUFJLENBQ2YxRSxLQUFLeUUsU0FBUy9CLElBQUlDLEdBQ2xCM0MsS0FBS3lFLFNBQVNyQyxZQUFZTSxJQUFJQyxLQUMvQmdDLE1BQUssU0FBQyxHQU9MLEksSUFQTUMsRUFBRSxLQUFFQyxFQUFFLEtBRU5DLEVBQUksSUFBSWhFLEVBQU82QixFQUFPL0MsTUFBTytDLEVBQU85QyxRQUVwQ2tGLEVBQVEsSUFBSWpFLEVBQU82QixFQUFPL0MsTUFBTytDLEVBQU85QyxRQUdyQ1csRUFBSSxFQUFHQSxFQUFJbUMsRUFBTzlDLE9BQVFXLElBQy9CLElBQUssSUFBSUcsRUFBSSxFQUFHQSxFQUFJZ0MsRUFBTy9DLE1BQU9lLElBQzlCb0UsRUFBTTVELElBQUlYLEVBQUdHLEVBQUc2QixLQUFLd0MsTUFBTUgsRUFBRzVELElBQUlULEVBQUdHLEdBQUlpRSxFQUFHM0QsSUFBSVQsRUFBR0csS0FDbkRtRSxFQUFFM0QsSUFBSVgsRUFBR0csRUFBRzZCLEtBQUt3QixLQUFLeEIsS0FBSzJCLElBQUlVLEVBQUc1RCxJQUFJVCxFQUFHRyxHQUFJLEdBQUs2QixLQUFLMkIsSUFBSVMsRUFBRzNELElBQUlULEVBQUdHLEdBQUksS0FHakYsTUFBTyxDQUFFbUUsRUFBQyxFQUFFQyxNQUFLLE9BRzdCLEVBaERBLEdDMUlBLGFBa0JJLFdBQVkxQixHQWJKLEtBQUFBLEtBQTZCLENBQ2pDNEIsa0JBQW1CLEdBQ25CQyxtQkFBb0IsR0FDcEJDLGlCQUFrQixDQUNkbEMsRUFBRyxFQUNISyxNQUFPLElBU1BELEdBQ0FyRCxLQUFLdUQsUUFBUUYsR0FzSXpCLE9BOUhJLFlBQUFFLFFBQUEsU0FBUUYsR0FNSixHQUxJQSxFQUFLOEIsbUJBQ0xuRixLQUFLcUQsS0FBSzhCLGlCQUFtQnpCLE9BQU9DLE9BQU8zRCxLQUFLcUQsS0FBSzhCLGlCQUFrQjlCLEVBQUs4Qix5QkFDckU5QixFQUFLOEIsa0JBRWhCbkYsS0FBS3FELEtBQU9LLE9BQU9DLE9BQU8zRCxLQUFLcUQsS0FBTUEsR0FDTSxpQkFBaENyRCxLQUFLcUQsS0FBSzRCLG1CQUEwRSxpQkFBakNqRixLQUFLcUQsS0FBSzZCLG1CQUNwRSxNQUFNLElBQUk5RSxNQUFNLHdFQUVwQixHQUFJSixLQUFLcUQsS0FBSzRCLG1CQUFxQmpGLEtBQUtxRCxLQUFLNkIsbUJBQ3pDLE1BQU0sSUFBSTlFLE1BQU0scUVBWWhCLFlBQUFnRixzQkFBUixTQUE4Qk4sRUFBV0MsR0FFckMsSUFEQSxJQUFNTSxFQUFlLElBQUl2RSxFQUFPZ0UsRUFBRWxGLE1BQU9rRixFQUFFakYsUUFDbENXLEVBQUksRUFBR0EsRUFBSTZFLEVBQWF4RixPQUFTLEVBQUdXLElBQ3pDLElBQUssSUFBSUcsRUFBSSxFQUFHQSxFQUFJMEUsRUFBYXpGLE1BQVEsRUFBR2UsSUFBSyxDQUU3QyxJQUFJMkUsRUFBSSxJQUFLQyxFQUFJLElBQ2JDLEVBQTBCLElBQWxCVCxFQUFNOUQsSUFBSVQsRUFBR0csR0FBVzZCLEtBQUt5QixHQUNyQ3VCLEVBQVEsSUFDUkEsR0FBUyxLQUlSLEdBQUtBLEdBQVNBLEVBQVEsTUFBVSxPQUFTQSxHQUFTQSxHQUFTLEtBQzVERixFQUFJUixFQUFFN0QsSUFBSVQsRUFBR0csRUFBSSxHQUNqQjRFLEVBQUlULEVBQUU3RCxJQUFJVCxFQUFHRyxFQUFJLElBQ1YsTUFBUTZFLEdBQVNBLEVBQVEsTUFDaENGLEVBQUlSLEVBQUU3RCxJQUFJVCxFQUFJLEVBQUdHLEVBQUksR0FDckI0RSxFQUFJVCxFQUFFN0QsSUFBSVQsRUFBSSxFQUFHRyxFQUFJLElBQ2QsTUFBUTZFLEdBQVNBLEVBQVEsT0FDaENGLEVBQUlSLEVBQUU3RCxJQUFJVCxFQUFJLEVBQUdHLEdBQ2pCNEUsRUFBSVQsRUFBRTdELElBQUlULEVBQUksRUFBR0csSUFDVixPQUFTNkUsR0FBU0EsRUFBUSxRQUNqQ0YsRUFBSVIsRUFBRTdELElBQUlULEVBQUksRUFBR0csRUFBSSxHQUNyQjRFLEVBQUlULEVBQUU3RCxJQUFJVCxFQUFJLEVBQUdHLEVBQUksSUFJckJtRSxFQUFFN0QsSUFBSVQsRUFBR0csSUFBTTJFLEdBQUtSLEVBQUU3RCxJQUFJVCxFQUFHRyxJQUFNNEUsRUFDbkNGLEVBQWFsRSxJQUFJWCxFQUFHRyxFQUFHbUUsRUFBRTdELElBQUlULEVBQUdHLElBRWhDMEUsRUFBYWxFLElBQUlYLEVBQUdHLEVBQUcsR0FLbkMsT0FBTzBFLEdBWUgsWUFBQUksVUFBUixTQUFrQlgsRUFBV1ksRUFBYUMsR0FFdEMsSUFEQSxJQUFNQyxFQUFNZCxFQUFFdkQsUUFDTGYsRUFBSSxFQUFHQSxFQUFJb0YsRUFBSS9GLE9BQVMsRUFBR1csSUFDaEMsSUFBSyxJQUFJRyxFQUFJLEVBQUdBLEVBQUlpRixFQUFJaEcsTUFBUSxFQUFHZSxJQUFLLENBQ3BDLElBQU1rRixFQUFRRCxFQUFJM0UsSUFBSVQsRUFBR0csR0FDckJrRixFQUFRSCxFQUNSRSxFQUFJekUsSUFBSVgsRUFBR0csRUFBRyxHQUNQa0YsRUFBUUYsRUFDZkMsRUFBSXpFLElBQUlYLEVBQUdHLEVBQUdtRixFQUFNQyxNQUVwQkgsRUFBSXpFLElBQUlYLEVBQUdHLEVBQUdtRixFQUFNRSxRQUloQyxPQUFPSixHQVNILFlBQUFLLFdBQVIsU0FBbUJuQixHQUNmLElBQUssSUFBSXRFLEVBQUksRUFBR0EsRUFBSXNFLEVBQUVqRixPQUFTLEVBQUdXLElBQzlCLElBQUssSUFBSUcsRUFBSSxFQUFHQSxFQUFJbUUsRUFBRWxGLE1BQVEsRUFBR2UsSUFDZm1FLEVBQUU3RCxJQUFJVCxFQUFHRyxLQUNUbUYsRUFBTUMsT0FDWmpCLEVBQUU3RCxJQUFJVCxFQUFJLEVBQUdHLEVBQUksS0FBT21GLEVBQU1FLFFBQVVsQixFQUFFN0QsSUFBSVQsRUFBSSxFQUFHRyxLQUFPbUYsRUFBTUUsUUFDL0RsQixFQUFFN0QsSUFBSVQsRUFBSSxFQUFHRyxFQUFJLEtBQU9tRixFQUFNRSxRQUFVbEIsRUFBRTdELElBQUlULEVBQUdHLEVBQUksS0FBT21GLEVBQU1FLFFBQ2xFbEIsRUFBRTdELElBQUlULEVBQUdHLEVBQUksS0FBT21GLEVBQU1FLFFBQVVsQixFQUFFN0QsSUFBSVQsRUFBSSxFQUFHRyxFQUFJLEtBQU9tRixFQUFNRSxRQUNsRWxCLEVBQUU3RCxJQUFJVCxFQUFJLEVBQUdHLEtBQU9tRixFQUFNRSxRQUFVbEIsRUFBRTdELElBQUlULEVBQUksRUFBR0csRUFBSSxLQUFPbUYsRUFBTUUsT0FFckVsQixFQUFFM0QsSUFBSVgsRUFBR0csRUFBR21GLEVBQU1FLFFBRWxCbEIsRUFBRTNELElBQUlYLEVBQUdHLEVBQUcsSUFLNUIsT0FBT21FLEdBUVgsWUFBQXBDLElBQUEsU0FBSUMsR0FBSixXQUNJLE9BQU8sSUFBSXVELEVBQWFsRyxLQUFLcUQsS0FBSzhCLGtCQUFrQnpDLElBQUlDLEdBQ25EZ0MsTUFBSyxTQUFBaUIsR0FBTyxXQUFJTyxHQUFRekQsSUFBSWtELE1BQzVCakIsTUFBSyxTQUFDLEcsSUFBRUcsRUFBQyxJQUFFQyxFQUFLLFFBQ1BxQixFQUFnQnpELEVBQU81QixNQUFRLEVBQUtzQyxLQUFLNkIsbUJBQ3pDbUIsRUFBZUQsRUFBZ0IsRUFBSy9DLEtBQUs0QixrQkFDL0MsT0FBTyxFQUFLZ0IsV0FBVyxFQUFLUixVQUFVLEVBQUtMLHNCQUFzQk4sRUFBR0MsR0FBUXNCLEVBQWNELFFBRzFHLEVBMUpBLElBNEpBLFNBQWlCTixHQXlCQSxFQUFBQyxLQUFPLElBTVAsRUFBQUMsT0FBUyxJQS9CMUIsQ0FBaUJGLE1BQUssS0M3SnRCLGlCQVlJLFdBQVl6QyxHQU5KLEtBQUFBLEtBQU8sQ0FBRWlELGNBQWUsRUFBR0MsY0FBZSxHQU8xQ2xELEdBQ0FyRCxLQUFLdUQsUUFBUUYsR0FzSHpCLE9BOUdJLFlBQUFFLFFBQUEsU0FBUUYsR0FDSnJELEtBQUtxRCxLQUFPSyxPQUFPQyxPQUFPM0QsS0FBS3FELEtBQU1BLElBVXpDLFlBQUFYLElBQUEsU0FBSThELEdBQUosV0FDSSxPQUFPLElBQUk1RCxTQUFRLFNBQUNDLEVBQVNDLEdBQ3pCLElBYUksSUFYQSxJQUFNMkQsRUFBd0J4RyxNQUFNNEQsS0FBSyxDQUFFMUQsT0FBUSxFQUFLa0QsS0FBS2tELGdCQUN6RCxXQUFNLFdBQUl0RyxNQUFNdUcsRUFBUUUsaUJBQWlCM0csS0FBSyxNQUU1QyxFQUErQixJQUFJRSxNQUFNdUcsRUFBUXJHLFFBQVFKLEtBQUssR0FDaEU0RyxFQUFxQixFQUNyQkMsRUFBMEIsRUFDMUJDLEVBQXlCLEVBRXZCQyxFQUE4QixHLGFBSWhDLElBQU1DLEVBQVV6RSxFQUFPa0UsRUFBUXJHLE9BQVMsR0FFcEMyRyxFQUFnQnZDLFFBQU8sU0FBQXlDLEdBQ25CLE9BQU9BLEVBQVN4RixLQUFJLFNBQUN5RixFQUFHQyxHQUFNLE9BQUFELEVBQUlULEVBQVF2RixJQUFJOEYsRUFBU0csTUFBSTNDLFFBQU8sU0FBQTBDLEdBQUssT0FBTSxJQUFOQSxLQUFTOUcsU0FBVzZHLEVBQVM3RyxVQUV0R0EsT0FBUyxJQUVYc0csRUFBVUssRUFBZ0IzRyxRQUFVc0csRUFBVUssRUFBZ0IzRyxRQUFRcUIsS0FBSSxTQUFDdUMsRUFBR21ELEdBQU0sT0FBQVYsRUFBUXZGLElBQUk4RixFQUFTRyxNQUN6R0osRUFBZ0JLLEtBQUtWLEVBQVVLLEVBQWdCM0csV0FUaEQyRyxFQUFnQjNHLE9BQVMsRUFBS2tELEtBQUtrRCxlLElBYTFDLEVBQUcsQ0FFQyxJQURBLElBQUlhLEdBQWlCLEVBQ1pDLEVBQVksRUFBR0EsRUFBWWIsRUFBUXJHLE9BQVFrSCxJQUFhLENBRzdELElBRkEsSUFBSUMsRUFBcUIsRUFDckJDLEVBQTBCQyxJQUNyQkMsRUFBYSxFQUFHQSxFQUFhaEIsRUFBVXRHLE9BQVFzSCxJQUFjLENBRWxFLElBREEsSUFBSUMsRUFBVyxFQUNOUixFQUFJLEVBQUdBLEVBQUlWLEVBQVFFLGdCQUFpQlEsSUFDekNRLEdBQVlsRixLQUFLMkIsSUFBSXNDLEVBQVVnQixHQUFZUCxHQUFLVixFQUFRdkYsSUFBSW9HLEVBQVdILEdBQUksSUFFL0VRLEVBQVdsRixLQUFLd0IsS0FBSzBELElBQ05ILElBQ1hBLEVBQTBCRyxFQUMxQkosRUFBcUJHLEdBSXhCTCxHQUFrQixFQUFtQkMsS0FBZUMsSUFDckRGLEdBQWlCLEdBRXJCLEVBQW1CQyxHQUFhQyxFQUdoQ0YsRUFDQVAsRUFBeUIsRUFFekJBLElBR0osSUFBSWMsRUFBZTFILE1BQU00RCxLQUFLLENBQUUxRCxPQUFRLEVBQUtrRCxLQUFLa0QsZ0JBQWlCLFdBQU0sV0FBSXRHLE1BQU11RyxFQUFRRSxpQkFBaUIzRyxLQUFLLE1BRWpILElBQVNzSCxFQUFZLEVBQUdBLEVBQVliLEVBQVFyRyxPQUFRa0gsSUFDaEQsSUFBU0gsRUFBSSxFQUFHQSxFQUFJVixFQUFRRSxnQkFBaUJRLElBQ3pDUyxFQUFhLEVBQW1CTixJQUFZSCxJQUFNVixFQUFRdkYsSUFBSW9HLEVBQVdILEdBSWpGUyxFQUFlQSxFQUFhbkcsS0FBSSxTQUFDd0YsRUFBVVMsR0FDdkMsT0FBQVQsRUFBU3hGLEtBQUksU0FBQUMsR0FBSyxPQUFBQSxFQUFJLEVBQW1COEMsUUFBTyxTQUFBcUQsR0FBTyxPQUFBQSxJQUFRSCxLQUFZdEgsYUFJL0UsSUFGQSxJQUFJMEgsR0FBbUIsRUFFZEMsRUFBYyxFQUFHQSxFQUFjckIsRUFBVXRHLE9BQVEySCxJQUN0RCxJQUFTWixFQUFJLEVBQUdBLEVBQUlWLEVBQVFFLGdCQUFpQlEsSUFDckNULEVBQVVxQixHQUFhWixLQUFPUyxFQUFhRyxHQUFhWixLQUN4RFQsRUFBVXFCLEdBQWFaLEdBQUtTLEVBQWFHLEdBQWFaLEdBQ3REVyxHQUFtQixHQUszQkEsRUFDQWpCLEVBQTBCLEVBRTFCQSxJQUVKRCxZQUdDQyxFQUEwQixHQUMxQkMsRUFBeUIsR0FDRyxJQUE1QixFQUFLeEQsS0FBS2lELGVBQXVCSyxFQUFxQixFQUFLdEQsS0FBS2lELGdCQUdyRXpELEVBQVEsQ0FBRWtGLFNBQVUsRUFBb0J0QixVQUFTLElBRW5ELE1BQU90RCxHQUNMTCxFQUFPSyxRQUl2QixFQXBJQSxHLGlXQ0VBLGNBTUksV0FBWTZFLEcsT0FDUixZQUFNQSxFQUFNcEksTUFBT29JLEVBQU1uSSxPQUFRbUksRUFBTWxJLGNBQWVrSSxFQUFNM0gsU0FBTyxLQWEzRSxPQXBCOEMsT0FVMUMsWUFBQVksSUFBQSxTQUFJMkcsRUFBYUssR0FDYixPQUFPakksS0FBS0ssT0FBT3VILEVBQU01SCxLQUFLRixjQUFnQm1JLElBR2xELHNCQUFJLHFCQUFNLEMsSUFBVixXQUNJLE9BQU9qSSxLQUFLSixNQUFRSSxLQUFLSCxRLGdDQUU3QixzQkFBSSw4QkFBZSxDLElBQW5CLFdBQ0ksT0FBT0csS0FBS0YsZSxnQ0FFcEIsRUFwQkEsQ0FBOENnQixHQXlCOUMsYUFnQkksV0FBWXVDLEdBWEosS0FBQUEsS0FBMEMsQ0FBRTZFLGFBQWEsRUFBT0MsT0FBUSxHQVl4RTlFLEdBQ0FyRCxLQUFLdUQsUUFBUUYsR0FFakJyRCxLQUFLb0ksZUFrRGIsT0EzQ1ksWUFBQUEsYUFBUixXQUNJcEksS0FBS3FJLE9BQVMsSUFBSUMsRUFBTyxDQUNyQi9CLGNBQWV0RyxNQUFNQyxRQUFRRixLQUFLcUQsS0FBSzhFLFFBQVVuSSxLQUFLcUQsS0FBSzhFLE9BQU9oSSxPQUFTSCxLQUFLcUQsS0FBSzhFLE9BQ3JGN0IsY0FBZSxNQVF2QixZQUFBL0MsUUFBQSxTQUFRRixHQUNKckQsS0FBS3FELEtBQU9LLE9BQU9DLE9BQU8zRCxLQUFLcUQsS0FBTUEsR0FDckNyRCxLQUFLb0ksZ0JBU1QsWUFBQTFGLElBQUEsU0FBSUMsR0FBSixXQUNVNkQsRUFBVSxJQUFJK0IsRUFBeUJ2SSxLQUFLcUQsS0FBSzZFLFlBQWN2RixFQUFPakIsY0FBZ0JpQixHQUM1RixPQUFPM0MsS0FBS3FJLE9BQU8zRixJQUFJOEQsR0FBUzdCLE1BQUssU0FBQyxHLElBQUVvRCxFQUFRLFdBQUV0QixFQUFTLFlBQ2pEcEUsRUFBUyxFQUFLZ0IsS0FBSzZFLFlBQWMxQixFQUFRN0UsZUFBZSxHQUFLNkUsRUFFbkUsR0FBS3ZHLE1BQU1DLFFBQVEsRUFBS21ELEtBQUs4RSxRQU96QixJQUFTM0gsRUFBSSxFQUFHQSxFQUFJNkIsRUFBT3pDLE1BQVF5QyxFQUFPeEMsT0FBUVcsSUFDOUM2QixFQUFPaEMsT0FBVyxFQUFKRyxHQUFTLEVBQUs2QyxLQUFLOEUsT0FBT0osRUFBU3ZILElBQUksR0FDckQ2QixFQUFPaEMsT0FBVyxFQUFKRyxFQUFRLEdBQUssRUFBSzZDLEtBQUs4RSxPQUFPSixFQUFTdkgsSUFBSSxHQUN6RDZCLEVBQU9oQyxPQUFXLEVBQUpHLEVBQVEsR0FBSyxFQUFLNkMsS0FBSzhFLE9BQU9KLEVBQVN2SCxJQUFJLFFBVDdELElBQUssSUFBSUEsRUFBSSxFQUFHQSxFQUFJNkIsRUFBT3pDLE1BQVF5QyxFQUFPeEMsT0FBUVcsSUFDOUM2QixFQUFPaEMsT0FBVyxFQUFKRyxHQUFTaUcsRUFBVXNCLEVBQVN2SCxJQUFJLEdBQzlDNkIsRUFBT2hDLE9BQVcsRUFBSkcsRUFBUSxHQUFLaUcsRUFBVXNCLEVBQVN2SCxJQUFJLEVBQUs2QyxLQUFLNkUsWUFBYyxFQUFJLEdBQzlFN0YsRUFBT2hDLE9BQVcsRUFBSkcsRUFBUSxHQUFLaUcsRUFBVXNCLEVBQVN2SCxJQUFJLEVBQUs2QyxLQUFLNkUsWUFBYyxFQUFJLEdBU3RGLE9BQU83RixNQUduQixFQXRFQSxHQzFCTW1HLEVBQWMsSUFFcEIsYUE0R0ksd0JBMUdBLEtBQUFDLElBQU0sQ0FDRkMsSUFBS0MsU0FBU0MsZUFBZSxPQUM3QkMsUUFBU0YsU0FBU0MsZUFBZSxXQUNqQ0UsTUFBT0gsU0FBU0MsZUFBZSxTQUMvQkcsV0FBWUosU0FBU0MsZUFBZSxjQUNwQ0ksVUFBV0wsU0FBU0MsZUFBZSxhQUNuQ0ssV0FBWU4sU0FBU0MsZUFBZSxjQUNwQ00sS0FBTVAsU0FBU0MsZUFBZSxRQUM5Qk8sS0FBTVIsU0FBU0MsZUFBZSxRQUM5QlEsVUFBV1QsU0FBU0MsZUFBZSxhQUNuQ1MsTUFBT1YsU0FBU0MsZUFBZSxTQUMvQlUsT0FBUSxDQUNKQyxPQUFRLENBQ0pDLEtBQU1iLFNBQVNDLGVBQWUsY0FDOUJhLE1BQU9kLFNBQVNDLGVBQWUsZUFDL0JjLEtBQU1mLFNBQVNDLGVBQWUscUJBQzlCaEYsT0FBUStFLFNBQVNDLGVBQWUsdUJBQ2hDZSxNQUFPaEIsU0FBU0MsZUFBZSxlQUMvQmdCLE9BQVFqQixTQUFTQyxlQUFlLGdCQUNoQ2lCLE1BQU9sQixTQUFTQyxlQUFlLGVBQy9CeEcsVUFBV3VHLFNBQVNDLGVBQWUsb0JBRXZDa0IsTUFBTyxDQUNITixLQUFNYixTQUFTQyxlQUFlLGFBQzlCYSxNQUFPZCxTQUFTQyxlQUFlLGNBQy9CYyxLQUFNZixTQUFTQyxlQUFlLGFBQzlCdEYsTUFBT3FGLFNBQVNDLGVBQWUsY0FDL0JlLE1BQU9oQixTQUFTQyxlQUFlLGNBQy9CZ0IsT0FBUWpCLFNBQVNDLGVBQWUsZUFDaENpQixNQUFPbEIsU0FBU0MsZUFBZSxlQUVuQ21CLE1BQU8sQ0FDSFAsS0FBTWIsU0FBU0MsZUFBZSxhQUM5QmEsTUFBT2QsU0FBU0MsZUFBZSxjQUMvQmxELElBQUtpRCxTQUFTQyxlQUFlLFlBQzdCakQsS0FBTWdELFNBQVNDLGVBQWUsYUFDOUJjLEtBQU1mLFNBQVNDLGVBQWUsa0JBQzlCdEYsTUFBT3FGLFNBQVNDLGVBQWUsbUJBQy9CZSxNQUFPaEIsU0FBU0MsZUFBZSxjQUMvQmdCLE9BQVFqQixTQUFTQyxlQUFlLGVBQ2hDaUIsTUFBT2xCLFNBQVNDLGVBQWUsZUFFbkNvQixRQUFTLENBQ0xSLEtBQU1iLFNBQVNDLGVBQWUsZUFDOUJhLE1BQU9kLFNBQVNDLGVBQWUsZ0JBQy9CcUIsT0FBUXRCLFNBQVNDLGVBQWUsaUJBQ2hDc0IsSUFBS3ZCLFNBQVNDLGVBQWUsY0FDN0J1QixVQUFXeEIsU0FBU0MsZUFBZSxvQkFDbkNlLE1BQU9oQixTQUFTQyxlQUFlLGdCQUMvQmdCLE9BQVFqQixTQUFTQyxlQUFlLGlCQUNoQ2lCLE1BQU9sQixTQUFTQyxlQUFlLGlCQUVuQ3dCLFNBQVUsQ0FDTlosS0FBTWIsU0FBU0MsZUFBZSxnQkFDOUJhLE1BQU9kLFNBQVNDLGVBQWUsaUJBQy9CeUIsTUFBTzFCLFNBQVNDLGVBQWUsaUJBQy9CZSxNQUFPaEIsU0FBU0MsZUFBZSxpQkFDL0JnQixPQUFRakIsU0FBU0MsZUFBZSxrQkFDaENpQixNQUFPbEIsU0FBU0MsZUFBZSxvQkFhM0MsS0FBQWtCLE1BQVEsSUFBSTVELEVBRVosS0FBQTZELE1BQVEsSUFBSWpFLEVBRVosS0FBQXdFLGFBQWUsSUFBSUMsRUFFbkIsS0FBQUMsWUFBYyxJQUFJRCxFQUVsQixLQUFBRSxRQUFvQixHQTZCaEJ6SyxLQUFLMEssS0FBSzFLLEtBQUt5SSxJQUFJSSxTQUVuQm5GLE9BQU9pSCxLQUFLM0ssS0FBS3lJLElBQUlhLFFBQVFzQixTQUFRLFNBQUFDLEdBQ2pDLElBQU1DLEVBQU8sRUFBS3JDLElBQUlhLE9BQWV1QixHQUNyQyxFQUFLSCxLQUFLSSxFQUFJckIsT0FDZCxFQUFLaUIsS0FBS0ksRUFBSWpCLE9BQ2RpQixFQUFJdEIsS0FBS3VCLFFBQVUsV0FBTSxTQUFLQyxVQUFVRixFQUFJckIsUUFDNUNxQixFQUFJbEIsT0FBT21CLFFBQVUsV0FBTSxTQUFLRSxVQUFVSCxFQUFJckIsV0FHbER6SixLQUFLeUksSUFBSVMsS0FBSzZCLFFBQVUsV0FBTSxTQUFLN0IsUUFDbkNsSixLQUFLeUksSUFBSVUsS0FBSzRCLFFBQVUsV0FBTSxTQUFLNUIsUUFFbkNSLFNBQVN1QyxpQkFBaUIsV0FBVyxTQUFBQyxHQUM3QkEsRUFBTUMsU0FBeUIsTUFBZEQsRUFBTUUsS0FDdkIsRUFBS25DLFVBSWJQLFNBQVN1QyxpQkFBaUIsV0FBVyxTQUFBQyxHQUM3QkEsRUFBTUMsU0FBeUIsTUFBZEQsRUFBTUUsS0FDdkIsRUFBS2xDLFVBSWJuSixLQUFLeUksSUFBSVcsVUFBVTJCLFFBQVUsV0FDekIsRUFBS08sSUFBRyxXQUFNLFNBQUtDLFlBQVksRUFBSzlDLElBQUlLLE1BQU9oSSxFQUFPUixjQUFjLEVBQUtrTCxhQUFhLEVBQUsvQyxJQUFJSyxhQUduRyxJQUFNMkMsRUFBZ0IsV0FDbEIsSUFDSSxFQUFLZixLQUFLLEVBQUtqQyxJQUFJYSxPQUFPUSxNQUFNRCxPQUNoQyxJQUFNSCxFQUFPZ0MsU0FBUyxFQUFLakQsSUFBSWEsT0FBT1EsTUFBTUosS0FBS2lDLE1BQU8sSUFDbERySSxFQUFRc0ksV0FBVyxFQUFLbkQsSUFBSWEsT0FBT1EsTUFBTXhHLE1BQU1xSSxPQUNyRCxFQUFLN0IsTUFBTXZHLFFBQVEsQ0FBRUQsTUFBSyxFQUFFTCxFQUFHeUcsSUFDakMsTUFBT3ZHLEdBQ0wsRUFBS3NGLElBQUlhLE9BQU9RLE1BQU1ELE1BQU1nQyxVQUFZMUksRUFDeEMsRUFBSzJJLEtBQUssRUFBS3JELElBQUlhLE9BQU9RLE1BQU1ELFNBSWxDa0MsRUFBZ0IsV0FDbEIsSUFDSSxFQUFLckIsS0FBSyxFQUFLakMsSUFBSWEsT0FBT1MsTUFBTUYsT0FDaEMsSUFBTUgsRUFBT2dDLFNBQVMsRUFBS2pELElBQUlhLE9BQU9TLE1BQU1MLEtBQUtpQyxNQUFPLElBQ2xEckksRUFBUXNJLFdBQVcsRUFBS25ELElBQUlhLE9BQU9TLE1BQU16RyxNQUFNcUksT0FDL0NqRyxFQUFNa0csV0FBVyxFQUFLbkQsSUFBSWEsT0FBT1MsTUFBTXJFLElBQUlpRyxPQUMzQ2hHLEVBQU9pRyxXQUFXLEVBQUtuRCxJQUFJYSxPQUFPUyxNQUFNcEUsS0FBS2dHLE9BQ25ELEVBQUs1QixNQUFNeEcsUUFBUSxDQUNmMEIsa0JBQW1CUyxFQUNuQlIsbUJBQW9CUyxFQUNwQlIsaUJBQWtCLENBQ2RsQyxFQUFHeUcsRUFDSHBHLE1BQUssS0FHZixNQUFPSCxHQUNMLEVBQUtzRixJQUFJYSxPQUFPUyxNQUFNRixNQUFNZ0MsVUFBWTFJLEVBQ3hDLEVBQUsySSxLQUFLLEVBQUtyRCxJQUFJYSxPQUFPUyxNQUFNRixTQUlsQ21DLEVBQWtCLFdBQ3BCLElBQ0ksRUFBS3RCLEtBQUssRUFBS2pDLElBQUlhLE9BQU9VLFFBQVFILE9BQ2xDLElBQU1JLEVBQVN5QixTQUFTLEVBQUtqRCxJQUFJYSxPQUFPVSxRQUFRQyxPQUFPMEIsTUFBTyxJQUU5RCxHQUFzQixpQkFBWDFCLElBQXdCZ0MsT0FBT0MsVUFBVWpDLEdBQ2hELE1BQU0sSUFBSTdKLE1BQU0sd0NBR3BCLElBQU04SixFQUFNLEVBQUt6QixJQUFJYSxPQUFPVSxRQUFRRSxJQUFJaUMsUUFDeEMsRUFBSzdCLGFBQWEvRyxRQUFRLENBQ3RCNEUsT0FBUWxJLE1BQU00RCxLQUFLLENBQUUxRCxPQUFROEosSUFBVSxXQUFNLE9BQUMzSCxFQUFPLElBQUssSUFBS0EsRUFBTyxJQUFLLElBQUtBLEVBQU8sSUFBSyxRQUM1RjRGLGFBQWNnQyxJQUVwQixNQUFPL0csR0FDTCxFQUFLc0YsSUFBSWEsT0FBT1UsUUFBUUgsTUFBTWdDLFVBQVkxSSxFQUMxQyxFQUFLMkksS0FBSyxFQUFLckQsSUFBSWEsT0FBT1UsUUFBUUgsU0FxQjFDN0osS0FBS3lJLElBQUlhLE9BQU9jLFNBQVNDLE1BQU0rQixRQWpCTixXQUNyQixJQUNJLEVBQUsxQixLQUFLLEVBQUtqQyxJQUFJYSxPQUFPYyxTQUFTUCxPQUNuQyxJQUFNUSxFQUFRcUIsU0FBUyxFQUFLakQsSUFBSWEsT0FBT2MsU0FBU0MsTUFBTXNCLE1BQU8sSUFFN0QsR0FBcUIsaUJBQVZ0QixJQUF1QjRCLE9BQU9DLFVBQVU3QixHQUMvQyxNQUFNLElBQUlqSyxNQUFNLHFDQUVwQixFQUFLb0ssWUFBWWpILFFBQVEsQ0FDckI0RSxPQUFRM0YsS0FBSzJCLElBQUksRUFBR2tHLEtBRTFCLE1BQU9sSCxHQUNMLEVBQUtzRixJQUFJYSxPQUFPYyxTQUFTUCxNQUFNZ0MsVUFBWTFJLEVBQzNDLEVBQUsySSxLQUFLLEVBQUtyRCxJQUFJYSxPQUFPYyxTQUFTUCxTQU0zQzdKLEtBQUt5SSxJQUFJYSxPQUFPVSxRQUFRQyxPQUFPbUMsUUFBVUosRUFDekNoTSxLQUFLeUksSUFBSWEsT0FBT1UsUUFBUUUsSUFBSW1DLFNBQVdMLEVBQ3ZDaE0sS0FBS3lJLElBQUlhLE9BQU9VLFFBQVFHLFVBQVVrQyxTQUFXTCxFQUU3Q2hNLEtBQUt5SSxJQUFJYSxPQUFPUyxNQUFNekcsTUFBTThJLFFBQVVMLEVBQ3RDL0wsS0FBS3lJLElBQUlhLE9BQU9TLE1BQU1MLEtBQUswQyxRQUFVTCxFQUNyQy9MLEtBQUt5SSxJQUFJYSxPQUFPUyxNQUFNckUsSUFBSTBHLFFBQVVMLEVBQ3BDL0wsS0FBS3lJLElBQUlhLE9BQU9TLE1BQU1wRSxLQUFLeUcsUUFBVUwsRUFFckMvTCxLQUFLeUksSUFBSWEsT0FBT1EsTUFBTXhHLE1BQU04SSxRQUFVWCxFQUN0Q3pMLEtBQUt5SSxJQUFJYSxPQUFPUSxNQUFNSixLQUFLMEMsUUFBVVgsRUFFckN6TCxLQUFLeUksSUFBSWEsT0FBT0MsT0FBT25ILFVBQVUySSxRQUFVLFdBQ3ZDLEVBQUt4QixPQUFPM0YsT0FBT3hCLFlBQ25CLElBQUssSUFBSTVCLEVBQUksRUFBR0EsRUFBSSxFQUFLK0ksT0FBT0csS0FBTWxKLElBQ2xDLElBQUssSUFBSUcsRUFBSSxFQUFHQSxFQUFJLEVBQUs0SSxPQUFPRyxLQUFNL0ksSUFDdkJnSSxTQUFTQyxlQUFlLGNBQWNwSSxFQUFDLElBQUlHLEdBQ25EZ0wsTUFBUSxHQUFLLEVBQUtwQyxPQUFPM0YsT0FBTzNDLElBQUlULEVBQUdHLElBS3REWCxLQUFLeUksSUFBSWEsT0FBT0MsT0FBT0csS0FBSzBDLFFBQVUsV0FDbEMsRUFBSzFCLEtBQUssRUFBS2pDLElBQUlhLE9BQU9DLE9BQU9NLE9BQ2pDLElBQU1ILEVBQU9nQyxTQUFTLEVBQUtqRCxJQUFJYSxPQUFPQyxPQUFPRyxLQUFLaUMsTUFBTyxJQUN6RCxHQUFvQixpQkFBVGpDLEdBQXFCQSxFQUFPLEdBQU0sR0FBS0EsRUFBTyxFQUdyRCxPQUZBLEVBQUtqQixJQUFJYSxPQUFPQyxPQUFPTSxNQUFNZ0MsVUFBWSwyREFDekMsRUFBS0MsS0FBSyxFQUFLckQsSUFBSWEsT0FBT0MsT0FBT00sT0FJckMsSUFBTWpHLEVBQVMsSUFBSVksRUFBWWtGLEVBQU1BLEVBQU0sR0FFM0M5RixFQUFPekMsS0FBS3VJLEVBQU8sR0FBSyxHQUFJQSxFQUFPLEdBQUssRUFBRyxHQUUzQyxFQUFLSCxPQUFTLENBQ1YzRixPQUFNLEVBQ044RixLQUFJLEdBR1IsRUFBS2pCLElBQUlhLE9BQU9DLE9BQU8zRixPQUFPMEksVUFBWSxHQUMxQyxJLGVBQVM5TCxHQUNMLEVBQUtpSSxJQUFJYSxPQUFPQyxPQUFPM0YsT0FBTzJJLFlBQzFCLEVBQUtDLGNBQWMsK0RBRWpCLElBQUl2TSxNQUFNeUosR0FBTTNKLFVBQUswRCxHQUFXakMsS0FBSSxTQUFDdUMsRUFBR3BELEdBQ3RDLGtFQUM0QkgsRUFBQyxJQUFJRyxFQUFDLHFFQUFxRWlELEVBQU8zQyxJQUFJVCxFQUFHRyxHQUFFLHdDQUV6SDhMLEtBQUssSUFBRyw0Q0FSVGpNLEVBQUksRUFBR0EsRUFBSWtKLEVBQU1sSixJLEVBQWpCQSxHLGVBYUFBLEdBQ0wsSSxlQUFTRyxHQUNMLElBQU0rTCxFQUFLL0QsU0FBU0MsZUFBZSxjQUFjcEksRUFBQyxJQUFJRyxHQUNsRCtMLElBQ0FBLEVBQUdMLFNBQVcsV0FDVnpJLEVBQU96QyxJQUFJWCxFQUFHRyxFQUFHaUwsV0FBV2MsRUFBR2YsV0FKbENoTCxFQUFJLEVBQUdBLEVBQUkrSSxFQUFNL0ksSSxFQUFqQkEsSUFEYixJQUFTSCxFQUFJLEVBQUdBLEVBQUlrSixFQUFNbEosSSxFQUFqQkEsSUFZYlIsS0FBS3lJLElBQUlhLE9BQU9jLFNBQVNULE1BQU1vQixRQUFVLFdBQ3JDLEVBQUtFLFVBQVUsRUFBS3hDLElBQUlhLE9BQU9jLFNBQVNYLE9BQ3hDLEVBQUtlLFlBQVk5SCxJQUFJNUIsRUFBT1IsY0FBYyxFQUFLa0wsYUFBYSxFQUFLL0MsSUFBSUssT0FBUSxJQUN4RW5FLE1BQUssU0FBQXRDLEdBQVUsU0FBS2lKLElBQUcsV0FBTSxTQUFLQyxZQUFZLEVBQUs5QyxJQUFJSyxNQUFPekcsU0FDOURzSyxPQUFNLFNBQUF4SixHQUFPLE9BQUF5SixNQUFNekosT0FHNUJuRCxLQUFLeUksSUFBSWEsT0FBT1UsUUFBUUwsTUFBTW9CLFFBQVUsV0FDcEMsRUFBS0UsVUFBVSxFQUFLeEMsSUFBSWEsT0FBT1UsUUFBUVAsT0FDdkN1QyxJQUNBLEVBQUsxQixhQUFhNUgsSUFBSTVCLEVBQU9SLGNBQWMsRUFBS2tMLGFBQWEsRUFBSy9DLElBQUlLLE9BQVEsSUFDekVuRSxNQUFLLFNBQUF0QyxHQUFVLFNBQUtpSixJQUFHLFdBQU0sU0FBS0MsWUFBWSxFQUFLOUMsSUFBSUssTUFBT3pHLFNBQzlEc0ssT0FBTSxTQUFBeEosR0FBTyxPQUFBeUosTUFBTXpKLE9BRzVCbkQsS0FBS3lJLElBQUlhLE9BQU9DLE9BQU9JLE1BQU1vQixRQUFVLFdBQ25DLEVBQUtFLFVBQVUsRUFBS3hDLElBQUlhLE9BQU9DLE9BQU9FLE9BQ3RDLEVBQUtGLE9BQU8zRixPQUFPbEIsSUFBSTVCLEVBQU9SLGNBQWMsRUFBS2tMLGFBQWEsRUFBSy9DLElBQUlLLE9BQVEsSUFDMUVuRSxNQUFLLFNBQUF0QyxHQUFVLFNBQUtpSixJQUFHLFdBQU0sU0FBS0MsWUFBWSxFQUFLOUMsSUFBSUssTUFBT3pHLFNBQzlEc0ssT0FBTSxTQUFBeEosR0FBTyxPQUFBeUosTUFBTXpKLE9BRzVCbkQsS0FBS3lJLElBQUlhLE9BQU9RLE1BQU1ILE1BQU1vQixRQUFVLFdBQ2xDLEVBQUtFLFVBQVUsRUFBS3hDLElBQUlhLE9BQU9RLE1BQU1MLE9BRXJDLEVBQUtLLE1BQU1wSCxJQUFJNUIsRUFBT1IsY0FBYyxFQUFLa0wsYUFBYSxFQUFLL0MsSUFBSUssT0FBUSxJQUNsRW5FLE1BQUssU0FBQXRDLEdBQVUsU0FBS2lKLElBQUcsV0FBTSxTQUFLQyxZQUFZLEVBQUs5QyxJQUFJSyxNQUFPekcsU0FDOURzSyxPQUFNLFNBQUF4SixHQUFPLE9BQUF5SixNQUFNekosT0FHNUJuRCxLQUFLeUksSUFBSVksTUFBTTBCLFFBQVUsV0FDckIsRUFBS0UsVUFBVSxFQUFLeEMsSUFBSWEsT0FBT1EsTUFBTUwsUUFDckMsSUFBSXRELEdBQVF6RCxJQUFJNUIsRUFBT1IsY0FBYyxFQUFLa0wsYUFBYSxFQUFLL0MsSUFBSUssT0FBUSxJQUNuRW5FLE1BQUssU0FBQyxHLElBQUVHLEVBQUMsSUFBTyxTQUFLd0csSUFBRyxXQUFNLFNBQUtDLFlBQVksRUFBSzlDLElBQUlLLE1BQU9oRSxTQUMvRDZILE9BQU0sU0FBQXhKLEdBQU8sT0FBQXlKLE1BQU16SixPQUc1Qm5ELEtBQUt5SSxJQUFJYSxPQUFPUyxNQUFNSixNQUFNb0IsUUFBVSxXQUNsQyxFQUFLRSxVQUFVLEVBQUt4QyxJQUFJYSxPQUFPUyxNQUFNTixPQUVyQyxFQUFLTSxNQUFNckgsSUFBSTVCLEVBQU9SLGNBQWMsRUFBS2tMLGFBQWEsRUFBSy9DLElBQUlLLE9BQVEsSUFDbEVuRSxNQUFLLFNBQUF0QyxHQUFVLFNBQUtpSixJQUFHLFdBQU0sU0FBS0MsWUFBWSxFQUFLOUMsSUFBSUssTUFBT3pHLFNBQzlEc0ssT0FBTSxTQUFBeEosR0FBTyxPQUFBeUosTUFBTXpKLE9BRzVCbkQsS0FBS3lJLElBQUlhLE9BQU9DLE9BQU9HLEtBQUttRCxjQUFjLElBQUlDLE1BQU0sVUFDcEQ5TSxLQUFLeUksSUFBSWEsT0FBT1EsTUFBTUosS0FBS21ELGNBQWMsSUFBSUMsTUFBTSxVQUNuRDlNLEtBQUt5SSxJQUFJYSxPQUFPVSxRQUFRQyxPQUFPNEMsY0FBYyxJQUFJQyxNQUFNLFVBQ3ZEOU0sS0FBS3lJLElBQUlhLE9BQU9jLFNBQVNDLE1BQU13QyxjQUFjLElBQUlDLE1BQU0sVUFFdkQsQ0FBQzlNLEtBQUt5SSxJQUFJSyxPQUFPOEIsU0FBUSxTQUFBbUMsR0FDckJBLEVBQU9uTixNQUFRNEksRUFDZnVFLEVBQU9sTixPQUFTMkksRUFDaEJ1RSxFQUFPQyxRQUFVLFNBQUFDLEcsTUFDVSxRQUF2QixFQUFBRixFQUFPRyxXQUFXLGFBQUssU0FBRUMsTUFBTSxFQUFHLElBRXRDLEVBQUtDLFlBQVlMLE1BR3JCL00sS0FBS3lJLElBQUlPLFVBQVUrQixRQUFVLFdBQU0sU0FBS3RDLElBQUlNLFdBQVdzRSxTQUN2RHJOLEtBQUt5SSxJQUFJUSxXQUFXOEIsUUFBVSxXQUFNLFNBQUt0QyxJQUFJTSxXQUFXc0UsU0FFeERyTixLQUFLeUksSUFBSU0sV0FBV3NELFNBQVcsVyxNQUMzQixFQUFLNUQsSUFBSVcsVUFBVWtFLFVBQVcsRUFDOUIsRUFBSzdFLElBQUlZLE1BQU1pRSxVQUFXLEVBQzFCLEVBQUs3RSxJQUFJUSxXQUFXc0UsTUFBTUMsUUFBVSxPQUNwQzlKLE9BQU9pSCxLQUFLLEVBQUtsQyxJQUFJYSxRQUFRc0IsU0FBUSxTQUFBQyxHQUNwQixFQUFLcEMsSUFBSWEsT0FBZXVCLEdBQ2hDckIsS0FBMkI4RCxVQUFXLEtBRy9DLElBQU1HLEVBQWdDLFFBQTVCLEVBQUcsRUFBS2hGLElBQUlNLFdBQVcyRSxhQUFLLGVBQUcsR0FDbkNDLEVBQWEsSUFBSUMsV0FDdkJELEVBQVdFLGNBQWNKLEdBQ3pCRSxFQUFXRyxPQUFTLFdBQ2hCLElBQU1DLEVBQU1wRixTQUFTNkQsY0FBYyxPQUNuQ3VCLEVBQUlDLElBQU1MLEVBQVd0TCxPQUFRSCxXQUM3QjZMLEVBQUlELE9BQVMsV0FDVCxFQUFLRyxXQUFhRixFQUFJRyxhQUN0QixFQUFLQyxZQUFjSixFQUFJSyxlQUVuQixFQUFLSCxXQUFhekYsR0FBZSxFQUFLMkYsWUFBYzNGLEtBQ2hELEVBQUt5RixXQUFhLEVBQUtFLGFBQ3ZCLEVBQUtBLFlBQWMsRUFBS0EsYUFBZTNGLEVBQWMsRUFBS3lGLFlBQzFELEVBQUtBLFdBQWF6RixJQUVsQixFQUFLeUYsV0FBYSxFQUFLQSxZQUFjekYsRUFBYyxFQUFLMkYsYUFDeEQsRUFBS0EsWUFBYzNGLElBRzNCLEVBQUsrQyxZQUFZLEVBQUs5QyxJQUFJSyxNQUFPaUYsR0FDakMsRUFBS3RELFFBQVUsQ0FBQzNKLEVBQU9SLGNBQWMsRUFBS2tMLGFBQWEsRUFBSy9DLElBQUlLLE9BQVEsSUFDeEUsRUFBS3VGLGFBQWUsRUFDcEIsRUFBSzVGLElBQUlNLFdBQVc0QyxNQUFRLE1BMkVoRCxPQXpXWSxZQUFBYSxjQUFSLFNBQXNCOEIsR0FDbEIsSUFBTUMsRUFBTTVGLFNBQVM2RCxjQUFjLE9BRW5DLE9BREErQixFQUFJakMsVUFBWWdDLEVBQUtFLE9BQ2RELEVBQUlFLFlBR1AsWUFBQTNDLEtBQVIsU0FBYVksR0FDVEEsV0FBSWdDLFVBQVVDLE9BQU8sV0FHakIsWUFBQWpFLEtBQVIsU0FBYWdDLEdBQ1RBLFdBQUlnQyxVQUFVRSxJQUFJLFdBR2QsWUFBQTVELFVBQVIsU0FBa0IwQixHQUNkMU0sS0FBSzhMLEtBQUtZLEdBQ1YxTSxLQUFLOEwsS0FBSzlMLEtBQUt5SSxJQUFJSSxVQUdmLFlBQUFvQyxVQUFSLFNBQWtCeUIsR0FDZDFNLEtBQUswSyxLQUFLZ0MsR0FDVjFNLEtBQUswSyxLQUFLMUssS0FBS3lJLElBQUlJLFVBK1FmLFlBQUF5QyxHQUFSLFNBQVd1RCxHQUNIN08sS0FBS3FPLGVBQWlCck8sS0FBS3lLLFFBQVF0SyxPQUFTLElBQzVDSCxLQUFLeUssUUFBVXpLLEtBQUt5SyxRQUFRcUUsTUFBTSxFQUFHOU8sS0FBS3FPLGFBQWUsSUFFN0RRLElBQ0E3TyxLQUFLeUssUUFBUXRELEtBQUtyRyxFQUFPUixjQUFjTixLQUFLd0wsYUFBYXhMLEtBQUt5SSxJQUFJSyxPQUFRLElBQzFFOUksS0FBS3FPLGVBQ0xyTyxLQUFLeUksSUFBSVUsS0FBS21FLFVBQVcsRUFDekJ0TixLQUFLeUksSUFBSVMsS0FBS29FLFVBQVcsR0FHckIsWUFBQXBFLEtBQVIsV0FDUWxKLEtBQUtxTyxhQUFlLEdBQ3BCck8sS0FBS3FPLGVBQ0xyTyxLQUFLdUwsWUFBWXZMLEtBQUt5SSxJQUFJSyxNQUFPOUksS0FBS3lLLFFBQVF6SyxLQUFLcU8sZUFDL0NyTyxLQUFLcU8sYUFBZSxJQUNwQnJPLEtBQUt5SSxJQUFJUyxLQUFLb0UsVUFBVyxHQUV6QnROLEtBQUtxTyxhQUFlck8sS0FBS3lLLFFBQVF0SyxPQUFTLElBQzFDSCxLQUFLeUksSUFBSVUsS0FBS21FLFVBQVcsSUFHN0IsSUFBSXlCLE1BQU0sMkVBQTJFQyxRQUlyRixZQUFBN0YsS0FBUixXQUNRbkosS0FBS3FPLGFBQWVyTyxLQUFLeUssUUFBUXRLLE9BQVMsR0FDMUNILEtBQUtxTyxlQUNMck8sS0FBS3VMLFlBQVl2TCxLQUFLeUksSUFBSUssTUFBTzlJLEtBQUt5SyxRQUFRekssS0FBS3FPLGVBQy9Dck8sS0FBS3FPLGVBQWlCck8sS0FBS3lLLFFBQVF0SyxPQUFTLElBQzVDSCxLQUFLeUksSUFBSVUsS0FBS21FLFVBQVcsR0FFekJ0TixLQUFLcU8sYUFBZSxJQUNwQnJPLEtBQUt5SSxJQUFJUyxLQUFLb0UsVUFBVyxJQUc3QixJQUFJeUIsTUFBTSxjQUFjQyxRQUl4QixZQUFBNUIsWUFBUixTQUFvQkwsR0FDaEIsSUFBTWtDLEVBQU1sQyxFQUFPRyxXQUFXLE1BQzlCK0IsRUFBSUMsVUFBWSxPQUNoQkQsRUFBSUUsU0FBUyxFQUFHLEVBQUdwQyxFQUFPbk4sTUFBT21OLEVBQU9sTixTQUdwQyxZQUFBMkwsYUFBUixTQUFxQnVCLEdBQ2pCLE9BQU9BLEVBQU9HLFdBQVcsTUFBTzFCLGNBQzNCaEQsRUFBY3hJLEtBQUtpTyxZQUFjLEdBQ2pDekYsRUFBY3hJLEtBQUttTyxhQUFlLEVBQ25Dbk8sS0FBS2lPLFdBQ0xqTyxLQUFLbU8sY0FNTCxZQUFBNUMsWUFBUixTQUFvQndCLEVBQTJCZ0IsR0FDM0MvTixLQUFLb04sWUFBWUwsR0FDakIsSUFBTWtDLEVBQU1sQyxFQUFPRyxXQUFXLE1BQ3hCa0MsR0FBTTVHLEVBQWN4SSxLQUFLaU8sWUFBYyxFQUN2Q29CLEdBQU03RyxFQUFjeEksS0FBS21PLGFBQWUsRUFDMUNKLGFBQWV1QixpQkFDZkwsRUFBSU0sVUFBVXhCLEVBQUtxQixFQUFJQyxFQUFJclAsS0FBS2lPLFdBQVlqTyxLQUFLbU8sYUFFakRjLEVBQUlPLGFBQWF6QixFQUFJM00sY0FBZWdPLEVBQUlDLElBR3BELEVBN2JBLEdBb2NBMUcsU0FBU3VDLGlCQUFpQixvQkFMYixXQUNULElBQU11RSxFQUFPLElBQUlDLEVBQ2hCQyxPQUFlakgsSUFBTStHLE0iLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSZXByZXNlbnRzIGFuIG9iamVjdCB0aGF0IGNhbiBiZSBkcmF3biBpbnRvIGEgY2FudmFzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERyYXdhYmxlIHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gSW1hZ2VEYXRhIGluc3RhbmNlIHRoYXQgcmVwcmVzZW50cyB0aGUgaW1hZ2UuXG4gICAgICogQHJldHVybnMgQ3JlYXRlZCBpbWFnZSBkYXRhLlxuICAgICAqL1xuICAgIHRvSW1hZ2VEYXRhKCk6IEltYWdlRGF0YTtcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgYml0bWFwIGltYWdlIHdpdGggYXJiaXRyYXJ5IGNoYW5uZWxzLlxuICovXG5leHBvcnQgY2xhc3MgQml0bWFwIGltcGxlbWVudHMgRHJhd2FibGUge1xuXG4gICAgLyoqXG4gICAgICogQSAxLUQgYXJyYXkgdGhhdCBjb250YWlucyBjb25zZWN1dGl2ZSBwaXhlbCBkYXRhIHdpdGggY29uc2VjdXRpdmUgY2hhbm5lbCB2YWx1ZXMuXG4gICAgICovXG4gICAgcHVibGljIHBpeGVsczogbnVtYmVyW107XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY2hhbm5lbCBjb3VudCBvZiB0aGUgaW1hZ2UuXG4gICAgICovXG4gICAgcHVibGljIGNoYW5uZWxOdW1iZXI6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgaW1hZ2UuXG4gICAgICovXG4gICAgcHVibGljIHdpZHRoOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSBpbWFnZS5cbiAgICAgKi9cbiAgICBwdWJsaWMgaGVpZ2h0OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBiaXRtYXAgaW1hZ2UuXG4gICAgICogQHBhcmFtIHdpZHRoIC0gV2lkdGggb2YgdGhlIGltYWdlIGluIHBpeGVscy5cbiAgICAgKiBAcGFyYW0gaGVpZ2h0IC0gSGVpZ2h0IG9mIHRoZSBpbWFnZSBpbiBwaXhlbHMuXG4gICAgICogQHBhcmFtIGNoYW5uZWxOdW1iZXIgLSBDaGFubmVsIGNvdW50IG9mIHRoZSBpbWFnZSwgZGVmYXVsdCBpcyAxIChncmF5c2NhbGUpLlxuICAgICAqIEBwYXJhbSBmaWxsIC0gQSB2YWx1ZSB0byBmaWxsIHRoZSBpbWFnZSAoaW4gYWxsIGNoYW5uZWxzKSwgb3IgYW4gYXJyYXkgdGhhdCBob2xkc1xuICAgICAqIGNvbnNlY3V0aXZlIHBpeGVsIGRhdGEgd2l0aCBjb25zZWN1dGl2ZSBjaGFubmVsIHZhbHVlcy4gSWYgb21pdHRlZCwgMCB3aWxsIGJlIHVzZWQuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Iod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIsIGNoYW5uZWxOdW1iZXIgPSAxLCBmaWxsPzogbnVtYmVyW10gfCBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5jaGFubmVsTnVtYmVyID0gY2hhbm5lbE51bWJlcjtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsbCkpIHtcbiAgICAgICAgICAgIGlmIChmaWxsLmxlbmd0aCAhPT0gd2lkdGggKiBoZWlnaHQgKiBjaGFubmVsTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdHaXZlbiBwaXhlbCBhcnJheSBkb2VzIG5vdCBtYXRjaCB0aGUgZGltZW5zaW9uIGFuZCB0aGUgY2hhbm5lbCBjb3VudC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGl4ZWxzID0gZmlsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGl4ZWxzID0gbmV3IEFycmF5KHdpZHRoICogaGVpZ2h0ICogY2hhbm5lbE51bWJlcikuZmlsbChmaWxsID8gZmlsbCA6IDApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBmYWN0b3J5IG1ldGhvZCB0aGF0IGNhbiBiZSB1c2VkIHRvIGRlcml2ZSBhbiBpbWFnZSBvYmplY3QgZnJvbSBhIG5hdGl2ZSBJbWFnZURhdGEgaW5zdGFuY2UuXG4gICAgICogQHBhcmFtIGltYWdlRGF0YSAtIFRoZSBpbWFnZSBkYXRhIHRvIGJlIHVzZWQuXG4gICAgICogQHBhcmFtIGNoYW5uZWxOdW1iZXIgLSBDaGFubmVsIGNvdW50IG9mIHRoZSBpbWFnZSwgZGVmYXVsdCBpcyAxIChncmF5c2NhbGUpLlxuICAgICAqIEByZXR1cm5zIEEgaW1hZ2Ugb2JqZWN0IHBvcHVsYXRlZCB3aXRoIHRoZSBkYXRhIGZyb20gdGhlIGltYWdlIGRhdGEuXG4gICAgICovXG4gICAgc3RhdGljIGZyb21JbWFnZURhdGEoaW1hZ2VEYXRhOiBJbWFnZURhdGEsIGNoYW5uZWxOdW1iZXIgPSAxKSB7XG4gICAgICAgIGNvbnN0IHBpeGVscyA9IG5ldyBBcnJheShpbWFnZURhdGEud2lkdGggKiBpbWFnZURhdGEuaGVpZ2h0ICogY2hhbm5lbE51bWJlcik7XG5cbiAgICAgICAgaWYgKGNoYW5uZWxOdW1iZXIgPCAyKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGUgY2hhbm5lbCBudW1iZXIgaXMgMSwgdXNlIHRoZSBhdmVyYWdlIG9mIFJHQiB2YWx1ZXMgZnJvbSBpbWFnZSBkYXRhLlxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWFnZURhdGEud2lkdGggKiBpbWFnZURhdGEuaGVpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBwaXhlbHNbaV0gPSBbMCwgMSwgMl0ucmVkdWNlKChhY2MsIGopID0+IGFjYyArIGltYWdlRGF0YS5kYXRhW2kgKiA0ICsgal0sIDApIC8gMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW1hZ2VEYXRhLndpZHRoICogaW1hZ2VEYXRhLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjaGFubmVsTnVtYmVyICYmIGMgPCAzOyBjKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcGl4ZWxzW2kgKiBjaGFubmVsTnVtYmVyICsgY10gPSBpbWFnZURhdGEuZGF0YVtpICogNCArIGNdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEJpdG1hcChpbWFnZURhdGEud2lkdGgsIGltYWdlRGF0YS5oZWlnaHQsIGNoYW5uZWxOdW1iZXIsIHBpeGVscyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBnbG9iYWwgbWF4aW11bSBwaXhlbCB2YWx1ZSBpbiB0aGUgaW1hZ2UuXG4gICAgICogQHJldHVybnMgVGhlIG1heGltdW0gdmFsdWUuXG4gICAgICovXG4gICAgbWF4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5waXhlbHMucmVkdWNlKChtYXgsIHZhbCkgPT4gbWF4ID4gdmFsID8gbWF4IDogdmFsKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGNoYW5uZWwgdmFsdWUgb2YgYSBwaXhlbCBhdCBhIGdpdmVuIHBvc2l0aW9uLlxuICAgICAqIEBwYXJhbSBpIC0gVGhlIHJvdyBvZiB0aGUgcGl4ZWwuXG4gICAgICogQHBhcmFtIGogLSBUaGUgY29sdW1uIG9mIHRoZSBwaXhlbC5cbiAgICAgKiBAcGFyYW0gY2hhbm5lbElkeCAtIFRoZSBjaGFubmVsIG51bWJlci5cbiAgICAgKiBAcmV0dXJucyBUaGUgY2hhbm5lbCB2YWx1ZS5cbiAgICAgKi9cbiAgICBnZXQoaTogbnVtYmVyLCBqOiBudW1iZXIsIGNoYW5uZWxJZHggPSAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBpeGVsc1soaSAqIHRoaXMud2lkdGggKyBqKSAqIHRoaXMuY2hhbm5lbE51bWJlciArIGNoYW5uZWxJZHhdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgY2hhbm5lbCB2YWx1ZSBvZiBhIHBpeGVsIGF0IGEgZ2l2ZW4gcG9zaXRpb24uXG4gICAgICogQHBhcmFtIGkgLSBUaGUgcm93IG9mIHRoZSBwaXhlbC5cbiAgICAgKiBAcGFyYW0gaiAtIFRoZSBjb2x1bW4gb2YgdGhlIHBpeGVsLlxuICAgICAqIEBwYXJhbSBjaGFubmVsSWR4IC0gVGhlIGNoYW5uZWwgbnVtYmVyLlxuICAgICAqIEBwYXJhbSB2YWwgLSBUaGUgbmV3IHZhbHVlLlxuICAgICAqL1xuICAgIHNldChpOiBudW1iZXIsIGo6IG51bWJlciwgdmFsOiBudW1iZXIsIGNoYW5uZWxJZHggPSAwKSB7XG4gICAgICAgIHRoaXMucGl4ZWxzWyhpICogdGhpcy53aWR0aCArIGopICogdGhpcy5jaGFubmVsTnVtYmVyICsgY2hhbm5lbElkeF0gPSB2YWw7XG4gICAgfVxuXG4gICAgIC8qKlxuICAgICAqIENyZWF0ZSBhbiBJbWFnZURhdGEgaW5zdGFuY2UgdGhhdCByZXByZXNlbnRzIHRoZSBpbWFnZS5cbiAgICAgKiBAcmV0dXJucyBDcmVhdGVkIGltYWdlIGRhdGFcbiAgICAgKi9cbiAgICB0b0ltYWdlRGF0YSgpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh0aGlzLndpZHRoICogdGhpcy5oZWlnaHQgKiA0KTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQ7IGkrKykge1xuICAgICAgICAgICAgZGF0YVtpICogNF0gPSB0aGlzLnBpeGVsc1tpICogdGhpcy5jaGFubmVsTnVtYmVyXTtcbiAgICAgICAgICAgIC8vIEltYWdlRGF0YSBpbnN0YW5jZXMgc3RyaWN0bHkgaG9sZCA0IGNoYW5uZWxzIChSLEcsQiwgYWxmYSksIHNvIGluIGNhc2Ugb2YgYW4gaW1hZ2Ugd2l0aCBzaW5nbGUgY2hhbm5lbCxcbiAgICAgICAgICAgIC8vIHBvcHVsYXRlIFJHQiBjaGFubmVscyB3aXRoIHRoYXQgc2luZ2xlIGNoYW5uZWwuXG4gICAgICAgICAgICBkYXRhW2kgKiA0ICsgMV0gPSB0aGlzLnBpeGVsc1tpICogdGhpcy5jaGFubmVsTnVtYmVyICsgKHRoaXMuY2hhbm5lbE51bWJlciA+IDEgPyAxIDogMCldO1xuICAgICAgICAgICAgZGF0YVtpICogNCArIDJdID0gdGhpcy5waXhlbHNbaSAqIHRoaXMuY2hhbm5lbE51bWJlciArICh0aGlzLmNoYW5uZWxOdW1iZXIgPiAxID8gMiA6IDApXTtcbiAgICAgICAgICAgIC8vIEFsd2F5cyBpZ25vcmUgdHJhbnNwYXJlbmN5IGluIGltYWdlcywgc28gZmlsbCB3aXRoIDI1NSwgd2hpY2ggbWFrZXMgdGhlIGltYWdlIGZ1bGx5IG9wYXF1ZS5cbiAgICAgICAgICAgIGRhdGFbaSAqIDQgKyAzXSA9IDI1NTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEltYWdlRGF0YShkYXRhLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xvbmUgdGhlIGltYWdlLlxuICAgICAqIEByZXR1cm5zIENsb25lZCBpbWFnZS5cbiAgICAgKi9cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCaXRtYXAodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIHRoaXMuY2hhbm5lbE51bWJlciwgdGhpcy5waXhlbHMubWFwKHggPT4geCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBncmF5c2NhbGUgaW1hZ2UuIFRoaXMgbWV0aG9kIGRvZXMgbm90IG11dGF0ZSB0aGUgb3JpZ2luYWwgb2JqZWN0LlxuICAgICAqIEByZXR1cm5zIENyZWF0ZWQgZ3JheXNjYWxlIGltYWdlLlxuICAgICAqL1xuICAgIHRvR3JheVNjYWxlKCkge1xuICAgICAgICBpZiAodGhpcy5jaGFubmVsTnVtYmVyIDwgMikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xvbmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBpeGVscyA9IG5ldyBBcnJheSh0aGlzLndpZHRoICogdGhpcy5oZWlnaHQpLmZpbGwoMCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgdGhpcy5jaGFubmVsTnVtYmVyOyBjKyspIHtcbiAgICAgICAgICAgICAgICBwaXhlbHNbaV0gKz0gdGhpcy5waXhlbHNbaSAqIHRoaXMuY2hhbm5lbE51bWJlciArIGNdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGl4ZWxzW2ldIC89IHRoaXMuY2hhbm5lbE51bWJlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEJpdG1hcCh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgMSwgcGl4ZWxzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSaXNlIHRoZSBudW1iZXIgb2YgY2hhbm5lbHMgdG8gYW55IG51bWJlci4gQ2FuIG9ubHkgYmUgaW52b2tlZCBvbiBzaW5nbGUgY2hhbm5lbCBpbWFnZXMuXG4gICAgICogQHJldHVybnMgQ3JlYXRlZCBtdWx0aS1jaGFubmVsIGltYWdlLlxuICAgICAqL1xuICAgIHRvTXVsdGlDaGFubmVsKGNoYW5uZWxOdW1iZXI6IG51bWJlcikge1xuICAgICAgICAvLyBXaGVuIHRoZSBpbWFnZSBpcyBhbHJlYWR5IG11bHRpY2hhbm5lbCwgY29udmVyc2lvbiBjYW5ub3QgYmUgZG9uZSB3aXRob3V0IGFtYmlndWl0eSwgc28ganVzdCB0aHJvdyBhbiBlcnJvci5cbiAgICAgICAgaWYgKHRoaXMuY2hhbm5lbE51bWJlciA+IDEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW1hZ2UgaXMgYWxyZWFkeSBtdWx0aSBjaGFubmVsJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGl4ZWxzID0gbmV3IEFycmF5KHRoaXMud2lkdGggKiB0aGlzLmhlaWdodCAqIGNoYW5uZWxOdW1iZXIpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMud2lkdGggKiB0aGlzLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IGNoYW5uZWxOdW1iZXI7IGMrKykge1xuICAgICAgICAgICAgICAgIHBpeGVsc1tpICogY2hhbm5lbE51bWJlciArIGNdID0gdGhpcy5waXhlbHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBCaXRtYXAodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIGNoYW5uZWxOdW1iZXIsIHBpeGVscyk7XG4gICAgfVxufVxuIiwiZnVuY3Rpb24gaXNBcnJheU9mQXJyYXlzPFQ+KHZhbDogQXJyYXk8VD4gfCBBcnJheTxBcnJheTxUPj4pOiB2YWwgaXMgQXJyYXk8QXJyYXk8VD4+IHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWwpICYmIEFycmF5LmlzQXJyYXkodmFsWzBdKTtcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgbWF0cml4IHdob3NlIHZhbHVlcyBhcmUgb2YgdHlwZSBULlxuICovXG5leHBvcnQgY2xhc3MgTWF0cml4PFQ+IHtcblxuICAgIC8qKlxuICAgICAqIEEgMS1EIGFycmF5IHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIGluIHRoZSBtYXRyaXggY29uc2VjdXRpdmVseS5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZGF0YTogQXJyYXk8VD47XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaGVpZ2h0IG9mIHRoZSBtYXRyaXguXG4gICAgICovXG4gICAgcHVibGljIHJvd3M6IG51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4LlxuICAgICAqL1xuICAgIHB1YmxpYyBjb2xzOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBtYXRyaXggd2l0aCBkaW1lbnNpb24gaW5mb3JtYXRpb24uXG4gICAgICogQHBhcmFtIHJvd3MgLSBIZWlnaHQgb2YgdGhlIG1hdHJpeFxuICAgICAqIEBwYXJhbSBjb2xzIC0gV2lkdGggb2YgdGhlIG1hdHJpeFxuICAgICAqIEBwYXJhbSBmaWxsIC0gQSBzaW5nbGUgdmFsdWUgdG8gZmlsbCB0aGUgbWF0cml4LCBvciBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBjb25zZWN1dGl2ZWx5LlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJvd3M6IG51bWJlciwgY29sczogbnVtYmVyLCBmaWxsPzogVCB8IEFycmF5PFQ+KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGZyb20gbmF0aXZlIDItRCBhcnJheS5cbiAgICAgKiBAcGFyYW0gZGF0YSAtIEEgMi1EIGFycmF5IHJlcHJlc2VudHMgdGhlIG1hdHJpeC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihkYXRhOiBBcnJheTxBcnJheTxUPj4pO1xuXG4gICAgY29uc3RydWN0b3IoYXJnMTogbnVtYmVyIHwgQXJyYXk8QXJyYXk8VD4+IHwgQXJyYXk8VD4sIGFyZzI/OiBudW1iZXIsIGFyZzM/OiBUIHwgQXJyYXk8VD4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcyID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMucm93cyA9IGFyZzE7XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xzID0gYXJnMjtcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBBcnJheS5pc0FycmF5KGFyZzMpID8gYXJnMyA6IG5ldyBBcnJheShhcmcxICogYXJnMikuZmlsbChhcmczKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCYWQgcGFyYW1ldGVycyBmb3IgdGhlIGNvbnN0cnVjdG9yLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXlPZkFycmF5cyhhcmcxKSkge1xuICAgICAgICAgICAgdGhpcy5jb2xzID0gYXJnMS5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLnJvd3MgPSBhcmcxWzBdLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IGFyZzEucmVkdWNlKChhY2MsIHZhbCkgPT4gYWNjLmNvbmNhdCh2YWwpLCBbXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHZhbHVlIGF0IChpLGopXG4gICAgICogQHBhcmFtIGkgLSBSb3cgbnVtYmVyLlxuICAgICAqIEBwYXJhbSBqIC0gQ29sdW1uIG51bWJlci5cbiAgICAgKiBAcmV0dXJucyBWYWx1ZSBhdCAoaSwgailcbiAgICAgKi9cbiAgICBnZXQoaTogbnVtYmVyLCBqOiBudW1iZXIpOiBUIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVtpICogdGhpcy5jb2xzICsgal07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSB2YWx1ZSBhdCAoaSxqKVxuICAgICAqIEBwYXJhbSBpIC0gUm93IG51bWJlci5cbiAgICAgKiBAcGFyYW0gaiAtIENvbHVtbiBudW1iZXIuXG4gICAgICogQHBhcmFtIHZhbCAtIE5ldyB2YWx1ZVxuICAgICAqL1xuICAgIHNldChpOiBudW1iZXIsIGo6IG51bWJlciwgdmFsOiBUKSB7XG4gICAgICAgIHRoaXMuZGF0YVtpICogdGhpcy5jb2xzICsgal0gPSB2YWw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBtYXRyaXggdGhhdCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLlxuICAgICAqIEByZXR1cm5zIFN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgbWF0cml4LlxuICAgICAqL1xuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIGxldCBzdHIgPSAnJztcbiAgICAgICAgc3RyICs9IGBNYXRyaXggKCR7dGhpcy5yb3dzfSwgJHt0aGlzLmNvbHN9KTpgO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucm93czsgaSsrKSB7XG4gICAgICAgICAgICBzdHIgKz0gJ1xcbic7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuY29sczsgaisrKSB7XG4gICAgICAgICAgICAgICAgc3RyICs9IGAke3RoaXMuZ2V0KGksIGopfVxcdGA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmFuc3Bvc2UgdGhlIG1hdHJpeC4gVGhpcyBtZXRob2QgbXV0YXRlcyB0aGUgb3JpZ2luYWwgbWF0cml4LlxuICAgICAqIEByZXR1cm5zIHRoaXNcbiAgICAgKi9cbiAgICB0cmFuc3Bvc2UoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IEFycmF5KHRoaXMucm93cyAqIHRoaXMuY29scyk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5yb3dzOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5jb2xzOyBqKyspIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbaiAqIHRoaXMucm93cyArIGldID0gdGhpcy5nZXQoaSwgaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgcm93cyA9IHRoaXMucm93cztcbiAgICAgICAgdGhpcy5yb3dzID0gdGhpcy5jb2xzO1xuICAgICAgICB0aGlzLmNvbHMgPSByb3dzO1xuICAgICAgICB0aGlzLmRhdGEgPSByZXN1bHQ7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cbiIsIi8qKlxuICogR2VuZXJhdGUgYSByYW5kb20gcmVhbCBudW1iZXIgYmV0d2VlbiBgbWluYCBhbmQgYG1heGAuXG4gKiBAcGFyYW0gbWF4IC0gbWF4aW11bSB2YWx1ZS5cbiAqIEBwYXJhbSBtaW4gLSBtaW5pbXVtIHZhbHVlLlxuICogQHJldHVybnMgZ2VuZXJhdGVkIHJhbmRvbSBudW1iZXIuXG4gKi9cbmV4cG9ydCBjb25zdCByYW5kb20gPSAobWF4OiBudW1iZXIsIG1pbiA9IDApID0+IG1pbiArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIE1hdGguZmxvb3IobWF4KSk7XG5cbi8qKlxuICogU2FtcGxlIGZyb20gZ2F1c3NpYW4gZGlzdHJpYnV0aW9uIHdpdGggMCBtZWFuLlxuICogQHBhcmFtIHggLSB4IHZhbHVlLlxuICogQHBhcmFtIHNpZ21hIC0gc3RhbmRhcmQgZGV2aWF0aW9uIG9mIHRoZSBnYXVzc2lhbiBkaXN0cmlidXRpb24uXG4gKiBAcmV0dXJucyBsaWtlbGlob29kIG9mIHguXG4gKi9cbmV4cG9ydCBjb25zdCBnYXVzc2lhbiA9ICh4OiBudW1iZXIsIHNpZ21hID0gMSkgPT4gKDEgLyAoc2lnbWEgKiBNYXRoLnNxcnQoMiAqIE1hdGguUEkpKSkgKiBNYXRoLmV4cCgtMC41ICogTWF0aC5wb3coeCAvIHNpZ21hLCAyKSk7XG4iLCJpbXBvcnQgeyBCaXRtYXAgfSBmcm9tICcuL2ltYWdlJztcbmltcG9ydCB7IE1hdHJpeCB9IGZyb20gJy4vbWF0cml4JztcbmltcG9ydCB7IGdhdXNzaWFuIH0gZnJvbSAnLi91dGlsJztcblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgY29udm9sdXRpb24uXG4gKiBAZXh0ZW5kcyBNYXRyaXhcbiAqL1xuZXhwb3J0IGNsYXNzIEJhc2ljRmlsdGVyIGV4dGVuZHMgTWF0cml4PG51bWJlcj4ge1xuXG4gICAgLyoqXG4gICAgICogU3RhcnQgZG9pbmcgdGhlIGNvbnZvbHV0aW9uLiBUaGlzIG1ldGhvZCBkb2Vzbid0IG11dGF0ZSB0aGUgc291cmNlIGltYWdlLlxuICAgICAqIEBwYXJhbSBzb3VyY2UgLSBTb3VyY2UgaW1hZ2VcbiAgICAgKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRpbmcgaW1hZ2UuICh3aXRoIG9yaWdpbmFsIGNoYW5uZWwgY291bnQpXG4gICAgICovXG4gICAgcnVuKHNvdXJjZTogQml0bWFwKTogUHJvbWlzZTxCaXRtYXA+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgYnJhbmQgbmV3IGltYWdlIG9iamVjdCB0aGF0IGtlZXBzIHRoZSBmaWx0ZXJlZCBpbWFnZS5cbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJlZCA9IG5ldyBCaXRtYXAoc291cmNlLndpZHRoLCBzb3VyY2UuaGVpZ2h0LCBzb3VyY2UuY2hhbm5lbE51bWJlcik7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpbHRlcmVkLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZmlsdGVyZWQud2lkdGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbSA9IDA7IG0gPCB0aGlzLnJvd3M7IG0rKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdGhpcy5jb2xzOyBuKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gY29udm9sdXRpb24gZm9yIGVhY2ggY2hhbm5lbC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBzb3VyY2UuY2hhbm5lbE51bWJlcjsgYysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmVpZ2hib3JQaXhlbCA9IHNvdXJjZS5nZXQoaSAtICgodGhpcy5yb3dzIC0gMSkgLyAyIC0gbSksIGogLSAoKHRoaXMuY29scyAtIDEpIC8gMiAtIG4pLCBjKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBwaXhlbCBkb2Vzbid0IGV4aXN0IChpbiBjYXNlIHdoZW4gaXQgZmFsbHMgb3V0c2lkZSBvZiB0aGUgaW1hZ2UpIGp1c3QgYXNzdW1lIGl0IGlzIDAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZWlnaGJvclBpeGVsID0gbmVpZ2hib3JQaXhlbCA/IG5laWdoYm9yUGl4ZWwgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQuc2V0KGksIGosIGZpbHRlcmVkLmdldChpLCBqLCBjKSArIG5laWdoYm9yUGl4ZWwgKiB0aGlzLmdldChtLCBuKSwgYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShmaWx0ZXJlZCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBnYXVzc2lhbiBibHVyIGZpbHRlci5cbiAqL1xuZXhwb3J0IGNsYXNzIEdhdXNzaWFuQmx1ciB7XG4gICAgLyoqXG4gICAgICogVGhlIG9wdGlvbnMuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBvcHRzOiBSZXF1aXJlZDxHYXVzc2lhbkJsdXIuT3B0cz4gPSB7IHNpZ21hOiAxLCBuOiA1IH07XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYWN0dWFsIGZpbHRlciBpbnN0YW5jZSB0aGF0IHBlcmZvcm1zIGNvbnZvbHV0aW9uLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgZmlsdGVyOiBCYXNpY0ZpbHRlcjtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGdhdXNzaWFuIGJsdXIgZmlsdGVyLlxuICAgICAqIEBwYXJhbSBvcHRzIC0gT3B0aW9ucyBmb3IgdGhlIGdhdXNzaWFuIGJsdXJyaW5nLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdHM/OiBHYXVzc2lhbkJsdXIuT3B0cykge1xuICAgICAgICBpZiAob3B0cykge1xuICAgICAgICAgICAgdGhpcy5zZXRPcHRzKG9wdHMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlRmlsdGVyKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSBvcHRzIC0gT3B0aW9ucyBmb3IgdGhlIGdhdXNzaWFuIGJsdXJyaW5nLlxuICAgICAqL1xuICAgIHNldE9wdHMob3B0czogR2F1c3NpYW5CbHVyLk9wdHMpIHtcbiAgICAgICAgaWYgKG9wdHMubiAhPT0gdW5kZWZpbmVkICYmICh0eXBlb2Ygb3B0cy5uICE9PSAnbnVtYmVyJyB8fCBvcHRzLm4gPCAzIHx8IG9wdHMubiAlIDIgPT09IDApKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0tlcm5lbCBzaXplIHNob3VsZCBiZSBhbiBvZGQgbnVtYmVyIGdyZWF0ZXIgdGhhbiAzJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0cy5zaWdtYSAhPT0gdW5kZWZpbmVkICYmIG9wdHMuc2lnbWEgPD0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaWdtYSBzaG91bGQgYmUgYSBwb3NpdGl2ZSByZWFsIG51bWJlcicpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEp1c3Qgb3ZlcnJpZGUgdGhlIG9wdGlvbnMgdGhhdCBleGlzdCBpbiBnaXZlbiBvcHRpb25zIG9iamVjdC5cbiAgICAgICAgdGhpcy5vcHRzID0gT2JqZWN0LmFzc2lnbih0aGlzLm9wdHMsIG9wdHMpO1xuXG4gICAgICAgIC8vIE1ha2Ugc3VyZSBmaWx0ZXIgaXMgdXBkYXRlZCBhcyBpdCBkZXBlbmRzIG9uIHRoZSBvcHRpb25zLlxuICAgICAgICB0aGlzLnVwZGF0ZUZpbHRlcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgZmlsdGVyLiBUaGlzIGNvbnN0cnVjdHMgYSBrZXJuZWwgZm9yIGdpdmVuIGtlcm5lbCBzaXplIChuKSBhbmQgc3RhbmRhcmQgZGV2aWF0aW9uIChzaWdtYSkuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHJpdmF0ZSB1cGRhdGVGaWx0ZXIoKSB7XG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGtlcm5lbCB3aXRoIHplcm9zLlxuICAgICAgICBjb25zdCBtYXRyaXg6IG51bWJlcltdW10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiB0aGlzLm9wdHMubiB9LCAoKSA9PiBuZXcgQXJyYXkodGhpcy5vcHRzLm4pLmZpbGwoMCkpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBhbiBhcnJheSB0aGF0IGhvbGRzIG4gZXZlbmx5IHNwYWNlZCBzYW1wbGVzIGZyb20gMS1EIGdhdXNzaWFuIGRpc3RyaWJ1dGlvbiBiZXR3ZWVuIC0yKnNpZ21hIGFuZCAyKnNpZ21hLlxuICAgICAgICBsZXQgZGlzdCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IHRoaXMub3B0cy5uIH0sIChfLCB4KSA9PiBnYXVzc2lhbigtMiArIHggKiAoNCAvICh0aGlzLm9wdHMubiAtIDEpKSwgdGhpcy5vcHRzLnNpZ21hKSk7XG5cbiAgICAgICAgLy8gRGl2aWRlIGVhY2ggZWxlbWVudCBieSB0aGUgb3ZlcmFsbCBzdW0sIHRvIG1ha2Ugc3VyZSB0aGUgYXJyYXkgYWRkcyB1cCB0byAxLlxuICAgICAgICBjb25zdCBzdW0gPSBkaXN0LnJlZHVjZSgoYWNjLCB2YWwpID0+IGFjYyArIHZhbCwgMCk7XG4gICAgICAgIGRpc3QgPSBkaXN0Lm1hcCh4ID0+IHggLyBzdW0pO1xuXG4gICAgICAgIC8vIENvbnN0cnVjdCB0aGUgcmVzdWx0aW5nIGtlcm5lbC4gU2luY2UgdGhlcmUgaXMgbm8gY29ycmVsYXRpb24gYmV0d2VlbiBheGVzLCBqdXN0IG11bHRpcGx5IHR3byAxLUQgZ2F1c3NpYW4gZGlzdHJpYnV0aW9uc1xuICAgICAgICAvLyB0byBmaW5kIHRoZSB2YWx1ZSBvZiAyLUQgZ2F1c3NpYW4gZGlzdHJpYnV0aW9uIGF0IGFueSBwb3NpdGlvbi5cbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLm9wdHMubjsgeCsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMub3B0cy5uOyB5KyspIHtcbiAgICAgICAgICAgICAgICBtYXRyaXhbeF1beV0gPSBkaXN0W3hdICogZGlzdFt5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZpbHRlciA9IG5ldyBCYXNpY0ZpbHRlcihtYXRyaXgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERvIGEgY29udm9sdXRpb24gYW5kIHJldHVybiB0aGUgcmVzdWx0LiBUaGlzIG1ldGhvZCBkb2VzIG5vdCBtdXRhdGUgdGhlIG9yaWdpbmFsIGltYWdlLlxuICAgICAqIEBwYXJhbSBzb3VyY2UgLSBTb3VyY2UgaW1hZ2UuXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCByZXN1bHRpbmcgaW1hZ2UgKHdpdGggb3JpZ2luYWwgY2hhbm5lbCBjb3VudCkuXG4gICAgICovXG4gICAgcnVuKHNvdXJjZTogQml0bWFwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlci5ydW4oc291cmNlKTtcbiAgICB9XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgR2F1c3NpYW5CbHVyIHtcbiAgICAvKipcbiAgICAgKiBSZXByZXNlbnRzIG9wdGlvbnMgZm9yIHRoZSBnYXVzc2lhbiBibHVycmluZy5cbiAgICAgKi9cbiAgICBleHBvcnQgaW50ZXJmYWNlIE9wdHMge1xuICAgICAgICAvKipcbiAgICAgICAgICogU3RhbmRhcmQgZGV2aWF0aW9uIG9mIHRoZSBnYXVzc2lhbiBkaXN0cmlidXRpb25cbiAgICAgICAgICovXG4gICAgICAgIHNpZ21hPzogbnVtYmVyO1xuICAgICAgICAvKipcbiAgICAgICAgICogU2l6ZSBvZiB0aGUga2VybmVsXG4gICAgICAgICAqL1xuICAgICAgICBuPzogbnVtYmVyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgc29iZWwgZmlsdGVyLlxuICovXG5leHBvcnQgY2xhc3MgU29iZWwge1xuICAgIC8qKlxuICAgICAqIFRoZSBrZXJuZWwgdGhhdCBlc3RpbWF0ZXMgaG9yaXpvbnRhbCBncmFkaWVudC4gVHJhbnNwb3NlIG9mIHRoaXMgdXNlZCB0byBlc3RpbWF0ZSB0aGUgdmVydGljYWwgZ3JhZGllbnQuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBkeEZpbHRlcjogQmFzaWNGaWx0ZXI7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBzb2JlbCBmaWx0ZXIuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZHhGaWx0ZXIgPSBuZXcgQmFzaWNGaWx0ZXIoW1xuICAgICAgICAgICAgWzEsIDAsIC0xXSxcbiAgICAgICAgICAgIFsyLCAwLCAtMl0sXG4gICAgICAgICAgICBbMSwgMCwgLTFdXG4gICAgICAgIF0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJ1biB0aGUgZmlsdGVyLiBUaGlzIG1ldGhvZCBkb2VzIG5vdCBtdXRhdGUgdGhlIHNvdXJjZSBpbWFnZS5cbiAgICAgKiBAcGFyYW0gc291cmNlIC0gVGhlIHNvdXJjZSBpbWFnZS5cbiAgICAgKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSByZXN1bHRpbmcgaW1hZ2UgKHdpdGggc2luZ2xlIGNoYW5uZWwpLlxuICAgICAqL1xuICAgIHJ1bihzb3VyY2U6IEJpdG1hcCkge1xuICAgICAgICAvLyBNYWtlIHRoZSBpbWFnZSBncmF5c2NhbGUsIGlmIG5vdC5cbiAgICAgICAgaWYgKHNvdXJjZS5jaGFubmVsTnVtYmVyID4gMSkge1xuICAgICAgICAgICAgc291cmNlID0gc291cmNlLnRvR3JheVNjYWxlKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgdGhpcy5keEZpbHRlci5ydW4oc291cmNlKSwgLy8gSG9yaXpvbnRhbCBncmFkaWVudHMuXG4gICAgICAgICAgICB0aGlzLmR4RmlsdGVyLnRyYW5zcG9zZSgpLnJ1bihzb3VyY2UpIC8vIFZlcnRpY2FsIGdyYWRpZW50cy5cbiAgICAgICAgXSkudGhlbigoW2d4LCBneV0pID0+IHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgaW1hZ2Ugb2JqZWN0IHRoYXQgaG9sZHMgdGhlIG1hZ25pdHVkZSBvZiB0aGUgZ3JhZGllbnRzLlxuICAgICAgICAgICAgY29uc3QgZyA9IG5ldyBCaXRtYXAoc291cmNlLndpZHRoLCBzb3VyY2UuaGVpZ2h0KTtcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgaW1hZ2Ugb2JqZWN0IHRoYXQgaG9sZHMgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZ3JhZGllbnRzLlxuICAgICAgICAgICAgY29uc3QgdGhldGEgPSBuZXcgQml0bWFwKHNvdXJjZS53aWR0aCwgc291cmNlLmhlaWdodCk7XG5cbiAgICAgICAgICAgIC8vIEZpbGwgaW1hZ2Ugb2JqZWN0cyB3aXRoIGFwcHJvcHJpYXRlIHZhbHVlcy5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc291cmNlLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzb3VyY2Uud2lkdGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB0aGV0YS5zZXQoaSwgaiwgTWF0aC5hdGFuMihneS5nZXQoaSwgaiksIGd4LmdldChpLCBqKSkpO1xuICAgICAgICAgICAgICAgICAgICBnLnNldChpLCBqLCBNYXRoLnNxcnQoTWF0aC5wb3coZ3kuZ2V0KGksIGopLCAyKSArIE1hdGgucG93KGd4LmdldChpLCBqKSwgMikpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyBnLCB0aGV0YSB9O1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBHYXVzc2lhbkJsdXIsIFNvYmVsIH0gZnJvbSAnLi9maWx0ZXInO1xuaW1wb3J0IHsgQml0bWFwIH0gZnJvbSAnLi9pbWFnZSc7XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIGNhbm55IGVkZ2UgZGV0ZWN0aW9uLlxuICovXG5leHBvcnQgY2xhc3MgQ2Fubnkge1xuXG4gICAgLyoqXG4gICAgICogVGhlIG9wdGlvbnMuXG4gICAgICovXG4gICAgcHJpdmF0ZSBvcHRzOiBSZXF1aXJlZDxDYW5ueS5PcHRzPiA9IHtcbiAgICAgICAgbG93VGhyZXNob2xkUmF0aW86IDAuMixcbiAgICAgICAgaGlnaFRocmVzaG9sZFJhdGlvOiAwLjUsXG4gICAgICAgIGdhdXNzaWFuQmx1ck9wdHM6IHtcbiAgICAgICAgICAgIG46IDUsXG4gICAgICAgICAgICBzaWdtYTogMVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIGNhbm55IGVkZ2UgZGV0ZWN0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0gb3B0cyAtIFRoZSBvcHRpb25zLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdHM/OiBDYW5ueS5PcHRzKSB7XG4gICAgICAgIGlmIChvcHRzKSB7XG4gICAgICAgICAgICB0aGlzLnNldE9wdHMob3B0cyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIG9wdGlvbnMuXG4gICAgICogQHBhcmFtIG9wdHMgLSBUaGUgbmV3IG9wdGlvbnMuXG4gICAgICovXG4gICAgc2V0T3B0cyhvcHRzOiBDYW5ueS5PcHRzKSB7XG4gICAgICAgIGlmIChvcHRzLmdhdXNzaWFuQmx1ck9wdHMpIHtcbiAgICAgICAgICAgIHRoaXMub3B0cy5nYXVzc2lhbkJsdXJPcHRzID0gT2JqZWN0LmFzc2lnbih0aGlzLm9wdHMuZ2F1c3NpYW5CbHVyT3B0cywgb3B0cy5nYXVzc2lhbkJsdXJPcHRzKTtcbiAgICAgICAgICAgIGRlbGV0ZSBvcHRzLmdhdXNzaWFuQmx1ck9wdHM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vcHRzID0gT2JqZWN0LmFzc2lnbih0aGlzLm9wdHMsIG9wdHMpO1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0cy5sb3dUaHJlc2hvbGRSYXRpbyAhPT0gJ251bWJlcicgfHwgdHlwZW9mIHRoaXMub3B0cy5oaWdoVGhyZXNob2xkUmF0aW8gIT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0hpZ2ggYW5kIGxvdyB0aHJlc2hvbGQgdmFsdWVzIHNob3VsZCBiZSByZWFsIG51bWJlcnMgYmV0d2VlbiAwIGFuZCAxJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub3B0cy5sb3dUaHJlc2hvbGRSYXRpbyA+PSB0aGlzLm9wdHMuaGlnaFRocmVzaG9sZFJhdGlvKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvdyB0aHJlc2hvbGQgdmFsdWUgc2hvdWxkIGJlIHNtYWxsZXIgdGhhbiBoaWdoIHRocmVzaG9sZCB2YWx1ZS4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gbm9uLW1heGltdW0gc3VwcHJlc3Npb24uIFRoaXMgaXMgdGhlIGZpcnN0IHN0ZXAgb2YgY2FubnkgZWRnZSBkZXRlY3Rpb24gYW5kXG4gICAgICogaXMgdXNlZCB0byBtYWtlIHRoZSBlZGdlcyBkZXRlY3RlZCBieSBTb2JlbCB0aGlubmVyLlxuICAgICAqIEBwYXJhbSBnIC0gVGhlIGJpdG1hcCBpbWFnZSB0aGF0IGhvbGRzIHRoZSBncmFkaWVudCBtYWduaXR1ZGVzLlxuICAgICAqIEBwYXJhbSB0aGV0YSAtIFRoZSBiaXRtYXAgaW1hZ2UgdGhhdCBjb250YWlucyB0aGUgZ3JhZGllbnQgZGlyZWN0aW9ucy5cbiAgICAgKiBAcmV0dXJucyBBIGJpdG1hcCBpbWFnZSB0aGF0IGNvbnRhaW5zIHRoaW5uZWQgZWRnZXNcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIG5vbk1heGltdW1TdXBwcmVzc2lvbihnOiBCaXRtYXAsIHRoZXRhOiBCaXRtYXApIHtcbiAgICAgICAgY29uc3QgdGhpbm5lZEVkZ2VzID0gbmV3IEJpdG1hcChnLndpZHRoLCBnLmhlaWdodCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAyOyBpIDwgdGhpbm5lZEVkZ2VzLmhlaWdodCAtIDI7IGkrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDI7IGogPCB0aGlubmVkRWRnZXMud2lkdGggLSAyOyBqKyspIHtcbiAgICAgICAgICAgICAgICAvLyBhIGFuZCBiIHJlcHJlc2VudHMgdGhlIG5laWdoYm9yIHBpeGVscyBvZiB0aGUgY3VycmVudCBwaXhlbCBhbG9uZyB0aGUgZGlyZWN0aW9uIG9mIHRoZSBncmFkaWVudC5cbiAgICAgICAgICAgICAgICBsZXQgYSA9IDI1NSwgYiA9IDI1NTtcbiAgICAgICAgICAgICAgICBsZXQgYW5nbGUgPSB0aGV0YS5nZXQoaSwgaikgKiAxODAgLyBNYXRoLlBJO1xuICAgICAgICAgICAgICAgIGlmIChhbmdsZSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYW5nbGUgKz0gMTgwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIERldGVybWluZSBhIGFuZCBiJ3MgdmFsdWVzIGFjY29yZGluZyB0byB0aGUgZ3JhZGllbnQgZGlyZWN0aW9uLlxuICAgICAgICAgICAgICAgIGlmICgoMCA8PSBhbmdsZSAmJiBhbmdsZSA8IDIyLjUpIHx8ICgxNTcuNSA8PSBhbmdsZSAmJiBhbmdsZSA8PSAxODApKSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSBnLmdldChpLCBqICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBnLmdldChpLCBqIC0gMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgyMi41IDw9IGFuZ2xlICYmIGFuZ2xlIDwgNjcuNSkge1xuICAgICAgICAgICAgICAgICAgICBhID0gZy5nZXQoaSArIDEsIGogKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgYiA9IGcuZ2V0KGkgLSAxLCBqIC0gMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICg2Ny41IDw9IGFuZ2xlICYmIGFuZ2xlIDwgMTEyLjUpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IGcuZ2V0KGkgKyAxLCBqKTtcbiAgICAgICAgICAgICAgICAgICAgYiA9IGcuZ2V0KGkgLSAxLCBqKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDExMi41IDw9IGFuZ2xlICYmIGFuZ2xlIDwgMTU3LjUpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IGcuZ2V0KGkgLSAxLCBqICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBnLmdldChpICsgMSwgaiAtIDEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElmIGN1cnJlbnQgcGl4ZWwgaXMgbm90IHRoZSBsb2NhbCBtYXhpbXVtLCBzdXBwcmVzcyBpdC5cbiAgICAgICAgICAgICAgICBpZiAoZy5nZXQoaSwgaikgPj0gYSAmJiBnLmdldChpLCBqKSA+PSBiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaW5uZWRFZGdlcy5zZXQoaSwgaiwgZy5nZXQoaSwgaikpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaW5uZWRFZGdlcy5zZXQoaSwgaiwgMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaW5uZWRFZGdlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYXRlZ29yaXplIHRoZSBwaXhlbHMgaW50byB0d28gZ3JvdXBzOiBgTG93IDw9IFdlYWsgPCBIaWdoYCBhbmQgYEhpZ2ggPCBTdHJvbmdgIGFjY29yZGluZyB0byB0aGUgZ2l2ZW4gdGhyZXNob2xkIHZhbHVlcy5cbiAgICAgKiBTdXBwcmVzcyB0aGUgcGl4ZWxzIHRoYXQgYXJlIGxvd2VyIHRoYW4gdGhlIGxvdyB0aHJlc2hvbGQuXG4gICAgICogQHBhcmFtIGcgLSBUaGUgYml0bWFwIGltYWdlIHRoYXQgaG9sZHMgdGhlIGdyYWRpZW50IG1hZ25pdHVkZXMuXG4gICAgICogQHBhcmFtIGxvdyAtIFRoZSBsb3cgdGhyZXNob2xkIHZhbHVlLlxuICAgICAqIEBwYXJhbSBoaWdoIC0gVGhlIGhpZ2ggdGhyZXNob2xkIHZhbHVlLlxuICAgICAqIEByZXR1cm5zIEEgYml0bWFwIGltYWdlIHRoYXQgY29udGFpbnMgY2F0ZWdvcml6ZWQgcGl4ZWxzLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgdGhyZXNob2xkKGc6IEJpdG1hcCwgbG93OiBudW1iZXIsIGhpZ2g6IG51bWJlcikge1xuICAgICAgICBjb25zdCByZXMgPSBnLmNsb25lKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAyOyBpIDwgcmVzLmhlaWdodCAtIDI7IGkrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDI7IGogPCByZXMud2lkdGggLSAyOyBqKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwaXhlbCA9IHJlcy5nZXQoaSwgaik7XG4gICAgICAgICAgICAgICAgaWYgKHBpeGVsIDwgbG93KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5zZXQoaSwgaiwgMCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwaXhlbCA8IGhpZ2gpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnNldChpLCBqLCBDYW5ueS5XRUFLKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXMuc2V0KGksIGosIENhbm55LlNUUk9ORyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBoeXN0ZXJlc2lzIHRvIG9ubHkga2VlcCBzdHJvbmcgZWRnZXMuXG4gICAgICogQHBhcmFtIGcgLSBUaGUgYml0bWFwIGltYWdlIHRoYXQgaG9sZHMgdGhlIGdyYWRpZW50IG1hZ25pdHVkZXMuXG4gICAgICogQHJldHVybnMgQSBiaXRtYXAgaW1hZ2UgdGhhdCBjb250YWlucyBvbmx5IHRoZSBzdHJvbmcgZWRnZXMuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBoeXN0ZXJlc2lzKGc6IEJpdG1hcCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMjsgaSA8IGcuaGVpZ2h0IC0gMjsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMjsgaiA8IGcud2lkdGggLSAyOyBqKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwaXhlbCA9IGcuZ2V0KGksIGopO1xuICAgICAgICAgICAgICAgIGlmIChwaXhlbCA9PT0gQ2FubnkuV0VBSykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZy5nZXQoaSAtIDEsIGogLSAxKSA9PT0gQ2FubnkuU1RST05HIHx8IGcuZ2V0KGkgLSAxLCBqKSA9PT0gQ2FubnkuU1RST05HXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCBnLmdldChpIC0gMSwgaiArIDEpID09PSBDYW5ueS5TVFJPTkcgfHwgZy5nZXQoaSwgaiAtIDEpID09PSBDYW5ueS5TVFJPTkdcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8IGcuZ2V0KGksIGogKyAxKSA9PT0gQ2FubnkuU1RST05HIHx8IGcuZ2V0KGkgKyAxLCBqIC0gMSkgPT09IENhbm55LlNUUk9OR1xuICAgICAgICAgICAgICAgICAgICAgICAgfHwgZy5nZXQoaSArIDEsIGopID09PSBDYW5ueS5TVFJPTkcgfHwgZy5nZXQoaSArIDEsIGogKyAxKSA9PT0gQ2FubnkuU1RST05HXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZy5zZXQoaSwgaiwgQ2FubnkuU1RST05HKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGcuc2V0KGksIGosIDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHRoZSBlZGdlIGRldGVjdGlvbi4gVGhpcyBkb2VzIG5vdCBtdXRhdGUgdGhlIHNvdXJjZSBpbWFnZS5cbiAgICAgKiBAcGFyYW0gc291cmNlIC0gVGhlIHNvdXJjZSBpbWFnZS5cbiAgICAgKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHJlc3VsdGluZyBpbWFnZSAod2l0aCBzaW5nbGUgY2hhbm5lbCkuXG4gICAgICovXG4gICAgcnVuKHNvdXJjZTogQml0bWFwKSB7XG4gICAgICAgIHJldHVybiBuZXcgR2F1c3NpYW5CbHVyKHRoaXMub3B0cy5nYXVzc2lhbkJsdXJPcHRzKS5ydW4oc291cmNlKVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IG5ldyBTb2JlbCgpLnJ1bihyZXMpKVxuICAgICAgICAgICAgLnRoZW4oKHsgZywgdGhldGEgfSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGhpZ2hUaHJlc2hvbGQgPSBzb3VyY2UubWF4KCkgKiB0aGlzLm9wdHMuaGlnaFRocmVzaG9sZFJhdGlvO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvd1RocmVzaG9sZCA9IGhpZ2hUaHJlc2hvbGQgKiB0aGlzLm9wdHMubG93VGhyZXNob2xkUmF0aW87XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaHlzdGVyZXNpcyh0aGlzLnRocmVzaG9sZCh0aGlzLm5vbk1heGltdW1TdXBwcmVzc2lvbihnLCB0aGV0YSksIGxvd1RocmVzaG9sZCwgaGlnaFRocmVzaG9sZCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgbmFtZXNwYWNlIENhbm55IHtcbiAgICAvKipcbiAgICAgKiBSZXByZXNlbnRzIG9wdGlvbnMgZm9yIGNhbm55IGVkZ2UgZGV0ZWN0aW9uLlxuICAgICAqL1xuICAgIGV4cG9ydCBpbnRlcmZhY2UgT3B0cyB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHZhbHVlIHRoYXQgaXMgdXNlZCB0byBkZXRlcm1pbmUgbG93IHRocmVzaG9sZCB2YWx1ZSB3aGlsZSBwZXJmb3JtaW5nIHRocmVzaG9sZGluZy5cbiAgICAgICAgICogVGhlIGZvcm11bGE6IGBMb3cgVGhyZXNob2xkIFZhbHVlID0gSGlnaCBUaHJlc2hvbGQgVmFsdWUgeCBMb3cgVGhyZXNob2xkIFJhdGlvYFxuICAgICAgICAgKi9cbiAgICAgICAgbG93VGhyZXNob2xkUmF0aW8/OiBudW1iZXI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHZhbHVlIHRoYXQgaXMgdXNlZCB0byBkZXRlcm1pbmUgaGlnaCB0aHJlc2hvbGQgdmFsdWUgd2hpbGUgcGVyZm9ybWluZyB0aHJlc2hvbGRpbmcuXG4gICAgICAgICAqIFRoZSBmb3JtdWxhOiBgSGlnaCBUaHJlc2hvbGQgVmFsdWUgPSBNYXhpbXVtIFBpeGVsIFZhbHVlIGluIHRoZSBTb3VyY2UgSW1hZ2UgeCBIaWdoIFRocmVzaG9sZCBSYXRpb2BcbiAgICAgICAgICovXG4gICAgICAgIGhpZ2hUaHJlc2hvbGRSYXRpbz86IG51bWJlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9wdGlvbnMgZm9yIGdhdXNzaWFuIGJsdXJyaW5nIHRoYXQgaXMgcGVyZm9ybWVkIGJlZm9yZSBzdGFydGluZyBlZGdlIGRldGVjdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIGdhdXNzaWFuQmx1ck9wdHM/OiBHYXVzc2lhbkJsdXIuT3B0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25zdGFudCB2YWx1ZSBmb3IgcGl4ZWxzIGNhdGVnb3JpemVkIHdlYWsuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgZXhwb3J0IGNvbnN0IFdFQUsgPSAxMDA7XG5cbiAgICAvKipcbiAgICAgKiBDb25zdGFudCB2YWx1ZSBmb3IgcGl4ZWxzIGNhdGVnb3JpemVkIHN0cm9uZy5cbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBleHBvcnQgY29uc3QgU1RST05HID0gMjU1O1xufVxuIiwiaW1wb3J0IHsgcmFuZG9tIH0gZnJvbSAnLi91dGlsJztcblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgSy1NZWFucyBjbHVzdGVyaW5nLlxuICovXG5leHBvcnQgY2xhc3MgS01lYW5zIHtcblxuICAgIC8qKlxuICAgICAqIFRoZSBvcHRpb25zLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgb3B0cyA9IHsgbWF4SXRlcmF0aW9uczogMCwgY2x1c3Rlck51bWJlcjogMiB9O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgSy1NZWFucyBjbHVzdGVyaW5nIG9iamVjdC5cbiAgICAgKiBAcGFyYW0gb3B0cyAtIFRoZSBvcHRpb25zLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdHM/OiBLTWVhbnMuT3B0cykge1xuICAgICAgICBpZiAob3B0cykge1xuICAgICAgICAgICAgdGhpcy5zZXRPcHRzKG9wdHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSBvcHRzIC0gVGhlIG5ldyBvcHRpb25zLlxuICAgICAqL1xuICAgIHNldE9wdHMob3B0czogS01lYW5zLk9wdHMpIHtcbiAgICAgICAgdGhpcy5vcHRzID0gT2JqZWN0LmFzc2lnbih0aGlzLm9wdHMsIG9wdHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IGNsdXN0ZXJpbmcuXG4gICAgICogQHBhcmFtIHNhbXBsZXMgLSBUaGUgc2FtcGxlcy5cbiAgICAgKiBAcmV0dXJucyBBbiBvYmplY3Qgd2l0aCB0d28gZmllbGRzOlxuICAgICAqICAtIGBjbHVzdGVyc2A6IGFuIGFycmF5IHRoYXQgaG9sZHMgY2x1c3RlciBpbmRleCBmb3IgZWFjaCBzYW1wbGUuXG4gICAgICogIC0gYGNlbnRyb2lkc2A6IGFuIGFycmF5IHRoYXQgaG9sZHMgdGhlIGNlbnRyb2lkIG9mIGVhY2ggY2x1c3Rlci5cbiAgICAgKi9cbiAgICBydW4oc2FtcGxlczogS01lYW5zLlNhbXBsZXMpOiBQcm9taXNlPHsgY2x1c3RlcnM6IG51bWJlcltdLCBjZW50cm9pZHM6IG51bWJlcltdW10gfT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBjZW50cm9pZHMgd2l0aCAwLlxuICAgICAgICAgICAgICAgIGNvbnN0IGNlbnRyb2lkczogbnVtYmVyW11bXSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IHRoaXMub3B0cy5jbHVzdGVyTnVtYmVyIH0sXG4gICAgICAgICAgICAgICAgICAgICgpID0+IG5ldyBBcnJheShzYW1wbGVzLmRpbWVuc2lvbk51bWJlcikuZmlsbCgwKSk7XG4gICAgICAgICAgICAgICAgLy8gQW4gYXJyYXkgaG9sZHMgdGhlIGNsdXN0ZXIgaW5kZXggb2YgZWFjaCBzYW1wbGUuIEFsbCBwb2ludHMgYmVsb25nIHRvIHRoZSBmaXJzdCBjbHVzdGVyIGF0IHRoZSBiZWdpbm5pbmcuXG4gICAgICAgICAgICAgICAgY29uc3Qgc2FtcGxlQ2x1c3RlcklkeGVzOiBudW1iZXJbXSA9IG5ldyBBcnJheShzYW1wbGVzLmxlbmd0aCkuZmlsbCgwKTtcbiAgICAgICAgICAgICAgICBsZXQgbnVtYmVyT2ZJdGVyYXRpb25zID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgY2VudHJvaWRzRG9Ob3RDaGFuZ2VGb3IgPSAwO1xuICAgICAgICAgICAgICAgIGxldCBjbHVzdGVyc0RvTm90Q2hhbmdlRm9yID0gMDtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHJhbmRvbUNlbnRyb2lkczogbnVtYmVyW11bXSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHVuaXF1ZSBjZW50cm9pZHMuXG4gICAgICAgICAgICAgICAgd2hpbGUgKHJhbmRvbUNlbnRyb2lkcy5sZW5ndGggPCB0aGlzLm9wdHMuY2x1c3Rlck51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByYW5kSWR4ID0gcmFuZG9tKHNhbXBsZXMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmRvbUNlbnRyb2lkcy5maWx0ZXIoY2VudHJvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50cm9pZC5tYXAoKHYsIGQpID0+IHYgLSBzYW1wbGVzLmdldChyYW5kSWR4LCBkKSkuZmlsdGVyKHYgPT4gdiA9PT0gMCkubGVuZ3RoID09PSBjZW50cm9pZC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICApLmxlbmd0aCA8IDFcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50cm9pZHNbcmFuZG9tQ2VudHJvaWRzLmxlbmd0aF0gPSBjZW50cm9pZHNbcmFuZG9tQ2VudHJvaWRzLmxlbmd0aF0ubWFwKChfLCBkKSA9PiBzYW1wbGVzLmdldChyYW5kSWR4LCBkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByYW5kb21DZW50cm9pZHMucHVzaChjZW50cm9pZHNbcmFuZG9tQ2VudHJvaWRzLmxlbmd0aF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgY2x1c3RlckNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgc2FtcGxlSWR4ID0gMDsgc2FtcGxlSWR4IDwgc2FtcGxlcy5sZW5ndGg7IHNhbXBsZUlkeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2xvc2VzdENlbnRyb2lkSWR4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjbG9zZXN0Q2VudHJvaWREaXN0YW5jZSA9IEluZmluaXR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgY2x1c3RlcklkeCA9IDA7IGNsdXN0ZXJJZHggPCBjZW50cm9pZHMubGVuZ3RoOyBjbHVzdGVySWR4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGlzdGFuY2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGQgPSAwOyBkIDwgc2FtcGxlcy5kaW1lbnNpb25OdW1iZXI7IGQrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZSArPSBNYXRoLnBvdyhjZW50cm9pZHNbY2x1c3RlcklkeF1bZF0gLSBzYW1wbGVzLmdldChzYW1wbGVJZHgsIGQpLCAyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2UgPSBNYXRoLnNxcnQoZGlzdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8IGNsb3Nlc3RDZW50cm9pZERpc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RDZW50cm9pZERpc3RhbmNlID0gZGlzdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RDZW50cm9pZElkeCA9IGNsdXN0ZXJJZHg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNsdXN0ZXJDaGFuZ2VkICYmIHNhbXBsZUNsdXN0ZXJJZHhlc1tzYW1wbGVJZHhdICE9PSBjbG9zZXN0Q2VudHJvaWRJZHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHVzdGVyQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVDbHVzdGVySWR4ZXNbc2FtcGxlSWR4XSA9IGNsb3Nlc3RDZW50cm9pZElkeDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjbHVzdGVyQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2x1c3RlcnNEb05vdENoYW5nZUZvciA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbHVzdGVyc0RvTm90Q2hhbmdlRm9yKys7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBsZXQgbmV3Q2VudHJvaWRzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogdGhpcy5vcHRzLmNsdXN0ZXJOdW1iZXIgfSwgKCkgPT4gbmV3IEFycmF5KHNhbXBsZXMuZGltZW5zaW9uTnVtYmVyKS5maWxsKDApKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBzYW1wbGVJZHggPSAwOyBzYW1wbGVJZHggPCBzYW1wbGVzLmxlbmd0aDsgc2FtcGxlSWR4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGQgPSAwOyBkIDwgc2FtcGxlcy5kaW1lbnNpb25OdW1iZXI7IGQrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NlbnRyb2lkc1tzYW1wbGVDbHVzdGVySWR4ZXNbc2FtcGxlSWR4XV1bZF0gKz0gc2FtcGxlcy5nZXQoc2FtcGxlSWR4LCBkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIG5ld0NlbnRyb2lkcyA9IG5ld0NlbnRyb2lkcy5tYXAoKGNlbnRyb2lkLCBjbHVzdGVySWR4KSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgY2VudHJvaWQubWFwKHggPT4geCAvIHNhbXBsZUNsdXN0ZXJJZHhlcy5maWx0ZXIoaWR4ID0+IGlkeCA9PT0gY2x1c3RlcklkeCkubGVuZ3RoKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGNlbnRyb2lkc0NoYW5nZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjZW50cm9pZElkeCA9IDA7IGNlbnRyb2lkSWR4IDwgY2VudHJvaWRzLmxlbmd0aDsgY2VudHJvaWRJZHgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZCA9IDA7IGQgPCBzYW1wbGVzLmRpbWVuc2lvbk51bWJlcjsgZCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRyb2lkc1tjZW50cm9pZElkeF1bZF0gIT09IG5ld0NlbnRyb2lkc1tjZW50cm9pZElkeF1bZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VudHJvaWRzW2NlbnRyb2lkSWR4XVtkXSA9IG5ld0NlbnRyb2lkc1tjZW50cm9pZElkeF1bZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRyb2lkc0NoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjZW50cm9pZHNDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50cm9pZHNEb05vdENoYW5nZUZvciA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50cm9pZHNEb05vdENoYW5nZUZvcisrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG51bWJlck9mSXRlcmF0aW9ucysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB3aGlsZSAoIShcbiAgICAgICAgICAgICAgICAgICAgKGNlbnRyb2lkc0RvTm90Q2hhbmdlRm9yID4gMikgfHxcbiAgICAgICAgICAgICAgICAgICAgKGNsdXN0ZXJzRG9Ob3RDaGFuZ2VGb3IgPiAyKSB8fFxuICAgICAgICAgICAgICAgICAgICAodGhpcy5vcHRzLm1heEl0ZXJhdGlvbnMgIT09IDAgJiYgbnVtYmVyT2ZJdGVyYXRpb25zID4gdGhpcy5vcHRzLm1heEl0ZXJhdGlvbnMpXG4gICAgICAgICAgICAgICAgKSk7XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKHsgY2x1c3RlcnM6IHNhbXBsZUNsdXN0ZXJJZHhlcywgY2VudHJvaWRzIH0pO1xuXG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgbmFtZXNwYWNlIEtNZWFucyB7XG5cbiAgICAvKipcbiAgICAgKiBSZXByZXNlbnRzIG9wdGlvbnMgZm9yIEstTWVhbnMuXG4gICAgICovXG4gICAgZXhwb3J0IGludGVyZmFjZSBPcHRzIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgbWF4aW11bSBpdGVyYXRpb25zLiBXaGVuIGl0IGlzIGV4Y2VlZGVkLCBhbGdvcml0aG0gc3RvcHMgaW1tZWRpYXRlbHkuXG4gICAgICAgICAqL1xuICAgICAgICBtYXhJdGVyYXRpb25zPzogbnVtYmVyO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG51bWJlciBjbHVzdGVycy5cbiAgICAgICAgICovXG4gICAgICAgIGNsdXN0ZXJOdW1iZXI/OiBudW1iZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwcmVzZW50cyB0aGUgaW5wdXQgb2YgYSBLLU1lYW5zIGFsZ29yaXRobS4gQWxsIGlucHV0cyBzaGFsbCBpbXBsZW1lbnQgdGhpcyBpbnRlcmZhY2UuXG4gICAgICovXG4gICAgZXhwb3J0IGludGVyZmFjZSBTYW1wbGVzIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2Ygc2FtcGxlcy5cbiAgICAgICAgICovXG4gICAgICAgIHJlYWRvbmx5IGxlbmd0aDogbnVtYmVyO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGRpbWVuc2lvbiBvZiB0aGUgc2FtcGxlcy5cbiAgICAgICAgICovXG4gICAgICAgIHJlYWRvbmx5IGRpbWVuc2lvbk51bWJlcjogbnVtYmVyO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSBnZXR0ZXIgbWV0aG9kIHRoYXQgcmV0dXJucyBpLXRoIHNhbXBsZSdzIHZhbHVlIGluIGBkaW1lbnNpb25gLXRoIGRpbWVuc2lvbi5cbiAgICAgICAgICovXG4gICAgICAgIGdldChpZHg6IG51bWJlciwgZGltZW5zaW9uOiBudW1iZXIpOiBudW1iZXI7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQml0bWFwIH0gZnJvbSAnLi9pbWFnZSc7XG5pbXBvcnQgeyBLTWVhbnMgfSBmcm9tICcuL2stbWVhbnMnO1xuXG4vKipcbiAqIEEgY2xhc3MgdGhhdCBtYWtlcyB7QGxpbmsgQml0bWFwfXMgdXNhYmxlIGFzIGlucHV0IG9mIEstTWVhbnMgYnkgaW1wbGVtZW50aW5nIHtAbGluayBLTWVhbnMuU2FtcGxlc30uXG4gKiBAZXh0ZW5kcyBCaXRtYXBcbiAqL1xuZXhwb3J0IGNsYXNzIEtNZWFuc1NlZ21lbnRhdGlvbkJpdG1hcCBleHRlbmRzIEJpdG1hcCBpbXBsZW1lbnRzIEtNZWFucy5TYW1wbGVzIHtcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdCBhbiBzYW1wbGVzIG9iamVjdCB0aGF0IGNhbiBiZSB1c2VkIGFzIGlucHV0IG9mIEstTWVhbnMuXG4gICAgICogQHBhcmFtIGltYWdlIC0gVGhlIG9yaWdpbmFsIGltYWdlLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGltYWdlOiBCaXRtYXApIHtcbiAgICAgICAgc3VwZXIoaW1hZ2Uud2lkdGgsIGltYWdlLmhlaWdodCwgaW1hZ2UuY2hhbm5lbE51bWJlciwgaW1hZ2UucGl4ZWxzKTtcbiAgICB9XG5cbiAgICBnZXQoaWR4OiBudW1iZXIsIGRpbWVuc2lvbjogbnVtYmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBpeGVsc1tpZHggKiB0aGlzLmNoYW5uZWxOdW1iZXIgKyBkaW1lbnNpb25dO1xuICAgIH1cblxuICAgIGdldCBsZW5ndGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQ7XG4gICAgfVxuICAgIGdldCBkaW1lbnNpb25OdW1iZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5uZWxOdW1iZXI7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgSy1NZWFucyBzZWdtZW50YXRpb24gb24gaW1hZ2VzLlxuICovXG5leHBvcnQgY2xhc3MgS01lYW5zU2VnbWVudGF0aW9uIHtcbiAgICAvKipcbiAgICAgKiBUaGUgb3B0aW9ucy5cbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIG9wdHM6IFJlcXVpcmVkPEtNZWFuc1NlZ21lbnRhdGlvbi5PcHRzPiA9IHsgYnlJbnRlbnNpdHk6IGZhbHNlLCBjb2xvcnM6IDMgfTtcbiAgICAvKipcbiAgICAgKiBUaGUgYWN0dWFsIEttZWFucyBjbHVzdGVyaW5nIG9iamVjdCB0aGF0IHBlcmZvcm1zIHNlZ21lbnRhdGlvbi5cbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIGttZWFuczogS01lYW5zO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgSy1NZWFucyBzZWdtZW50YXRpb24gb2JqZWN0LlxuICAgICAqIEBwYXJhbSBvcHRzIC0gVGhlIG9wdGlvbnMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Iob3B0cz86IEtNZWFuc1NlZ21lbnRhdGlvbi5PcHRzKSB7XG4gICAgICAgIGlmIChvcHRzKSB7XG4gICAgICAgICAgICB0aGlzLnNldE9wdHMob3B0cyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVLbWVhbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgS01lYW5zIGNsdXN0ZXJpbmcgb2JqZWN0IGFjY29yZGluZyB0byB0aGUgY3VycmVudCBvcHRpb25zLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlS21lYW5zKCkge1xuICAgICAgICB0aGlzLmttZWFucyA9IG5ldyBLTWVhbnMoe1xuICAgICAgICAgICAgY2x1c3Rlck51bWJlcjogQXJyYXkuaXNBcnJheSh0aGlzLm9wdHMuY29sb3JzKSA/IHRoaXMub3B0cy5jb2xvcnMubGVuZ3RoIDogdGhpcy5vcHRzLmNvbG9ycyxcbiAgICAgICAgICAgIG1heEl0ZXJhdGlvbnM6IDEwXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0gb3B0cyAtIFRoZSBuZXcgb3B0aW9ucy5cbiAgICAgKi9cbiAgICBzZXRPcHRzKG9wdHM6IEtNZWFuc1NlZ21lbnRhdGlvbi5PcHRzKSB7XG4gICAgICAgIHRoaXMub3B0cyA9IE9iamVjdC5hc3NpZ24odGhpcy5vcHRzLCBvcHRzKTtcbiAgICAgICAgdGhpcy51cGRhdGVLbWVhbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBzZWdtZW50YXRpb24uIFRoaXMgbWV0aG9kIGRvZXMgbm90IG11dGF0ZSB0aGUgc291cmNlIGltYWdlLlxuICAgICAqIEBwYXJhbSBzb3VyY2UgLSBTb3VyY2UgaW1hZ2VcbiAgICAgKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCBpcyByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRpbmcgaW1hZ2UuXG4gICAgICogKHNpbmdsZSBjaGFubmVsIGlmIGBieUludGVuc2l0eWAgaXMgc2V0IGluIHtAbGluayBLTWVhbnNTZWdtZW50YXRpb24uT3B0c30pXG4gICAgICovXG4gICAgcnVuKHNvdXJjZTogQml0bWFwKSB7XG4gICAgICAgIGNvbnN0IHNhbXBsZXMgPSBuZXcgS01lYW5zU2VnbWVudGF0aW9uQml0bWFwKHRoaXMub3B0cy5ieUludGVuc2l0eSA/IHNvdXJjZS50b0dyYXlTY2FsZSgpIDogc291cmNlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMua21lYW5zLnJ1bihzYW1wbGVzKS50aGVuKCh7IGNsdXN0ZXJzLCBjZW50cm9pZHMgfSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5vcHRzLmJ5SW50ZW5zaXR5ID8gc2FtcGxlcy50b011bHRpQ2hhbm5lbCgzKSA6IHNhbXBsZXM7XG5cbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0aGlzLm9wdHMuY29sb3JzKSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0LndpZHRoICogcmVzdWx0LmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5waXhlbHNbaSAqIDNdID0gY2VudHJvaWRzW2NsdXN0ZXJzW2ldXVswXTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBpeGVsc1tpICogMyArIDFdID0gY2VudHJvaWRzW2NsdXN0ZXJzW2ldXVt0aGlzLm9wdHMuYnlJbnRlbnNpdHkgPyAwIDogMV07XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5waXhlbHNbaSAqIDMgKyAyXSA9IGNlbnRyb2lkc1tjbHVzdGVyc1tpXV1bdGhpcy5vcHRzLmJ5SW50ZW5zaXR5ID8gMCA6IDJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQud2lkdGggKiByZXN1bHQuaGVpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBpeGVsc1tpICogM10gPSB0aGlzLm9wdHMuY29sb3JzW2NsdXN0ZXJzW2ldXVswXTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnBpeGVsc1tpICogMyArIDFdID0gdGhpcy5vcHRzLmNvbG9yc1tjbHVzdGVyc1tpXV1bMV07XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5waXhlbHNbaSAqIDMgKyAyXSA9IHRoaXMub3B0cy5jb2xvcnNbY2x1c3RlcnNbaV1dWzJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBLTWVhbnNTZWdtZW50YXRpb24ge1xuICAgIC8qKlxuICAgICAqIFJlcHJlc2VudHMgb3B0aW9ucyBmb3IgSy1NZWFucyBzZWdtZW50YXRpb24gb24gaW1hZ2VzLlxuICAgICAqL1xuICAgIGV4cG9ydCBpbnRlcmZhY2UgT3B0cyB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZWdtZW50IGNvdW50LiBJdCBpcyBuYW1lZCBjb2xvcnMsIGJlY2F1c2UgaXQgY2FuIGFsc28gYmUgdXNlZCB0byBkaXJlY3RseSBzcGVjaWZ5IHRoZSBvdXRwdXQgY29sb3Igb2YgdGhlIHNlZ21lbnRzLlxuICAgICAgICAgKiBUbyBzcGVjaWZ5IGNvbG9ycywgcHJvdmlkZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIGNvbG9ycyBhcyBhcnJheSBvZiBSR0IgdmFsdWVzLCBlLmcgYFtbMCwwLDBdLCBbMTAwLDEwMCwxMDBdXWAgbWVhbnNcbiAgICAgICAgICogY3JlYXRlIDIgc2VnbWVudHMgYW5kIHVzZSBSOjAsIEc6MCwgQjowIGZvciB0aGUgZmlyc3Qgc2VnbWVudCBhbmQgUjoxMDAsIEc6MTAwLCBCOjEwMCBmb3IgdGhlIHNlY29uZCBvbmUuXG4gICAgICAgICAqIElmIG9ubHkgYSBudW1iZXIgaXMgc3VwcGxpZWQsIHRoZW4gdGhlIGNvbG9ycyB3aWxsIGJlIGRlcml2ZWQgZnJvbSB0aGUgbWVhbiBvZiB0aGUgc2VnbWVudHMsIGkuZSByZWR1Y2UgdGhlIGJpdC1kZXB0LlxuICAgICAgICAgKi9cbiAgICAgICAgY29sb3JzPzogbnVtYmVyW11bXSB8IG51bWJlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNwZWNpZmllcyB3aGV0aGVyIGludGVuc2l0eSAodHJlYXQgYXMgZ3JheXNjYWxlKSBvciB0aGUgYWN0dWFsIFJHQiB2YWx1ZXMgYXJlIHVzZWQgZm9yIGRvaW5nIHNlZ21lbnRhdGlvbiB3aGVuXG4gICAgICAgICAqIHRoZSBpbWFnZSBpcyBSR0IgY29sb3JlZC5cbiAgICAgICAgICovXG4gICAgICAgIGJ5SW50ZW5zaXR5PzogYm9vbGVhbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBCaXRtYXAsIERyYXdhYmxlIH0gZnJvbSAnLi4vc3JjL2ltYWdlJztcbmltcG9ydCB7IEdhdXNzaWFuQmx1ciwgU29iZWwsIEJhc2ljRmlsdGVyIH0gZnJvbSAnLi4vc3JjL2ZpbHRlcic7XG5pbXBvcnQgeyBDYW5ueSB9IGZyb20gJy4uL3NyYy9mZWF0dXJlJztcbmltcG9ydCB7IEtNZWFuc1NlZ21lbnRhdGlvbiB9IGZyb20gJy4uL3NyYy9zZWdtZW50YXRpb24nO1xuaW1wb3J0IHsgcmFuZG9tIH0gZnJvbSAnLi4vc3JjL3V0aWwnO1xuXG5jb25zdCBDQU5WQVNfU0laRSA9IDgwMDtcblxuY2xhc3MgRGVtb0FwcCB7XG5cbiAgICBFTFMgPSB7XG4gICAgICAgIGFwcDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwcCcpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBvdmVybGF5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBpbnB1dDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0JykgYXMgSFRNTENhbnZhc0VsZW1lbnQsXG4gICAgICAgIGltYWdlSW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbWFnZUlucHV0JykgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgbG9hZEltYWdlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZEltYWdlJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGxvYWRJbWFnZTI6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkSW1hZ2UyJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIHVuZG86IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1bmRvJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIHJlZG86IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWRvJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIGdyYXlzY2FsZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dyYXlzY2FsZScpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBzb2JlbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvYmVsJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgIHBvcHVwczoge1xuICAgICAgICAgICAga2VybmVsOiB7XG4gICAgICAgICAgICAgICAgb3BlbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tlcm5lbE9wZW4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBwb3B1cDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tlcm5lbFBvcHVwJykgYXMgSFRNTERpdkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgc2l6ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tlcm5lbE9wdGlvbnNTaXplJykgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgICAgICAgICBtYXRyaXg6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXJuZWxPcHRpb25zTWF0cml4JykgYXMgSFRNTERpdkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgYXBwbHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXJuZWxBcHBseScpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIGNhbmNlbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tlcm5lbENhbmNlbCcpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIGVycm9yOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2VybmVsRXJyb3InKSBhcyBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgICAgICAgICB0cmFuc3Bvc2U6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXJuZWxUcmFuc3Bvc2UnKSBhcyBIVE1MQnV0dG9uRWxlbWVudFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdhdXNzOiB7XG4gICAgICAgICAgICAgICAgb3BlbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhdXNzT3BlbicpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIHBvcHVwOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2F1c3NQb3B1cCcpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICAgICAgICAgIHNpemU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYXVzc1NpemUnKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIHNpZ21hOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2F1c3NTaWdtYScpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgYXBwbHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYXVzc0FwcGx5JykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2F1c3NDYW5jZWwnKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBlcnJvcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhdXNzRXJyb3InKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhbm55OiB7XG4gICAgICAgICAgICAgICAgb3BlbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55T3BlbicpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIHBvcHVwOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FubnlQb3B1cCcpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICAgICAgICAgIGxvdzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55TG93JykgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgICAgICAgICBoaWdoOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FubnlIaWdoJykgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgICAgICAgICBzaXplOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FubnlHYXVzc1NpemUnKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIHNpZ21hOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FubnlHYXVzc1NpZ21hJykgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgICAgICAgICBhcHBseTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55QXBwbHknKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5ueUNhbmNlbCcpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIGVycm9yOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FubnlFcnJvcicpIGFzIEhUTUxEaXZFbGVtZW50XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VnbWVudDoge1xuICAgICAgICAgICAgICAgIG9wZW46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWdtZW50T3BlbicpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIHBvcHVwOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudFBvcHVwJykgYXMgSFRNTERpdkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgbnVtYmVyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudE51bWJlcicpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgcmdiOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudFJHQicpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgaW50ZW5zaXR5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudEludGVuc2l0eScpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgYXBwbHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWdtZW50QXBwbHknKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWdtZW50Q2FuY2VsJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWdtZW50RXJyb3InKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXByZXNzOiB7XG4gICAgICAgICAgICAgICAgb3BlbjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXByZXNzT3BlbicpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIHBvcHVwOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tcHJlc3NQb3B1cCcpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICAgICAgICAgIGRlcHRoOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tcHJlc3NEZXB0aCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgYXBwbHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21wcmVzc0FwcGx5JykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tcHJlc3NDYW5jZWwnKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBlcnJvcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXByZXNzRXJyb3InKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGltYWdlV2lkdGg6IG51bWJlcjtcbiAgICBpbWFnZUhlaWdodDogbnVtYmVyO1xuXG4gICAga2VybmVsOiB7XG4gICAgICAgIHNpemU6IG51bWJlcjtcbiAgICAgICAgbWF0cml4OiBCYXNpY0ZpbHRlcjtcbiAgICB9O1xuXG4gICAgZ2F1c3MgPSBuZXcgR2F1c3NpYW5CbHVyKCk7XG5cbiAgICBjYW5ueSA9IG5ldyBDYW5ueSgpO1xuXG4gICAgc2VnbWVudGF0aW9uID0gbmV3IEtNZWFuc1NlZ21lbnRhdGlvbigpO1xuXG4gICAgY29tcHJlc3Npb24gPSBuZXcgS01lYW5zU2VnbWVudGF0aW9uKCk7XG5cbiAgICBoaXN0b3J5OiBCaXRtYXBbXSA9IFtdO1xuICAgIGhpc3RvcnlJbmRleDogbnVtYmVyO1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVFbGVtZW50KGh0bWw6IHN0cmluZyk6IENoaWxkTm9kZSB7XG4gICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBkaXYuaW5uZXJIVE1MID0gaHRtbC50cmltKCk7XG4gICAgICAgIHJldHVybiBkaXYuZmlyc3RDaGlsZCE7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93KGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbD8uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoaWRlKGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbD8uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzaG93UG9wdXAoZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuc2hvdyhlbCk7XG4gICAgICAgIHRoaXMuc2hvdyh0aGlzLkVMUy5vdmVybGF5KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGhpZGVQb3B1cChlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5oaWRlKGVsKTtcbiAgICAgICAgdGhpcy5oaWRlKHRoaXMuRUxTLm92ZXJsYXkpO1xuICAgIH1cblxuICAgIGNvbnN0cnVjdG9yKCkge1xuXG4gICAgICAgIHRoaXMuaGlkZSh0aGlzLkVMUy5vdmVybGF5KTtcblxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLkVMUy5wb3B1cHMpLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbHMgPSAodGhpcy5FTFMucG9wdXBzIGFzIGFueSlbbmFtZV0gYXMgeyBba2V5OiBzdHJpbmddOiBIVE1MRWxlbWVudCB9O1xuICAgICAgICAgICAgdGhpcy5oaWRlKGVscy5wb3B1cCk7XG4gICAgICAgICAgICB0aGlzLmhpZGUoZWxzLmVycm9yKTtcbiAgICAgICAgICAgIGVscy5vcGVuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnNob3dQb3B1cChlbHMucG9wdXApO1xuICAgICAgICAgICAgZWxzLmNhbmNlbC5vbmNsaWNrID0gKCkgPT4gdGhpcy5oaWRlUG9wdXAoZWxzLnBvcHVwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5FTFMudW5kby5vbmNsaWNrID0gKCkgPT4gdGhpcy51bmRvKCk7XG4gICAgICAgIHRoaXMuRUxTLnJlZG8ub25jbGljayA9ICgpID0+IHRoaXMucmVkbygpO1xuXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuY3RybEtleSAmJiBldmVudC5rZXkgPT09ICd6Jykge1xuICAgICAgICAgICAgICAgIHRoaXMudW5kbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgJiYgZXZlbnQua2V5ID09PSAneScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZG8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5FTFMuZ3JheXNjYWxlLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRvKCgpID0+IHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIEJpdG1hcC5mcm9tSW1hZ2VEYXRhKHRoaXMuZ2V0SW1hZ2VEYXRhKHRoaXMuRUxTLmlucHV0KSkpKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvbkdhdXNzQ2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGUodGhpcy5FTFMucG9wdXBzLmdhdXNzLmVycm9yKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzaXplID0gcGFyc2VJbnQodGhpcy5FTFMucG9wdXBzLmdhdXNzLnNpemUudmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWdtYSA9IHBhcnNlRmxvYXQodGhpcy5FTFMucG9wdXBzLmdhdXNzLnNpZ21hLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhdXNzLnNldE9wdHMoeyBzaWdtYSwgbjogc2l6ZSB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5FTFMucG9wdXBzLmdhdXNzLmVycm9yLmlubmVyVGV4dCA9IGVycjtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3codGhpcy5FTFMucG9wdXBzLmdhdXNzLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvbkNhbm55Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGUodGhpcy5FTFMucG9wdXBzLmNhbm55LmVycm9yKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzaXplID0gcGFyc2VJbnQodGhpcy5FTFMucG9wdXBzLmNhbm55LnNpemUudmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzaWdtYSA9IHBhcnNlRmxvYXQodGhpcy5FTFMucG9wdXBzLmNhbm55LnNpZ21hLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsb3cgPSBwYXJzZUZsb2F0KHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5sb3cudmFsdWUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhpZ2ggPSBwYXJzZUZsb2F0KHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5oaWdoLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbm55LnNldE9wdHMoe1xuICAgICAgICAgICAgICAgICAgICBsb3dUaHJlc2hvbGRSYXRpbzogbG93LFxuICAgICAgICAgICAgICAgICAgICBoaWdoVGhyZXNob2xkUmF0aW86IGhpZ2gsXG4gICAgICAgICAgICAgICAgICAgIGdhdXNzaWFuQmx1ck9wdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG46IHNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWdtYVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5lcnJvci5pbm5lclRleHQgPSBlcnI7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93KHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgb25TZWdtZW50Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGUodGhpcy5FTFMucG9wdXBzLnNlZ21lbnQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG51bWJlciA9IHBhcnNlSW50KHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50Lm51bWJlci52YWx1ZSwgMTApO1xuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBudW1iZXIgIT09ICdudW1iZXInIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKG51bWJlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTZWdtZW50IG51bWJlciBzaG91bGQgYmUgYW4gaW50ZWdlci4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCByZ2IgPSB0aGlzLkVMUy5wb3B1cHMuc2VnbWVudC5yZ2IuY2hlY2tlZDtcbiAgICAgICAgICAgICAgICB0aGlzLnNlZ21lbnRhdGlvbi5zZXRPcHRzKHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3JzOiBBcnJheS5mcm9tKHsgbGVuZ3RoOiBudW1iZXIgfSwgKCkgPT4gW3JhbmRvbSgyNTUsIDEwKSwgcmFuZG9tKDI1NSwgMTApLCByYW5kb20oMjU1LCAxMCldKSxcbiAgICAgICAgICAgICAgICAgICAgYnlJbnRlbnNpdHk6ICFyZ2JcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5FTFMucG9wdXBzLnNlZ21lbnQuZXJyb3IuaW5uZXJUZXh0ID0gZXJyO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvdyh0aGlzLkVMUy5wb3B1cHMuc2VnbWVudC5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgb25Db21wcmVzc0NoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKHRoaXMuRUxTLnBvcHVwcy5jb21wcmVzcy5lcnJvcik7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVwdGggPSBwYXJzZUludCh0aGlzLkVMUy5wb3B1cHMuY29tcHJlc3MuZGVwdGgudmFsdWUsIDEwKTtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGVwdGggIT09ICdudW1iZXInIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKGRlcHRoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbG9yIGRlcHRoIHNob3VsZCBiZSBhbiBpbnRlZ2VyLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzaW9uLnNldE9wdHMoe1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnM6IE1hdGgucG93KDIsIGRlcHRoKSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5FTFMucG9wdXBzLmNvbXByZXNzLmVycm9yLmlubmVyVGV4dCA9IGVycjtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3codGhpcy5FTFMucG9wdXBzLmNvbXByZXNzLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuY29tcHJlc3MuZGVwdGgub25rZXl1cCA9IG9uQ29tcHJlc3NDaGFuZ2U7XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLnNlZ21lbnQubnVtYmVyLm9ua2V5dXAgPSBvblNlZ21lbnRDaGFuZ2U7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50LnJnYi5vbmNoYW5nZSA9IG9uU2VnbWVudENoYW5nZTtcbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLnNlZ21lbnQuaW50ZW5zaXR5Lm9uY2hhbmdlID0gb25TZWdtZW50Q2hhbmdlO1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5zaWdtYS5vbmtleXVwID0gb25DYW5ueUNoYW5nZTtcbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmNhbm55LnNpemUub25rZXl1cCA9IG9uQ2FubnlDaGFuZ2U7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5sb3cub25rZXl1cCA9IG9uQ2FubnlDaGFuZ2U7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5oaWdoLm9ua2V5dXAgPSBvbkNhbm55Q2hhbmdlO1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5zaWdtYS5vbmtleXVwID0gb25HYXVzc0NoYW5nZTtcbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmdhdXNzLnNpemUub25rZXl1cCA9IG9uR2F1c3NDaGFuZ2U7XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmtlcm5lbC50cmFuc3Bvc2Uub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMua2VybmVsLm1hdHJpeC50cmFuc3Bvc2UoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5rZXJuZWwuc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmtlcm5lbC5zaXplOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChga2VybmVsQ2VsbF8ke2l9XyR7an1gKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBlbC52YWx1ZSA9ICcnICsgdGhpcy5rZXJuZWwubWF0cml4LmdldChpLCBqKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmtlcm5lbC5zaXplLm9ua2V5dXAgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhpZGUodGhpcy5FTFMucG9wdXBzLmtlcm5lbC5lcnJvcik7XG4gICAgICAgICAgICBjb25zdCBzaXplID0gcGFyc2VJbnQodGhpcy5FTFMucG9wdXBzLmtlcm5lbC5zaXplLnZhbHVlLCAxMCk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNpemUgIT09ICdudW1iZXInIHx8IHNpemUgJSAyID09PSAwIHx8IHNpemUgPCAzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5FTFMucG9wdXBzLmtlcm5lbC5lcnJvci5pbm5lclRleHQgPSAnS2VybmVsIHNpemUgc2hvdWxkIGJlIGFuIG9kZCBudW1iZXIgZ3JlYXRlciB0aGFuIDMuJztcbiAgICAgICAgICAgICAgICB0aGlzLnNob3codGhpcy5FTFMucG9wdXBzLmtlcm5lbC5lcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBtYXRyaXggPSBuZXcgQmFzaWNGaWx0ZXIoc2l6ZSwgc2l6ZSwgMCk7XG5cbiAgICAgICAgICAgIG1hdHJpeC5zZXQoKHNpemUgLSAxKSAvIDIsIChzaXplIC0gMSkgLyAyLCAxKTtcblxuICAgICAgICAgICAgdGhpcy5rZXJuZWwgPSB7XG4gICAgICAgICAgICAgICAgbWF0cml4LFxuICAgICAgICAgICAgICAgIHNpemVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwubWF0cml4LmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLkVMUy5wb3B1cHMua2VybmVsLm1hdHJpeC5hcHBlbmRDaGlsZChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVFbGVtZW50KGBcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZC1mbGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICR7bmV3IEFycmF5KHNpemUpLmZpbGwodW5kZWZpbmVkKS5tYXAoKF8sIGopID0+XG4gICAgICAgICAgICAgICAgICAgICAgICBgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgaWQ9XCJrZXJuZWxDZWxsXyR7aX1fJHtqfVwiIHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJmb3JtLWNvbnRyb2wgdGV4dC1jZW50ZXJcIiBvbmNoYW5nZT1cIlwiIHZhbHVlPVwiJHttYXRyaXguZ2V0KGksIGopfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YFxuICAgICAgICAgICAgICAgICAgICApLmpvaW4oJycpfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgYCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2l6ZTsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGtlcm5lbENlbGxfJHtpfV8ke2p9YCkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5vbmNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KGksIGosIHBhcnNlRmxvYXQoZWwudmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmNvbXByZXNzLmFwcGx5Lm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCh0aGlzLkVMUy5wb3B1cHMuY29tcHJlc3MucG9wdXApO1xuICAgICAgICAgICAgdGhpcy5jb21wcmVzc2lvbi5ydW4oQml0bWFwLmZyb21JbWFnZURhdGEodGhpcy5nZXRJbWFnZURhdGEodGhpcy5FTFMuaW5wdXQpLCAzKSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4gdGhpcy5kbygoKSA9PiB0aGlzLnJlbmRlckltYWdlKHRoaXMuRUxTLmlucHV0LCByZXN1bHQpKSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IGFsZXJ0KGVycikpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50LmFwcGx5Lm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCh0aGlzLkVMUy5wb3B1cHMuc2VnbWVudC5wb3B1cCk7XG4gICAgICAgICAgICBvblNlZ21lbnRDaGFuZ2UoKTtcbiAgICAgICAgICAgIHRoaXMuc2VnbWVudGF0aW9uLnJ1bihCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCksIDMpKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB0aGlzLmRvKCgpID0+IHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIHJlc3VsdCkpKVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gYWxlcnQoZXJyKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmtlcm5lbC5hcHBseS5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAodGhpcy5FTFMucG9wdXBzLmtlcm5lbC5wb3B1cCk7XG4gICAgICAgICAgICB0aGlzLmtlcm5lbC5tYXRyaXgucnVuKEJpdG1hcC5mcm9tSW1hZ2VEYXRhKHRoaXMuZ2V0SW1hZ2VEYXRhKHRoaXMuRUxTLmlucHV0KSwgMykpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHRoaXMuZG8oKCkgPT4gdGhpcy5yZW5kZXJJbWFnZSh0aGlzLkVMUy5pbnB1dCwgcmVzdWx0KSkpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBhbGVydChlcnIpKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuZ2F1c3MuYXBwbHkub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5wb3B1cCk7XG5cbiAgICAgICAgICAgIHRoaXMuZ2F1c3MucnVuKEJpdG1hcC5mcm9tSW1hZ2VEYXRhKHRoaXMuZ2V0SW1hZ2VEYXRhKHRoaXMuRUxTLmlucHV0KSwgMykpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHRoaXMuZG8oKCkgPT4gdGhpcy5yZW5kZXJJbWFnZSh0aGlzLkVMUy5pbnB1dCwgcmVzdWx0KSkpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBhbGVydChlcnIpKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLkVMUy5zb2JlbC5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAodGhpcy5FTFMucG9wdXBzLmdhdXNzLnBvcHVwKTtcbiAgICAgICAgICAgIG5ldyBTb2JlbCgpLnJ1bihCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCksIDMpKVxuICAgICAgICAgICAgICAgIC50aGVuKCh7IGcgfSkgPT4gdGhpcy5kbygoKSA9PiB0aGlzLnJlbmRlckltYWdlKHRoaXMuRUxTLmlucHV0LCBnKSkpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBhbGVydChlcnIpKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuY2FubnkuYXBwbHkub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5wb3B1cCk7XG5cbiAgICAgICAgICAgIHRoaXMuY2FubnkucnVuKEJpdG1hcC5mcm9tSW1hZ2VEYXRhKHRoaXMuZ2V0SW1hZ2VEYXRhKHRoaXMuRUxTLmlucHV0KSwgMykpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHRoaXMuZG8oKCkgPT4gdGhpcy5yZW5kZXJJbWFnZSh0aGlzLkVMUy5pbnB1dCwgcmVzdWx0KSkpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBhbGVydChlcnIpKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLkVMUy5wb3B1cHMua2VybmVsLnNpemUuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2tleXVwJykpO1xuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuZ2F1c3Muc2l6ZS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgna2V5dXAnKSk7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50Lm51bWJlci5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgna2V5dXAnKSk7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jb21wcmVzcy5kZXB0aC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgna2V5dXAnKSk7XG5cbiAgICAgICAgW3RoaXMuRUxTLmlucHV0XS5mb3JFYWNoKGNhbnZhcyA9PiB7XG4gICAgICAgICAgICBjYW52YXMud2lkdGggPSBDQU5WQVNfU0laRTtcbiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBDQU5WQVNfU0laRTtcbiAgICAgICAgICAgIGNhbnZhcy5vbndoZWVsID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgY2FudmFzLmdldENvbnRleHQoJzJkJyk/LnNjYWxlKDIsIDIpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJDYW52YXMoY2FudmFzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5FTFMubG9hZEltYWdlLm9uY2xpY2sgPSAoKSA9PiB0aGlzLkVMUy5pbWFnZUlucHV0LmNsaWNrKCk7XG4gICAgICAgIHRoaXMuRUxTLmxvYWRJbWFnZTIub25jbGljayA9ICgpID0+IHRoaXMuRUxTLmltYWdlSW5wdXQuY2xpY2soKTtcblxuICAgICAgICB0aGlzLkVMUy5pbWFnZUlucHV0Lm9uY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5FTFMuZ3JheXNjYWxlLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLkVMUy5zb2JlbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5FTFMubG9hZEltYWdlMi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5FTFMucG9wdXBzKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVscyA9ICh0aGlzLkVMUy5wb3B1cHMgYXMgYW55KVtuYW1lXSBhcyB7IFtrZXk6IHN0cmluZ106IEhUTUxFbGVtZW50IH07XG4gICAgICAgICAgICAgICAgKGVscy5vcGVuIGFzIEhUTUxCdXR0b25FbGVtZW50KS5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLkVMUy5pbWFnZUlucHV0LmZpbGVzPy5bMF07XG4gICAgICAgICAgICBjb25zdCBmaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgIGZpbGVSZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlISk7XG4gICAgICAgICAgICBmaWxlUmVhZGVyLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgICAgICAgICAgICBpbWcuc3JjID0gZmlsZVJlYWRlci5yZXN1bHQhLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZVdpZHRoID0gaW1nLm5hdHVyYWxXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZUhlaWdodCA9IGltZy5uYXR1cmFsSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmltYWdlV2lkdGggPiBDQU5WQVNfU0laRSB8fCB0aGlzLmltYWdlSGVpZ2h0ID4gQ0FOVkFTX1NJWkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmltYWdlV2lkdGggPiB0aGlzLmltYWdlSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZUhlaWdodCA9IHRoaXMuaW1hZ2VIZWlnaHQgKiAoQ0FOVkFTX1NJWkUgLyB0aGlzLmltYWdlV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VXaWR0aCA9IENBTlZBU19TSVpFO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmltYWdlV2lkdGggPSB0aGlzLmltYWdlV2lkdGggKiAoQ0FOVkFTX1NJWkUgLyB0aGlzLmltYWdlSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmltYWdlSGVpZ2h0ID0gQ0FOVkFTX1NJWkU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJJbWFnZSh0aGlzLkVMUy5pbnB1dCwgaW1nKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5ID0gW0JpdG1hcC5mcm9tSW1hZ2VEYXRhKHRoaXMuZ2V0SW1hZ2VEYXRhKHRoaXMuRUxTLmlucHV0KSwgMyldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpc3RvcnlJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuRUxTLmltYWdlSW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRvKGNiOiAoKSA9PiB2b2lkKSB7XG4gICAgICAgIGlmICh0aGlzLmhpc3RvcnlJbmRleCAhPT0gdGhpcy5oaXN0b3J5Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeSA9IHRoaXMuaGlzdG9yeS5zbGljZSgwLCB0aGlzLmhpc3RvcnlJbmRleCArIDEpO1xuICAgICAgICB9XG4gICAgICAgIGNiKCk7XG4gICAgICAgIHRoaXMuaGlzdG9yeS5wdXNoKEJpdG1hcC5mcm9tSW1hZ2VEYXRhKHRoaXMuZ2V0SW1hZ2VEYXRhKHRoaXMuRUxTLmlucHV0KSwgMykpO1xuICAgICAgICB0aGlzLmhpc3RvcnlJbmRleCsrO1xuICAgICAgICB0aGlzLkVMUy5yZWRvLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5FTFMudW5kby5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIHByaXZhdGUgdW5kbygpIHtcbiAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUluZGV4ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5oaXN0b3J5SW5kZXgtLTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIHRoaXMuaGlzdG9yeVt0aGlzLmhpc3RvcnlJbmRleF0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUluZGV4IDwgMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnVuZG8uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUluZGV4IDwgdGhpcy5oaXN0b3J5Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLkVMUy5yZWRvLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgQXVkaW8oJ2h0dHBzOi8vbXlnaXQudGgtZGVnLmRlL2h6MjkyODcvaW1hZ2UuanMvLS9ibG9iL21hc3Rlci9wdWJsaWMvYWxlcnQubXAzJykucGxheSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWRvKCkge1xuICAgICAgICBpZiAodGhpcy5oaXN0b3J5SW5kZXggPCB0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgdGhpcy5oaXN0b3J5SW5kZXgrKztcbiAgICAgICAgICAgIHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIHRoaXMuaGlzdG9yeVt0aGlzLmhpc3RvcnlJbmRleF0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUluZGV4ID09PSB0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnJlZG8uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnVuZG8uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBBdWRpbygnL2FsZXJ0Lm1wMycpLnBsYXkoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY2xlYXJDYW52YXMoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCkge1xuICAgICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSE7XG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSAnI2NjYyc7XG4gICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0SW1hZ2VEYXRhKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpIS5nZXRJbWFnZURhdGEoXG4gICAgICAgICAgICAoQ0FOVkFTX1NJWkUgLSB0aGlzLmltYWdlV2lkdGgpIC8gMixcbiAgICAgICAgICAgIChDQU5WQVNfU0laRSAtIHRoaXMuaW1hZ2VIZWlnaHQpIC8gMixcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VXaWR0aCxcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VIZWlnaHRcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlckltYWdlKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIGltZzogSFRNTEltYWdlRWxlbWVudCk6IHZvaWQ7XG4gICAgcHJpdmF0ZSByZW5kZXJJbWFnZShjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LCBpbWc6IERyYXdhYmxlKTogdm9pZDtcbiAgICBwcml2YXRlIHJlbmRlckltYWdlKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIGltZzogSFRNTEltYWdlRWxlbWVudCB8IERyYXdhYmxlKSB7XG4gICAgICAgIHRoaXMuY2xlYXJDYW52YXMoY2FudmFzKTtcbiAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xuICAgICAgICBjb25zdCBkeCA9IChDQU5WQVNfU0laRSAtIHRoaXMuaW1hZ2VXaWR0aCkgLyAyO1xuICAgICAgICBjb25zdCBkeSA9IChDQU5WQVNfU0laRSAtIHRoaXMuaW1hZ2VIZWlnaHQpIC8gMjtcbiAgICAgICAgaWYgKGltZyBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCBkeCwgZHksIHRoaXMuaW1hZ2VXaWR0aCwgdGhpcy5pbWFnZUhlaWdodCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHgucHV0SW1hZ2VEYXRhKGltZy50b0ltYWdlRGF0YSgpLCBkeCwgZHkpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCBtYWluID0gKCkgPT4ge1xuICAgIGNvbnN0IGRlbW8gPSBuZXcgRGVtb0FwcCgpO1xuICAgICh3aW5kb3cgYXMgYW55KS5hcHAgPSBkZW1vO1xufTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIG1haW4pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==