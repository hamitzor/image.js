(()=>{"use strict";var t,e=function(){function t(t,e,n,r){if(void 0===n&&(n=1),this.channelNumber=n,this.width=t,this.height=e,Array.isArray(r)){if(r.length!==t*e*n)throw new Error("Given pixel array does not match the dimension and the channel count.");this.pixels=r}else this.pixels=new Array(t*e*n).fill(r||0)}return t.fromImageData=function(e,n){void 0===n&&(n=1);var r=new Array(e.width*e.height*n);if(n<2)for(var o=function(t){r[t]=[0,1,2].reduce((function(n,r){return n+e.data[4*t+r]}),0)/3},i=0;i<e.width*e.height;i++)o(i);else for(i=0;i<e.width*e.height;i++)for(var s=0;s<n&&s<3;s++)r[i*n+s]=e.data[4*i+s];return new t(e.width,e.height,n,r)},t.prototype.max=function(){return this.pixels.reduce((function(t,e){return t>e?t:e}))},t.prototype.get=function(t,e,n){return void 0===n&&(n=0),this.pixels[(t*this.width+e)*this.channelNumber+n]},t.prototype.set=function(t,e,n,r){void 0===r&&(r=0),this.pixels[(t*this.width+e)*this.channelNumber+r]=n},t.prototype.toImageData=function(){for(var t=new Uint8ClampedArray(this.width*this.height*4),e=0;e<this.width*this.height;e++)t[4*e]=this.pixels[e*this.channelNumber],t[4*e+1]=this.pixels[e*this.channelNumber+(this.channelNumber>1?1:0)],t[4*e+2]=this.pixels[e*this.channelNumber+(this.channelNumber>1?2:0)],t[4*e+3]=255;return new ImageData(t,this.width,this.height)},t.prototype.clone=function(){return new t(this.width,this.height,this.channelNumber,this.pixels.map((function(t){return t})))},t.prototype.toGrayScale=function(){if(this.channelNumber<2)return this.clone();for(var e=new Array(this.width*this.height).fill(0),n=0;n<this.width*this.height;n++){for(var r=0;r<this.channelNumber;r++)e[n]+=this.pixels[n*this.channelNumber+r];e[n]/=this.channelNumber}return new t(this.width,this.height,1,e)},t.prototype.toMultiChannel=function(e){if(this.channelNumber>1)throw new Error("Image is already multi channel");for(var n=new Array(this.width*this.height*e),r=0;r<this.width*this.height;r++)for(var o=0;o<e;o++)n[r*e+o]=this.pixels[r];return new t(this.width,this.height,e,n)},t}(),n=function(){function t(t,e,n){if("number"==typeof t){if("number"!=typeof e)throw new Error("Bad parameters for the constructor.");this.rows=t,this.cols=e,this.data=Array.isArray(n)?n:new Array(t*e).fill(n)}else r=t,Array.isArray(r)&&Array.isArray(r[0])&&(this.cols=t.length,this.rows=t[0].length,this.data=t.reduce((function(t,e){return t.concat(e)}),[]));var r}return t.prototype.get=function(t,e){return this.data[t*this.cols+e]},t.prototype.set=function(t,e,n){this.data[t*this.cols+e]=n},t.prototype.toString=function(){var t="";t+="Matrix ("+this.rows+", "+this.cols+"):";for(var e=0;e<this.rows;e++){t+="\n";for(var n=0;n<this.cols;n++)t+=this.get(e,n)+"\t"}return t},t.prototype.transpose=function(){for(var t=Array(this.rows*this.cols),e=0;e<this.rows;e++)for(var n=0;n<this.cols;n++)t[n*this.rows+e]=this.get(e,n);var r=this.rows;return this.rows=this.cols,this.cols=r,this.data=t,this},t}(),r=function(t,e){return void 0===e&&(e=0),e+Math.floor(Math.random()*Math.floor(t))},o=(t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),i=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.run=function(t){var n=this;return new Promise((function(r,o){try{for(var i=new e(t.width,t.height,t.channelNumber),s=0;s<i.height;s++)for(var a=0;a<i.width;a++)for(var p=0;p<n.rows;p++)for(var u=0;u<n.cols;u++)for(var h=0;h<t.channelNumber;h++){var c=t.get(s-((n.rows-1)/2-p),a-((n.cols-1)/2-u),h);c=c||0,i.set(s,a,i.get(s,a,h)+c*n.get(p,u),h)}r(i)}catch(t){o(t)}}))},n}(n),s=function(){function t(t){this.opts={sigma:1,n:5},t&&this.setOpts(t),this.updateFilter()}return t.prototype.setOpts=function(t){if(void 0!==t.n&&("number"!=typeof t.n||t.n<3||t.n%2==0))throw new Error("Kernel size should be an odd number greater than 3");if(void 0!==t.sigma&&t.sigma<=0)throw new Error("Sigma should be a positive real number");this.opts=Object.assign(this.opts,t),this.updateFilter()},t.prototype.updateFilter=function(){var t=this,e=Array.from({length:this.opts.n},(function(){return new Array(t.opts.n).fill(0)})),n=Array.from({length:this.opts.n},(function(e,n){return function(t,e){return void 0===e&&(e=1),1/(e*Math.sqrt(2*Math.PI))*Math.exp(-.5*Math.pow(t/e,2))}(n*(4/(t.opts.n-1))-2,t.opts.sigma)})),r=n.reduce((function(t,e){return t+e}),0);n=n.map((function(t){return t/r}));for(var o=0;o<this.opts.n;o++)for(var s=0;s<this.opts.n;s++)e[o][s]=n[o]*n[s];this.filter=new i(e)},t.prototype.run=function(t){return this.filter.run(t)},t}(),a=function(){function t(){this.dxFilter=new i([[1,0,-1],[2,0,-2],[1,0,-1]])}return t.prototype.run=function(t){return t.channelNumber>1&&(t=t.toGrayScale()),Promise.all([this.dxFilter.run(t),this.dxFilter.transpose().run(t)]).then((function(n){for(var r=n[0],o=n[1],i=new e(t.width,t.height),s=new e(t.width,t.height),a=0;a<t.height;a++)for(var p=0;p<t.width;p++)s.set(a,p,Math.atan2(o.get(a,p),r.get(a,p))),i.set(a,p,Math.sqrt(Math.pow(o.get(a,p),2)+Math.pow(r.get(a,p),2)));return{g:i,theta:s}}))},t}(),p=function(){function t(t){this.opts={lowThresholdRatio:.2,highThresholdRatio:.5,gaussianBlurOpts:{n:5,sigma:1}},t&&this.setOpts(t)}return t.prototype.setOpts=function(t){if(t.gaussianBlurOpts&&(this.opts.gaussianBlurOpts=Object.assign(this.opts.gaussianBlurOpts,t.gaussianBlurOpts),delete t.gaussianBlurOpts),this.opts=Object.assign(this.opts,t),"number"!=typeof this.opts.lowThresholdRatio||"number"!=typeof this.opts.highThresholdRatio)throw new Error("High and low threshold values should be real numbers between 0 and 1");if(this.opts.lowThresholdRatio>=this.opts.highThresholdRatio)throw new Error("Low threshold value should be smaller than high threshold value.")},t.prototype.nonMaximumSuppression=function(t,n){for(var r=new e(t.width,t.height),o=2;o<r.height-2;o++)for(var i=2;i<r.width-2;i++){var s=255,a=255,p=180*n.get(o,i)/Math.PI;p<0&&(p+=180),0<=p&&p<22.5||157.5<=p&&p<=180?(s=t.get(o,i+1),a=t.get(o,i-1)):22.5<=p&&p<67.5?(s=t.get(o+1,i+1),a=t.get(o-1,i-1)):67.5<=p&&p<112.5?(s=t.get(o+1,i),a=t.get(o-1,i)):112.5<=p&&p<157.5&&(s=t.get(o-1,i+1),a=t.get(o+1,i-1)),t.get(o,i)>=s&&t.get(o,i)>=a?r.set(o,i,t.get(o,i)):r.set(o,i,0)}return r},t.prototype.threshold=function(e,n,r){for(var o=e.clone(),i=2;i<o.height-2;i++)for(var s=2;s<o.width-2;s++){var a=o.get(i,s);a<n?o.set(i,s,0):a<r?o.set(i,s,t.WEAK):o.set(i,s,t.STRONG)}return o},t.prototype.hysteresis=function(e){for(var n=2;n<e.height-2;n++)for(var r=2;r<e.width-2;r++)e.get(n,r)===t.WEAK&&(e.get(n-1,r-1)===t.STRONG||e.get(n-1,r)===t.STRONG||e.get(n-1,r+1)===t.STRONG||e.get(n,r-1)===t.STRONG||e.get(n,r+1)===t.STRONG||e.get(n+1,r-1)===t.STRONG||e.get(n+1,r)===t.STRONG||e.get(n+1,r+1)===t.STRONG?e.set(n,r,t.STRONG):e.set(n,r,0));return e},t.prototype.run=function(t){var e=this;return new s(this.opts.gaussianBlurOpts).run(t).then((function(t){return(new a).run(t)})).then((function(n){var r=n.g,o=n.theta,i=t.max()*e.opts.highThresholdRatio,s=i*e.opts.lowThresholdRatio;return e.hysteresis(e.threshold(e.nonMaximumSuppression(r,o),s,i))}))},t}();!function(t){t.WEAK=100,t.STRONG=255}(p||(p={}));var u=function(){function t(t){this.opts={maxIterations:0,clusterNumber:2},t&&this.setOpts(t)}return t.prototype.setOpts=function(t){this.opts=Object.assign(this.opts,t)},t.prototype.run=function(t){var e=this;return new Promise((function(n,o){try{for(var i=Array.from({length:e.opts.clusterNumber},(function(){return new Array(t.dimensionNumber).fill(0)})),s=new Array(t.length).fill(0),a=0,p=0,u=0,h=[],c=function(){var e=r(t.length-1);h.filter((function(n){return n.map((function(n,r){return n-t.get(e,r)})).filter((function(t){return 0===t})).length===n.length})).length<1&&(i[h.length]=i[h.length].map((function(n,r){return t.get(e,r)})),h.push(i[h.length]))};h.length<e.opts.clusterNumber;)c();do{for(var l=!1,d=0;d<t.length;d++){for(var g=0,m=1/0,y=0;y<i.length;y++){for(var f=0,E=0;E<t.dimensionNumber;E++)f+=Math.pow(i[y][E]-t.get(d,E),2);(f=Math.sqrt(f))<m&&(m=f,g=y)}l||s[d]===g||(l=!0),s[d]=g}l?u=0:u++;var w=Array.from({length:e.opts.clusterNumber},(function(){return new Array(t.dimensionNumber).fill(0)}));for(d=0;d<t.length;d++)for(E=0;E<t.dimensionNumber;E++)w[s[d]][E]+=t.get(d,E);w=w.map((function(t,e){return t.map((function(t){return t/s.filter((function(t){return t===e})).length}))}));for(var I=!1,v=0;v<i.length;v++)for(E=0;E<t.dimensionNumber;E++)i[v][E]!==w[v][E]&&(i[v][E]=w[v][E],I=!0);I?p=0:p++,a++}while(!(p>2||u>2||0!==e.opts.maxIterations&&a>e.opts.maxIterations));n({clusters:s,centroids:i})}catch(t){o(t)}}))},t}(),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(e){return t.call(this,e.width,e.height,e.channelNumber,e.pixels)||this}return h(e,t),e.prototype.get=function(t,e){return this.pixels[t*this.channelNumber+e]},Object.defineProperty(e.prototype,"length",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dimensionNumber",{get:function(){return this.channelNumber},enumerable:!1,configurable:!0}),e}(e),l=function(){function t(t){this.opts={byIntensity:!1,colors:3},t&&this.setOpts(t),this.updateKmeans()}return t.prototype.updateKmeans=function(){this.kmeans=new u({clusterNumber:Array.isArray(this.opts.colors)?this.opts.colors.length:this.opts.colors,maxIterations:10})},t.prototype.setOpts=function(t){this.opts=Object.assign(this.opts,t),this.updateKmeans()},t.prototype.run=function(t){var e=this,n=new c(this.opts.byIntensity?t.toGrayScale():t);return this.kmeans.run(n).then((function(t){var r=t.clusters,o=t.centroids,i=e.opts.byIntensity?n.toMultiChannel(3):n;if(Array.isArray(e.opts.colors))for(s=0;s<i.width*i.height;s++)i.pixels[3*s]=e.opts.colors[r[s]][0],i.pixels[3*s+1]=e.opts.colors[r[s]][1],i.pixels[3*s+2]=e.opts.colors[r[s]][2];else for(var s=0;s<i.width*i.height;s++)i.pixels[3*s]=o[r[s]][0],i.pixels[3*s+1]=o[r[s]][e.opts.byIntensity?0:1],i.pixels[3*s+2]=o[r[s]][e.opts.byIntensity?0:2];return i}))},t}(),d=800,g=function(){function t(){var t=this;this.ELS={app:document.getElementById("app"),overlay:document.getElementById("overlay"),input:document.getElementById("input"),imageInput:document.getElementById("imageInput"),loadImage:document.getElementById("loadImage"),loadImage2:document.getElementById("loadImage2"),undo:document.getElementById("undo"),redo:document.getElementById("redo"),grayscale:document.getElementById("grayscale"),sobel:document.getElementById("sobel"),popups:{kernel:{open:document.getElementById("kernelOpen"),popup:document.getElementById("kernelPopup"),size:document.getElementById("kernelOptionsSize"),matrix:document.getElementById("kernelOptionsMatrix"),apply:document.getElementById("kernelApply"),cancel:document.getElementById("kernelCancel"),error:document.getElementById("kernelError"),transpose:document.getElementById("kernelTranspose")},gauss:{open:document.getElementById("gaussOpen"),popup:document.getElementById("gaussPopup"),size:document.getElementById("gaussSize"),sigma:document.getElementById("gaussSigma"),apply:document.getElementById("gaussApply"),cancel:document.getElementById("gaussCancel"),error:document.getElementById("gaussError")},canny:{open:document.getElementById("cannyOpen"),popup:document.getElementById("cannyPopup"),low:document.getElementById("cannyLow"),high:document.getElementById("cannyHigh"),size:document.getElementById("cannyGaussSize"),sigma:document.getElementById("cannyGaussSigma"),apply:document.getElementById("cannyApply"),cancel:document.getElementById("cannyCancel"),error:document.getElementById("cannyError")},segment:{open:document.getElementById("segmentOpen"),popup:document.getElementById("segmentPopup"),number:document.getElementById("segmentNumber"),rgb:document.getElementById("segmentRGB"),intensity:document.getElementById("segmentIntensity"),apply:document.getElementById("segmentApply"),cancel:document.getElementById("segmentCancel"),error:document.getElementById("segmentError")},compress:{open:document.getElementById("compressOpen"),popup:document.getElementById("compressPopup"),depth:document.getElementById("compressDepth"),apply:document.getElementById("compressApply"),cancel:document.getElementById("compressCancel"),error:document.getElementById("compressError")}}},this.gauss=new s,this.canny=new p,this.segmentation=new l,this.compression=new l,this.history=[],this.hide(this.ELS.overlay),Object.keys(this.ELS.popups).forEach((function(e){var n=t.ELS.popups[e];t.hide(n.popup),t.hide(n.error),n.open.onclick=function(){return t.showPopup(n.popup)},n.cancel.onclick=function(){return t.hidePopup(n.popup)}})),this.ELS.undo.onclick=function(){return t.undo()},this.ELS.redo.onclick=function(){return t.redo()},document.addEventListener("keydown",(function(e){e.ctrlKey&&"z"===e.key&&t.undo()})),document.addEventListener("keydown",(function(e){e.ctrlKey&&"y"===e.key&&t.redo()})),this.ELS.grayscale.onclick=function(){t.do((function(){return t.renderImage(t.ELS.input,e.fromImageData(t.getImageData(t.ELS.input)))}))};var n=function(){try{t.hide(t.ELS.popups.gauss.error);var e=parseInt(t.ELS.popups.gauss.size.value,10),n=parseFloat(t.ELS.popups.gauss.sigma.value);t.gauss.setOpts({sigma:n,n:e})}catch(e){t.ELS.popups.gauss.error.innerText=e,t.show(t.ELS.popups.gauss.error)}},o=function(){try{t.hide(t.ELS.popups.canny.error);var e=parseInt(t.ELS.popups.canny.size.value,10),n=parseFloat(t.ELS.popups.canny.sigma.value),r=parseFloat(t.ELS.popups.canny.low.value),o=parseFloat(t.ELS.popups.canny.high.value);t.canny.setOpts({lowThresholdRatio:r,highThresholdRatio:o,gaussianBlurOpts:{n:e,sigma:n}})}catch(e){t.ELS.popups.canny.error.innerText=e,t.show(t.ELS.popups.canny.error)}},u=function(){try{t.hide(t.ELS.popups.segment.error);var e=parseInt(t.ELS.popups.segment.number.value,10);if("number"!=typeof e||!Number.isInteger(e))throw new Error("Segment number should be an integer.");var n=t.ELS.popups.segment.rgb.checked;t.segmentation.setOpts({colors:Array.from({length:e},(function(){return[r(255,10),r(255,10),r(255,10)]})),byIntensity:!n})}catch(e){t.ELS.popups.segment.error.innerText=e,t.show(t.ELS.popups.segment.error)}};this.ELS.popups.compress.depth.onkeyup=function(){try{t.hide(t.ELS.popups.compress.error);var e=parseInt(t.ELS.popups.compress.depth.value,10);if("number"!=typeof e||!Number.isInteger(e))throw new Error("Color depth should be an integer.");t.compression.setOpts({colors:Math.pow(2,e)})}catch(e){t.ELS.popups.compress.error.innerText=e,t.show(t.ELS.popups.compress.error)}},this.ELS.popups.segment.number.onkeyup=u,this.ELS.popups.segment.rgb.onchange=u,this.ELS.popups.segment.intensity.onchange=u,this.ELS.popups.canny.sigma.onkeyup=o,this.ELS.popups.canny.size.onkeyup=o,this.ELS.popups.canny.low.onkeyup=o,this.ELS.popups.canny.high.onkeyup=o,this.ELS.popups.gauss.sigma.onkeyup=n,this.ELS.popups.gauss.size.onkeyup=n,this.ELS.popups.kernel.transpose.onclick=function(){t.kernel.matrix.transpose();for(var e=0;e<t.kernel.size;e++)for(var n=0;n<t.kernel.size;n++)document.getElementById("kernelCell_"+e+"_"+n).value=""+t.kernel.matrix.get(e,n)},this.ELS.popups.kernel.size.onkeyup=function(){t.hide(t.ELS.popups.kernel.error);var e=parseInt(t.ELS.popups.kernel.size.value,10);if("number"!=typeof e||e%2==0||e<3)return t.ELS.popups.kernel.error.innerText="Kernel size should be an odd number greater than 3.",void t.show(t.ELS.popups.kernel.error);var n=new i(e,e,0);n.set((e-1)/2,(e-1)/2,1),t.kernel={matrix:n,size:e},t.ELS.popups.kernel.matrix.innerHTML="";for(var r=function(r){t.ELS.popups.kernel.matrix.appendChild(t.createElement('\n                <div class="d-flex">\n                    '+new Array(e).fill(void 0).map((function(t,e){return'<div>\n                            <input id="kernelCell_'+r+"_"+e+'" type="text" class="form-control text-center" onchange="" value="'+n.get(r,e)+'">\n                        </div>'})).join("")+"\n                </div>\n            "))},o=0;o<e;o++)r(o);var s=function(t){for(var r=function(e){var r=document.getElementById("kernelCell_"+t+"_"+e);r&&(r.onchange=function(){n.set(t,e,parseFloat(r.value))})},o=0;o<e;o++)r(o)};for(o=0;o<e;o++)s(o)},this.ELS.popups.compress.apply.onclick=function(){t.hidePopup(t.ELS.popups.compress.popup),t.compression.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.segment.apply.onclick=function(){t.hidePopup(t.ELS.popups.segment.popup),u(),t.segmentation.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.kernel.apply.onclick=function(){t.hidePopup(t.ELS.popups.kernel.popup),t.kernel.matrix.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.gauss.apply.onclick=function(){t.hidePopup(t.ELS.popups.gauss.popup),t.gauss.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.sobel.onclick=function(){t.hidePopup(t.ELS.popups.gauss.popup),(new a).run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){var n=e.g;return t.do((function(){return t.renderImage(t.ELS.input,n)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.canny.apply.onclick=function(){t.hidePopup(t.ELS.popups.canny.popup),t.canny.run(e.fromImageData(t.getImageData(t.ELS.input),3)).then((function(e){return t.do((function(){return t.renderImage(t.ELS.input,e)}))})).catch((function(t){return alert(t)}))},this.ELS.popups.kernel.size.dispatchEvent(new Event("keyup")),this.ELS.popups.gauss.size.dispatchEvent(new Event("keyup")),this.ELS.popups.segment.number.dispatchEvent(new Event("keyup")),this.ELS.popups.compress.depth.dispatchEvent(new Event("keyup")),[this.ELS.input].forEach((function(e){e.width=d,e.height=d,e.onwheel=function(t){var n;null===(n=e.getContext("2d"))||void 0===n||n.scale(2,2)},t.clearCanvas(e)})),this.ELS.loadImage.onclick=function(){return t.ELS.imageInput.click()},this.ELS.loadImage2.onclick=function(){return t.ELS.imageInput.click()},this.ELS.imageInput.onchange=function(){var n;t.ELS.grayscale.disabled=!1,t.ELS.sobel.disabled=!1,t.ELS.loadImage2.style.display="none",Object.keys(t.ELS.popups).forEach((function(e){t.ELS.popups[e].open.disabled=!1}));var r=null===(n=t.ELS.imageInput.files)||void 0===n?void 0:n[0],o=new FileReader;o.readAsDataURL(r),o.onload=function(){var n=document.createElement("img");n.src=o.result.toString(),n.onload=function(){t.imageWidth=n.naturalWidth,t.imageHeight=n.naturalHeight,(t.imageWidth>d||t.imageHeight>d)&&(t.imageWidth>t.imageHeight?(t.imageHeight=t.imageHeight*(d/t.imageWidth),t.imageWidth=d):(t.imageWidth=t.imageWidth*(d/t.imageHeight),t.imageHeight=d)),t.renderImage(t.ELS.input,n),t.history=[e.fromImageData(t.getImageData(t.ELS.input),3)],t.historyIndex=0,t.ELS.imageInput.value=""}}}}return t.prototype.createElement=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},t.prototype.show=function(t){null==t||t.classList.remove("hidden")},t.prototype.hide=function(t){null==t||t.classList.add("hidden")},t.prototype.showPopup=function(t){this.show(t),this.show(this.ELS.overlay)},t.prototype.hidePopup=function(t){this.hide(t),this.hide(this.ELS.overlay)},t.prototype.do=function(t){this.historyIndex!==this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),t(),this.history.push(e.fromImageData(this.getImageData(this.ELS.input),3)),this.historyIndex++,this.ELS.redo.disabled=!0,this.ELS.undo.disabled=!1},t.prototype.undo=function(){this.historyIndex>0&&(this.historyIndex--,this.renderImage(this.ELS.input,this.history[this.historyIndex]),this.historyIndex<1&&(this.ELS.undo.disabled=!0),this.historyIndex<this.history.length-1&&(this.ELS.redo.disabled=!1))},t.prototype.redo=function(){this.historyIndex<this.history.length-1?(this.historyIndex++,this.renderImage(this.ELS.input,this.history[this.historyIndex]),this.historyIndex===this.history.length-1&&(this.ELS.redo.disabled=!0),this.historyIndex>0&&(this.ELS.undo.disabled=!1)):new Audio("/alert.mp3").play()},t.prototype.clearCanvas=function(t){var e=t.getContext("2d");e.fillStyle="#ccc",e.fillRect(0,0,t.width,t.height)},t.prototype.getImageData=function(t){return t.getContext("2d").getImageData((d-this.imageWidth)/2,(d-this.imageHeight)/2,this.imageWidth,this.imageHeight)},t.prototype.renderImage=function(t,e){this.clearCanvas(t);var n=t.getContext("2d"),r=(d-this.imageWidth)/2,o=(d-this.imageHeight)/2;e instanceof HTMLImageElement?n.drawImage(e,r,o,this.imageWidth,this.imageHeight):n.putImageData(e.toImageData(),r,o)},t}();document.addEventListener("DOMContentLoaded",(function(){var t=new g;window.app=t}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9pbWFnZS50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9tYXRyaXgudHMiLCJ3ZWJwYWNrOi8vaW1hZ2UuanMvLi9zcmMvdXRpbC50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9maWx0ZXIudHMiLCJ3ZWJwYWNrOi8vaW1hZ2UuanMvLi9zcmMvZmVhdHVyZS50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL3NyYy9rLW1lYW5zLnRzIiwid2VicGFjazovL2ltYWdlLmpzLy4vc3JjL3NlZ21lbnRhdGlvbi50cyIsIndlYnBhY2s6Ly9pbWFnZS5qcy8uL2V4YW1wbGVzL2RlbW8udHMiXSwibmFtZXMiOlsid2lkdGgiLCJoZWlnaHQiLCJjaGFubmVsTnVtYmVyIiwiZmlsbCIsInRoaXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJFcnJvciIsInBpeGVscyIsImZyb21JbWFnZURhdGEiLCJpbWFnZURhdGEiLCJpIiwicmVkdWNlIiwiYWNjIiwiaiIsImRhdGEiLCJjIiwiQml0bWFwIiwibWF4IiwidmFsIiwiZ2V0IiwiY2hhbm5lbElkeCIsInNldCIsInRvSW1hZ2VEYXRhIiwiVWludDhDbGFtcGVkQXJyYXkiLCJJbWFnZURhdGEiLCJjbG9uZSIsIm1hcCIsIngiLCJ0b0dyYXlTY2FsZSIsInRvTXVsdGlDaGFubmVsIiwiYXJnMSIsImFyZzIiLCJhcmczIiwicm93cyIsImNvbHMiLCJjb25jYXQiLCJ0b1N0cmluZyIsInN0ciIsInRyYW5zcG9zZSIsInJlc3VsdCIsInJhbmRvbSIsIm1pbiIsIk1hdGgiLCJmbG9vciIsInJ1biIsInNvdXJjZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZmlsdGVyZWQiLCJtIiwibiIsIm5laWdoYm9yUGl4ZWwiLCJlcnIiLCJNYXRyaXgiLCJvcHRzIiwic2lnbWEiLCJzZXRPcHRzIiwidXBkYXRlRmlsdGVyIiwidW5kZWZpbmVkIiwiT2JqZWN0IiwiYXNzaWduIiwibWF0cml4IiwiZnJvbSIsImRpc3QiLCJfIiwic3FydCIsIlBJIiwiZXhwIiwicG93IiwiZ2F1c3NpYW4iLCJzdW0iLCJ5IiwiZmlsdGVyIiwiQmFzaWNGaWx0ZXIiLCJkeEZpbHRlciIsImFsbCIsInRoZW4iLCJneCIsImd5IiwiZyIsInRoZXRhIiwiYXRhbjIiLCJsb3dUaHJlc2hvbGRSYXRpbyIsImhpZ2hUaHJlc2hvbGRSYXRpbyIsImdhdXNzaWFuQmx1ck9wdHMiLCJub25NYXhpbXVtU3VwcHJlc3Npb24iLCJ0aGlubmVkRWRnZXMiLCJhIiwiYiIsImFuZ2xlIiwidGhyZXNob2xkIiwibG93IiwiaGlnaCIsInJlcyIsInBpeGVsIiwiQ2FubnkiLCJXRUFLIiwiU1RST05HIiwiaHlzdGVyZXNpcyIsIkdhdXNzaWFuQmx1ciIsIlNvYmVsIiwiaGlnaFRocmVzaG9sZCIsImxvd1RocmVzaG9sZCIsIm1heEl0ZXJhdGlvbnMiLCJjbHVzdGVyTnVtYmVyIiwic2FtcGxlcyIsImNlbnRyb2lkcyIsImRpbWVuc2lvbk51bWJlciIsIm51bWJlck9mSXRlcmF0aW9ucyIsImNlbnRyb2lkc0RvTm90Q2hhbmdlRm9yIiwiY2x1c3RlcnNEb05vdENoYW5nZUZvciIsInJhbmRvbUNlbnRyb2lkcyIsInJhbmRJZHgiLCJjZW50cm9pZCIsInYiLCJkIiwicHVzaCIsImNsdXN0ZXJDaGFuZ2VkIiwic2FtcGxlSWR4IiwiY2xvc2VzdENlbnRyb2lkSWR4IiwiY2xvc2VzdENlbnRyb2lkRGlzdGFuY2UiLCJJbmZpbml0eSIsImNsdXN0ZXJJZHgiLCJkaXN0YW5jZSIsIm5ld0NlbnRyb2lkcyIsImlkeCIsImNlbnRyb2lkc0NoYW5nZWQiLCJjZW50cm9pZElkeCIsImNsdXN0ZXJzIiwiaW1hZ2UiLCJkaW1lbnNpb24iLCJieUludGVuc2l0eSIsImNvbG9ycyIsInVwZGF0ZUttZWFucyIsImttZWFucyIsIktNZWFucyIsIktNZWFuc1NlZ21lbnRhdGlvbkJpdG1hcCIsIkNBTlZBU19TSVpFIiwiRUxTIiwiYXBwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm92ZXJsYXkiLCJpbnB1dCIsImltYWdlSW5wdXQiLCJsb2FkSW1hZ2UiLCJsb2FkSW1hZ2UyIiwidW5kbyIsInJlZG8iLCJncmF5c2NhbGUiLCJzb2JlbCIsInBvcHVwcyIsImtlcm5lbCIsIm9wZW4iLCJwb3B1cCIsInNpemUiLCJhcHBseSIsImNhbmNlbCIsImVycm9yIiwiZ2F1c3MiLCJjYW5ueSIsInNlZ21lbnQiLCJudW1iZXIiLCJyZ2IiLCJpbnRlbnNpdHkiLCJjb21wcmVzcyIsImRlcHRoIiwic2VnbWVudGF0aW9uIiwiS01lYW5zU2VnbWVudGF0aW9uIiwiY29tcHJlc3Npb24iLCJoaXN0b3J5IiwiaGlkZSIsImtleXMiLCJmb3JFYWNoIiwibmFtZSIsImVscyIsIm9uY2xpY2siLCJzaG93UG9wdXAiLCJoaWRlUG9wdXAiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJjdHJsS2V5Iiwia2V5IiwiZG8iLCJyZW5kZXJJbWFnZSIsImdldEltYWdlRGF0YSIsIm9uR2F1c3NDaGFuZ2UiLCJwYXJzZUludCIsInZhbHVlIiwicGFyc2VGbG9hdCIsImlubmVyVGV4dCIsInNob3ciLCJvbkNhbm55Q2hhbmdlIiwib25TZWdtZW50Q2hhbmdlIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiY2hlY2tlZCIsIm9ua2V5dXAiLCJvbmNoYW5nZSIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiY3JlYXRlRWxlbWVudCIsImpvaW4iLCJlbCIsImNhdGNoIiwiYWxlcnQiLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJjYW52YXMiLCJvbndoZWVsIiwiZSIsImdldENvbnRleHQiLCJzY2FsZSIsImNsZWFyQ2FudmFzIiwiY2xpY2siLCJkaXNhYmxlZCIsInN0eWxlIiwiZGlzcGxheSIsImZpbGUiLCJmaWxlcyIsImZpbGVSZWFkZXIiLCJGaWxlUmVhZGVyIiwicmVhZEFzRGF0YVVSTCIsIm9ubG9hZCIsImltZyIsInNyYyIsImltYWdlV2lkdGgiLCJuYXR1cmFsV2lkdGgiLCJpbWFnZUhlaWdodCIsIm5hdHVyYWxIZWlnaHQiLCJoaXN0b3J5SW5kZXgiLCJodG1sIiwiZGl2IiwidHJpbSIsImZpcnN0Q2hpbGQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJjYiIsInNsaWNlIiwiQXVkaW8iLCJwbGF5IiwiY3R4IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJkeCIsImR5IiwiSFRNTEltYWdlRWxlbWVudCIsImRyYXdJbWFnZSIsInB1dEltYWdlRGF0YSIsImRlbW8iLCJEZW1vQXBwIiwid2luZG93Il0sIm1hcHBpbmdzIjoibUJBY0EsSSxFQUFBLGFBOEJJLFdBQVlBLEVBQWVDLEVBQWdCQyxFQUFtQkMsR0FJMUQsUUFKdUMsSUFBQUQsTUFBQSxHQUN2Q0UsS0FBS0YsY0FBZ0JBLEVBQ3JCRSxLQUFLSixNQUFRQSxFQUNiSSxLQUFLSCxPQUFTQSxFQUNWSSxNQUFNQyxRQUFRSCxHQUFPLENBQ3JCLEdBQUlBLEVBQUtJLFNBQVdQLEVBQVFDLEVBQVNDLEVBQ2pDLE1BQU0sSUFBSU0sTUFBTSx5RUFFcEJKLEtBQUtLLE9BQVNOLE9BRWRDLEtBQUtLLE9BQVMsSUFBSUosTUFBTUwsRUFBUUMsRUFBU0MsR0FBZUMsS0FBS0EsR0FBYyxHQXdIdkYsT0E5R1csRUFBQU8sY0FBUCxTQUFxQkMsRUFBc0JULFFBQUEsSUFBQUEsTUFBQSxHQUN2QyxJQUFNTyxFQUFTLElBQUlKLE1BQU1NLEVBQVVYLE1BQVFXLEVBQVVWLE9BQVNDLEdBRTlELEdBQUlBLEVBQWdCLEVBRWhCLEksZUFBU1UsR0FDTEgsRUFBT0csR0FBSyxDQUFDLEVBQUcsRUFBRyxHQUFHQyxRQUFPLFNBQUNDLEVBQUtDLEdBQU0sT0FBQUQsRUFBTUgsRUFBVUssS0FBUyxFQUFKSixFQUFRRyxLQUFJLEdBQUssR0FEMUVILEVBQUksRUFBR0EsRUFBSUQsRUFBVVgsTUFBUVcsRUFBVVYsT0FBUVcsSSxFQUEvQ0EsUUFJVCxJQUFTQSxFQUFJLEVBQUdBLEVBQUlELEVBQVVYLE1BQVFXLEVB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TyxhQUFlLEVBQzFDSixhQUFldUIsaUJBQ2ZMLEVBQUlNLFVBQVV4QixFQUFLcUIsRUFBSUMsRUFBSXJQLEtBQUtpTyxXQUFZak8sS0FBS21PLGFBRWpEYyxFQUFJTyxhQUFhekIsRUFBSTNNLGNBQWVnTyxFQUFJQyxJQUdwRCxFQTNiQSxHQWtjQTFHLFNBQVN1QyxpQkFBaUIsb0JBTGIsV0FDVCxJQUFNdUUsRUFBTyxJQUFJQyxFQUNoQkMsT0FBZWpILElBQU0rRyxNIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUmVwcmVzZW50cyBhbiBvYmplY3QgdGhhdCBjYW4gYmUgZHJhd24gaW50byBhIGNhbnZhcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBEcmF3YWJsZSB7XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFuIEltYWdlRGF0YSBpbnN0YW5jZSB0aGF0IHJlcHJlc2VudHMgdGhlIGltYWdlLlxuICAgICAqIEByZXR1cm5zIENyZWF0ZWQgaW1hZ2UgZGF0YS5cbiAgICAgKi9cbiAgICB0b0ltYWdlRGF0YSgpOiBJbWFnZURhdGE7XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIGJpdG1hcCBpbWFnZSB3aXRoIGFyYml0cmFyeSBjaGFubmVscy5cbiAqL1xuZXhwb3J0IGNsYXNzIEJpdG1hcCBpbXBsZW1lbnRzIERyYXdhYmxlIHtcblxuICAgIC8qKlxuICAgICAqIEEgMS1EIGFycmF5IHRoYXQgY29udGFpbnMgY29uc2VjdXRpdmUgcGl4ZWwgZGF0YSB3aXRoIGNvbnNlY3V0aXZlIGNoYW5uZWwgdmFsdWVzLlxuICAgICAqL1xuICAgIHB1YmxpYyBwaXhlbHM6IG51bWJlcltdO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGNoYW5uZWwgY291bnQgb2YgdGhlIGltYWdlLlxuICAgICAqL1xuICAgIHB1YmxpYyBjaGFubmVsTnVtYmVyOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIGltYWdlLlxuICAgICAqL1xuICAgIHB1YmxpYyB3aWR0aDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiB0aGUgaW1hZ2UuXG4gICAgICovXG4gICAgcHVibGljIGhlaWdodDogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgYml0bWFwIGltYWdlLlxuICAgICAqIEBwYXJhbSB3aWR0aCAtIFdpZHRoIG9mIHRoZSBpbWFnZSBpbiBwaXhlbHMuXG4gICAgICogQHBhcmFtIGhlaWdodCAtIEhlaWdodCBvZiB0aGUgaW1hZ2UgaW4gcGl4ZWxzLlxuICAgICAqIEBwYXJhbSBjaGFubmVsTnVtYmVyIC0gQ2hhbm5lbCBjb3VudCBvZiB0aGUgaW1hZ2UsIGRlZmF1bHQgaXMgMSAoZ3JheXNjYWxlKS5cbiAgICAgKiBAcGFyYW0gZmlsbCAtIEEgdmFsdWUgdG8gZmlsbCB0aGUgaW1hZ2UgKGluIGFsbCBjaGFubmVscyksIG9yIGFuIGFycmF5IHRoYXQgaG9sZHNcbiAgICAgKiBjb25zZWN1dGl2ZSBwaXhlbCBkYXRhIHdpdGggY29uc2VjdXRpdmUgY2hhbm5lbCB2YWx1ZXMuIElmIG9taXR0ZWQsIDAgd2lsbCBiZSB1c2VkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBjaGFubmVsTnVtYmVyID0gMSwgZmlsbD86IG51bWJlcltdIHwgbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuY2hhbm5lbE51bWJlciA9IGNoYW5uZWxOdW1iZXI7XG4gICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpbGwpKSB7XG4gICAgICAgICAgICBpZiAoZmlsbC5sZW5ndGggIT09IHdpZHRoICogaGVpZ2h0ICogY2hhbm5lbE51bWJlcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignR2l2ZW4gcGl4ZWwgYXJyYXkgZG9lcyBub3QgbWF0Y2ggdGhlIGRpbWVuc2lvbiBhbmQgdGhlIGNoYW5uZWwgY291bnQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBpeGVscyA9IGZpbGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBpeGVscyA9IG5ldyBBcnJheSh3aWR0aCAqIGhlaWdodCAqIGNoYW5uZWxOdW1iZXIpLmZpbGwoZmlsbCA/IGZpbGwgOiAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgZmFjdG9yeSBtZXRob2QgdGhhdCBjYW4gYmUgdXNlZCB0byBkZXJpdmUgYW4gaW1hZ2Ugb2JqZWN0IGZyb20gYSBuYXRpdmUgSW1hZ2VEYXRhIGluc3RhbmNlLlxuICAgICAqIEBwYXJhbSBpbWFnZURhdGEgLSBUaGUgaW1hZ2UgZGF0YSB0byBiZSB1c2VkLlxuICAgICAqIEBwYXJhbSBjaGFubmVsTnVtYmVyIC0gQ2hhbm5lbCBjb3VudCBvZiB0aGUgaW1hZ2UsIGRlZmF1bHQgaXMgMSAoZ3JheXNjYWxlKS5cbiAgICAgKiBAcmV0dXJucyBBIGltYWdlIG9iamVjdCBwb3B1bGF0ZWQgd2l0aCB0aGUgZGF0YSBmcm9tIHRoZSBpbWFnZSBkYXRhLlxuICAgICAqL1xuICAgIHN0YXRpYyBmcm9tSW1hZ2VEYXRhKGltYWdlRGF0YTogSW1hZ2VEYXRhLCBjaGFubmVsTnVtYmVyID0gMSkge1xuICAgICAgICBjb25zdCBwaXhlbHMgPSBuZXcgQXJyYXkoaW1hZ2VEYXRhLndpZHRoICogaW1hZ2VEYXRhLmhlaWdodCAqIGNoYW5uZWxOdW1iZXIpO1xuXG4gICAgICAgIGlmIChjaGFubmVsTnVtYmVyIDwgMikge1xuICAgICAgICAgICAgLy8gSWYgdGhlIGNoYW5uZWwgbnVtYmVyIGlzIDEsIHVzZSB0aGUgYXZlcmFnZSBvZiBSR0IgdmFsdWVzIGZyb20gaW1hZ2UgZGF0YS5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW1hZ2VEYXRhLndpZHRoICogaW1hZ2VEYXRhLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcGl4ZWxzW2ldID0gWzAsIDEsIDJdLnJlZHVjZSgoYWNjLCBqKSA9PiBhY2MgKyBpbWFnZURhdGEuZGF0YVtpICogNCArIGpdLCAwKSAvIDM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS53aWR0aCAqIGltYWdlRGF0YS5oZWlnaHQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgY2hhbm5lbE51bWJlciAmJiBjIDwgMzsgYysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHBpeGVsc1tpICogY2hhbm5lbE51bWJlciArIGNdID0gaW1hZ2VEYXRhLmRhdGFbaSAqIDQgKyBjXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBCaXRtYXAoaW1hZ2VEYXRhLndpZHRoLCBpbWFnZURhdGEuaGVpZ2h0LCBjaGFubmVsTnVtYmVyLCBwaXhlbHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZ2xvYmFsIG1heGltdW0gcGl4ZWwgdmFsdWUgaW4gdGhlIGltYWdlLlxuICAgICAqIEByZXR1cm5zIFRoZSBtYXhpbXVtIHZhbHVlLlxuICAgICAqL1xuICAgIG1heCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGl4ZWxzLnJlZHVjZSgobWF4LCB2YWwpID0+IG1heCA+IHZhbCA/IG1heCA6IHZhbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjaGFubmVsIHZhbHVlIG9mIGEgcGl4ZWwgYXQgYSBnaXZlbiBwb3NpdGlvbi5cbiAgICAgKiBAcGFyYW0gaSAtIFRoZSByb3cgb2YgdGhlIHBpeGVsLlxuICAgICAqIEBwYXJhbSBqIC0gVGhlIGNvbHVtbiBvZiB0aGUgcGl4ZWwuXG4gICAgICogQHBhcmFtIGNoYW5uZWxJZHggLSBUaGUgY2hhbm5lbCBudW1iZXIuXG4gICAgICogQHJldHVybnMgVGhlIGNoYW5uZWwgdmFsdWUuXG4gICAgICovXG4gICAgZ2V0KGk6IG51bWJlciwgajogbnVtYmVyLCBjaGFubmVsSWR4ID0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5waXhlbHNbKGkgKiB0aGlzLndpZHRoICsgaikgKiB0aGlzLmNoYW5uZWxOdW1iZXIgKyBjaGFubmVsSWR4XTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGNoYW5uZWwgdmFsdWUgb2YgYSBwaXhlbCBhdCBhIGdpdmVuIHBvc2l0aW9uLlxuICAgICAqIEBwYXJhbSBpIC0gVGhlIHJvdyBvZiB0aGUgcGl4ZWwuXG4gICAgICogQHBhcmFtIGogLSBUaGUgY29sdW1uIG9mIHRoZSBwaXhlbC5cbiAgICAgKiBAcGFyYW0gY2hhbm5lbElkeCAtIFRoZSBjaGFubmVsIG51bWJlci5cbiAgICAgKiBAcGFyYW0gdmFsIC0gVGhlIG5ldyB2YWx1ZS5cbiAgICAgKi9cbiAgICBzZXQoaTogbnVtYmVyLCBqOiBudW1iZXIsIHZhbDogbnVtYmVyLCBjaGFubmVsSWR4ID0gMCkge1xuICAgICAgICB0aGlzLnBpeGVsc1soaSAqIHRoaXMud2lkdGggKyBqKSAqIHRoaXMuY2hhbm5lbE51bWJlciArIGNoYW5uZWxJZHhdID0gdmFsO1xuICAgIH1cblxuICAgICAvKipcbiAgICAgKiBDcmVhdGUgYW4gSW1hZ2VEYXRhIGluc3RhbmNlIHRoYXQgcmVwcmVzZW50cyB0aGUgaW1hZ2UuXG4gICAgICogQHJldHVybnMgQ3JlYXRlZCBpbWFnZSBkYXRhXG4gICAgICovXG4gICAgdG9JbWFnZURhdGEoKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkodGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0ICogNCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgIGRhdGFbaSAqIDRdID0gdGhpcy5waXhlbHNbaSAqIHRoaXMuY2hhbm5lbE51bWJlcl07XG4gICAgICAgICAgICAvLyBJbWFnZURhdGEgaW5zdGFuY2VzIHN0cmljdGx5IGhvbGQgNCBjaGFubmVscyAoUixHLEIsIGFsZmEpLCBzbyBpbiBjYXNlIG9mIGFuIGltYWdlIHdpdGggc2luZ2xlIGNoYW5uZWwsXG4gICAgICAgICAgICAvLyBwb3B1bGF0ZSBSR0IgY2hhbm5lbHMgd2l0aCB0aGF0IHNpbmdsZSBjaGFubmVsLlxuICAgICAgICAgICAgZGF0YVtpICogNCArIDFdID0gdGhpcy5waXhlbHNbaSAqIHRoaXMuY2hhbm5lbE51bWJlciArICh0aGlzLmNoYW5uZWxOdW1iZXIgPiAxID8gMSA6IDApXTtcbiAgICAgICAgICAgIGRhdGFbaSAqIDQgKyAyXSA9IHRoaXMucGl4ZWxzW2kgKiB0aGlzLmNoYW5uZWxOdW1iZXIgKyAodGhpcy5jaGFubmVsTnVtYmVyID4gMSA/IDIgOiAwKV07XG4gICAgICAgICAgICAvLyBBbHdheXMgaWdub3JlIHRyYW5zcGFyZW5jeSBpbiBpbWFnZXMsIHNvIGZpbGwgd2l0aCAyNTUsIHdoaWNoIG1ha2VzIHRoZSBpbWFnZSBmdWxseSBvcGFxdWUuXG4gICAgICAgICAgICBkYXRhW2kgKiA0ICsgM10gPSAyNTU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBJbWFnZURhdGEoZGF0YSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsb25lIHRoZSBpbWFnZS5cbiAgICAgKiBAcmV0dXJucyBDbG9uZWQgaW1hZ2UuXG4gICAgICovXG4gICAgY2xvbmUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQml0bWFwKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLmNoYW5uZWxOdW1iZXIsIHRoaXMucGl4ZWxzLm1hcCh4ID0+IHgpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gZ3JheXNjYWxlIGltYWdlLiBUaGlzIG1ldGhvZCBkb2VzIG5vdCBtdXRhdGUgdGhlIG9yaWdpbmFsIG9iamVjdC5cbiAgICAgKiBAcmV0dXJucyBDcmVhdGVkIGdyYXlzY2FsZSBpbWFnZS5cbiAgICAgKi9cbiAgICB0b0dyYXlTY2FsZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuY2hhbm5lbE51bWJlciA8IDIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNsb25lKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwaXhlbHMgPSBuZXcgQXJyYXkodGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0KS5maWxsKDApO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMud2lkdGggKiB0aGlzLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IHRoaXMuY2hhbm5lbE51bWJlcjsgYysrKSB7XG4gICAgICAgICAgICAgICAgcGl4ZWxzW2ldICs9IHRoaXMucGl4ZWxzW2kgKiB0aGlzLmNoYW5uZWxOdW1iZXIgKyBjXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBpeGVsc1tpXSAvPSB0aGlzLmNoYW5uZWxOdW1iZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBCaXRtYXAodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIDEsIHBpeGVscyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmlzZSB0aGUgbnVtYmVyIG9mIGNoYW5uZWxzIHRvIGFueSBudW1iZXIuIENhbiBvbmx5IGJlIGludm9rZWQgb24gc2luZ2xlIGNoYW5uZWwgaW1hZ2VzLlxuICAgICAqIEByZXR1cm5zIENyZWF0ZWQgbXVsdGktY2hhbm5lbCBpbWFnZS5cbiAgICAgKi9cbiAgICB0b011bHRpQ2hhbm5lbChjaGFubmVsTnVtYmVyOiBudW1iZXIpIHtcbiAgICAgICAgLy8gV2hlbiB0aGUgaW1hZ2UgaXMgYWxyZWFkeSBtdWx0aWNoYW5uZWwsIGNvbnZlcnNpb24gY2Fubm90IGJlIGRvbmUgd2l0aG91dCBhbWJpZ3VpdHksIHNvIGp1c3QgdGhyb3cgYW4gZXJyb3IuXG4gICAgICAgIGlmICh0aGlzLmNoYW5uZWxOdW1iZXIgPiAxKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ltYWdlIGlzIGFscmVhZHkgbXVsdGkgY2hhbm5lbCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBpeGVscyA9IG5ldyBBcnJheSh0aGlzLndpZHRoICogdGhpcy5oZWlnaHQgKiBjaGFubmVsTnVtYmVyKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQ7IGkrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgYyA9IDA7IGMgPCBjaGFubmVsTnVtYmVyOyBjKyspIHtcbiAgICAgICAgICAgICAgICBwaXhlbHNbaSAqIGNoYW5uZWxOdW1iZXIgKyBjXSA9IHRoaXMucGl4ZWxzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgQml0bWFwKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCBjaGFubmVsTnVtYmVyLCBwaXhlbHMpO1xuICAgIH1cbn1cbiIsImZ1bmN0aW9uIGlzQXJyYXlPZkFycmF5czxUPih2YWw6IEFycmF5PFQ+IHwgQXJyYXk8QXJyYXk8VD4+KTogdmFsIGlzIEFycmF5PEFycmF5PFQ+PiB7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsKSAmJiBBcnJheS5pc0FycmF5KHZhbFswXSk7XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIG1hdHJpeCB3aG9zZSB2YWx1ZXMgYXJlIG9mIHR5cGUgVC5cbiAqL1xuZXhwb3J0IGNsYXNzIE1hdHJpeDxUPiB7XG5cbiAgICAvKipcbiAgICAgKiBBIDEtRCBhcnJheSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBpbiB0aGUgbWF0cml4IGNvbnNlY3V0aXZlbHkuXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGRhdGE6IEFycmF5PFQ+O1xuXG4gICAgLyoqXG4gICAgICogVGhlIGhlaWdodCBvZiB0aGUgbWF0cml4LlxuICAgICAqL1xuICAgIHB1YmxpYyByb3dzOiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIG1hdHJpeC5cbiAgICAgKi9cbiAgICBwdWJsaWMgY29sczogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbWF0cml4IHdpdGggZGltZW5zaW9uIGluZm9ybWF0aW9uLlxuICAgICAqIEBwYXJhbSByb3dzIC0gSGVpZ2h0IG9mIHRoZSBtYXRyaXhcbiAgICAgKiBAcGFyYW0gY29scyAtIFdpZHRoIG9mIHRoZSBtYXRyaXhcbiAgICAgKiBAcGFyYW0gZmlsbCAtIEEgc2luZ2xlIHZhbHVlIHRvIGZpbGwgdGhlIG1hdHJpeCwgb3IgYW4gYXJyYXkgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgY29uc2VjdXRpdmVseS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihyb3dzOiBudW1iZXIsIGNvbHM6IG51bWJlciwgZmlsbD86IFQgfCBBcnJheTxUPik7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBmcm9tIG5hdGl2ZSAyLUQgYXJyYXkuXG4gICAgICogQHBhcmFtIGRhdGEgLSBBIDItRCBhcnJheSByZXByZXNlbnRzIHRoZSBtYXRyaXguXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZGF0YTogQXJyYXk8QXJyYXk8VD4+KTtcblxuICAgIGNvbnN0cnVjdG9yKGFyZzE6IG51bWJlciB8IEFycmF5PEFycmF5PFQ+PiB8IEFycmF5PFQ+LCBhcmcyPzogbnVtYmVyLCBhcmczPzogVCB8IEFycmF5PFQ+KSB7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnMSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnMiA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvd3MgPSBhcmcxO1xuICAgICAgICAgICAgICAgIHRoaXMuY29scyA9IGFyZzI7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gQXJyYXkuaXNBcnJheShhcmczKSA/IGFyZzMgOiBuZXcgQXJyYXkoYXJnMSAqIGFyZzIpLmZpbGwoYXJnMyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQmFkIHBhcmFtZXRlcnMgZm9yIHRoZSBjb25zdHJ1Y3Rvci4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpc0FycmF5T2ZBcnJheXMoYXJnMSkpIHtcbiAgICAgICAgICAgIHRoaXMuY29scyA9IGFyZzEubGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5yb3dzID0gYXJnMVswXS5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSBhcmcxLnJlZHVjZSgoYWNjLCB2YWwpID0+IGFjYy5jb25jYXQodmFsKSwgW10pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSB2YWx1ZSBhdCAoaSxqKVxuICAgICAqIEBwYXJhbSBpIC0gUm93IG51bWJlci5cbiAgICAgKiBAcGFyYW0gaiAtIENvbHVtbiBudW1iZXIuXG4gICAgICogQHJldHVybnMgVmFsdWUgYXQgKGksIGopXG4gICAgICovXG4gICAgZ2V0KGk6IG51bWJlciwgajogbnVtYmVyKTogVCB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFbaSAqIHRoaXMuY29scyArIGpdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgdmFsdWUgYXQgKGksailcbiAgICAgKiBAcGFyYW0gaSAtIFJvdyBudW1iZXIuXG4gICAgICogQHBhcmFtIGogLSBDb2x1bW4gbnVtYmVyLlxuICAgICAqIEBwYXJhbSB2YWwgLSBOZXcgdmFsdWVcbiAgICAgKi9cbiAgICBzZXQoaTogbnVtYmVyLCBqOiBudW1iZXIsIHZhbDogVCkge1xuICAgICAgICB0aGlzLmRhdGFbaSAqIHRoaXMuY29scyArIGpdID0gdmFsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgbWF0cml4IHRoYXQgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZy5cbiAgICAgKiBAcmV0dXJucyBTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC5cbiAgICAgKi9cbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICBsZXQgc3RyID0gJyc7XG4gICAgICAgIHN0ciArPSBgTWF0cml4ICgke3RoaXMucm93c30sICR7dGhpcy5jb2xzfSk6YDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnJvd3M7IGkrKykge1xuICAgICAgICAgICAgc3RyICs9ICdcXG4nO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmNvbHM7IGorKykge1xuICAgICAgICAgICAgICAgIHN0ciArPSBgJHt0aGlzLmdldChpLCBqKX1cXHRgO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJhbnNwb3NlIHRoZSBtYXRyaXguIFRoaXMgbWV0aG9kIG11dGF0ZXMgdGhlIG9yaWdpbmFsIG1hdHJpeC5cbiAgICAgKiBAcmV0dXJucyB0aGlzXG4gICAgICovXG4gICAgdHJhbnNwb3NlKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBBcnJheSh0aGlzLnJvd3MgKiB0aGlzLmNvbHMpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucm93czsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuY29sczsgaisrKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W2ogKiB0aGlzLnJvd3MgKyBpXSA9IHRoaXMuZ2V0KGksIGopO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJvd3MgPSB0aGlzLnJvd3M7XG4gICAgICAgIHRoaXMucm93cyA9IHRoaXMuY29scztcbiAgICAgICAgdGhpcy5jb2xzID0gcm93cztcbiAgICAgICAgdGhpcy5kYXRhID0gcmVzdWx0O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG59XG4iLCIvKipcbiAqIEdlbmVyYXRlIGEgcmFuZG9tIHJlYWwgbnVtYmVyIGJldHdlZW4gYG1pbmAgYW5kIGBtYXhgLlxuICogQHBhcmFtIG1heCAtIG1heGltdW0gdmFsdWUuXG4gKiBAcGFyYW0gbWluIC0gbWluaW11bSB2YWx1ZS5cbiAqIEByZXR1cm5zIGdlbmVyYXRlZCByYW5kb20gbnVtYmVyLlxuICovXG5leHBvcnQgY29uc3QgcmFuZG9tID0gKG1heDogbnVtYmVyLCBtaW4gPSAwKSA9PiBtaW4gKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBNYXRoLmZsb29yKG1heCkpO1xuXG4vKipcbiAqIFNhbXBsZSBmcm9tIGdhdXNzaWFuIGRpc3RyaWJ1dGlvbiB3aXRoIDAgbWVhbi5cbiAqIEBwYXJhbSB4IC0geCB2YWx1ZS5cbiAqIEBwYXJhbSBzaWdtYSAtIHN0YW5kYXJkIGRldmlhdGlvbiBvZiB0aGUgZ2F1c3NpYW4gZGlzdHJpYnV0aW9uLlxuICogQHJldHVybnMgbGlrZWxpaG9vZCBvZiB4LlxuICovXG5leHBvcnQgY29uc3QgZ2F1c3NpYW4gPSAoeDogbnVtYmVyLCBzaWdtYSA9IDEpID0+ICgxIC8gKHNpZ21hICogTWF0aC5zcXJ0KDIgKiBNYXRoLlBJKSkpICogTWF0aC5leHAoLTAuNSAqIE1hdGgucG93KHggLyBzaWdtYSwgMikpO1xuIiwiaW1wb3J0IHsgQml0bWFwIH0gZnJvbSAnLi9pbWFnZSc7XG5pbXBvcnQgeyBNYXRyaXggfSBmcm9tICcuL21hdHJpeCc7XG5pbXBvcnQgeyBnYXVzc2lhbiB9IGZyb20gJy4vdXRpbCc7XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIGNvbnZvbHV0aW9uLlxuICogQGV4dGVuZHMgTWF0cml4XG4gKi9cbmV4cG9ydCBjbGFzcyBCYXNpY0ZpbHRlciBleHRlbmRzIE1hdHJpeDxudW1iZXI+IHtcblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IGRvaW5nIHRoZSBjb252b2x1dGlvbi4gVGhpcyBtZXRob2QgZG9lc24ndCBtdXRhdGUgdGhlIHNvdXJjZSBpbWFnZS5cbiAgICAgKiBAcGFyYW0gc291cmNlIC0gU291cmNlIGltYWdlXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0aW5nIGltYWdlLiAod2l0aCBvcmlnaW5hbCBjaGFubmVsIGNvdW50KVxuICAgICAqL1xuICAgIHJ1bihzb3VyY2U6IEJpdG1hcCk6IFByb21pc2U8Qml0bWFwPiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIGJyYW5kIG5ldyBpbWFnZSBvYmplY3QgdGhhdCBrZWVwcyB0aGUgZmlsdGVyZWQgaW1hZ2UuXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBuZXcgQml0bWFwKHNvdXJjZS53aWR0aCwgc291cmNlLmhlaWdodCwgc291cmNlLmNoYW5uZWxOdW1iZXIpO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWx0ZXJlZC5oZWlnaHQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGZpbHRlcmVkLndpZHRoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG0gPSAwOyBtIDwgdGhpcy5yb3dzOyBtKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHRoaXMuY29sczsgbisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIGNvbnZvbHV0aW9uIGZvciBlYWNoIGNoYW5uZWwuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGMgPSAwOyBjIDwgc291cmNlLmNoYW5uZWxOdW1iZXI7IGMrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5laWdoYm9yUGl4ZWwgPSBzb3VyY2UuZ2V0KGkgLSAoKHRoaXMucm93cyAtIDEpIC8gMiAtIG0pLCBqIC0gKCh0aGlzLmNvbHMgLSAxKSAvIDIgLSBuKSwgYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcGl4ZWwgZG9lc24ndCBleGlzdCAoaW4gY2FzZSB3aGVuIGl0IGZhbGxzIG91dHNpZGUgb2YgdGhlIGltYWdlKSBqdXN0IGFzc3VtZSBpdCBpcyAwLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3JQaXhlbCA9IG5laWdoYm9yUGl4ZWwgPyBuZWlnaGJvclBpeGVsIDogMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnNldChpLCBqLCBmaWx0ZXJlZC5nZXQoaSwgaiwgYykgKyBuZWlnaGJvclBpeGVsICogdGhpcy5nZXQobSwgbiksIGMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc29sdmUoZmlsdGVyZWQpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIGEgZ2F1c3NpYW4gYmx1ciBmaWx0ZXIuXG4gKi9cbmV4cG9ydCBjbGFzcyBHYXVzc2lhbkJsdXIge1xuICAgIC8qKlxuICAgICAqIFRoZSBvcHRpb25zLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgb3B0czogUmVxdWlyZWQ8R2F1c3NpYW5CbHVyLk9wdHM+ID0geyBzaWdtYTogMSwgbjogNSB9O1xuXG4gICAgLyoqXG4gICAgICogVGhlIGFjdHVhbCBmaWx0ZXIgaW5zdGFuY2UgdGhhdCBwZXJmb3JtcyBjb252b2x1dGlvbi5cbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIGZpbHRlcjogQmFzaWNGaWx0ZXI7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBnYXVzc2lhbiBibHVyIGZpbHRlci5cbiAgICAgKiBAcGFyYW0gb3B0cyAtIE9wdGlvbnMgZm9yIHRoZSBnYXVzc2lhbiBibHVycmluZy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvcHRzPzogR2F1c3NpYW5CbHVyLk9wdHMpIHtcbiAgICAgICAgaWYgKG9wdHMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0T3B0cyhvcHRzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZUZpbHRlcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0gb3B0cyAtIE9wdGlvbnMgZm9yIHRoZSBnYXVzc2lhbiBibHVycmluZy5cbiAgICAgKi9cbiAgICBzZXRPcHRzKG9wdHM6IEdhdXNzaWFuQmx1ci5PcHRzKSB7XG4gICAgICAgIGlmIChvcHRzLm4gIT09IHVuZGVmaW5lZCAmJiAodHlwZW9mIG9wdHMubiAhPT0gJ251bWJlcicgfHwgb3B0cy5uIDwgMyB8fCBvcHRzLm4gJSAyID09PSAwKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdLZXJuZWwgc2l6ZSBzaG91bGQgYmUgYW4gb2RkIG51bWJlciBncmVhdGVyIHRoYW4gMycpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdHMuc2lnbWEgIT09IHVuZGVmaW5lZCAmJiBvcHRzLnNpZ21hIDw9IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2lnbWEgc2hvdWxkIGJlIGEgcG9zaXRpdmUgcmVhbCBudW1iZXInKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBKdXN0IG92ZXJyaWRlIHRoZSBvcHRpb25zIHRoYXQgZXhpc3QgaW4gZ2l2ZW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICAgIHRoaXMub3B0cyA9IE9iamVjdC5hc3NpZ24odGhpcy5vcHRzLCBvcHRzKTtcblxuICAgICAgICAvLyBNYWtlIHN1cmUgZmlsdGVyIGlzIHVwZGF0ZWQgYXMgaXQgZGVwZW5kcyBvbiB0aGUgb3B0aW9ucy5cbiAgICAgICAgdGhpcy51cGRhdGVGaWx0ZXIoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIGZpbHRlci4gVGhpcyBjb25zdHJ1Y3RzIGEga2VybmVsIGZvciBnaXZlbiBrZXJuZWwgc2l6ZSAobikgYW5kIHN0YW5kYXJkIGRldmlhdGlvbiAoc2lnbWEpLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgdXBkYXRlRmlsdGVyKCkge1xuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBrZXJuZWwgd2l0aCB6ZXJvcy5cbiAgICAgICAgY29uc3QgbWF0cml4OiBudW1iZXJbXVtdID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogdGhpcy5vcHRzLm4gfSwgKCkgPT4gbmV3IEFycmF5KHRoaXMub3B0cy5uKS5maWxsKDApKTtcblxuICAgICAgICAvLyBDcmVhdGUgYW4gYXJyYXkgdGhhdCBob2xkcyBuIGV2ZW5seSBzcGFjZWQgc2FtcGxlcyBmcm9tIDEtRCBnYXVzc2lhbiBkaXN0cmlidXRpb24gYmV0d2VlbiAtMipzaWdtYSBhbmQgMipzaWdtYS5cbiAgICAgICAgbGV0IGRpc3QgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiB0aGlzLm9wdHMubiB9LCAoXywgeCkgPT4gZ2F1c3NpYW4oLTIgKyB4ICogKDQgLyAodGhpcy5vcHRzLm4gLSAxKSksIHRoaXMub3B0cy5zaWdtYSkpO1xuXG4gICAgICAgIC8vIERpdmlkZSBlYWNoIGVsZW1lbnQgYnkgdGhlIG92ZXJhbGwgc3VtLCB0byBtYWtlIHN1cmUgdGhlIGFycmF5IGFkZHMgdXAgdG8gMS5cbiAgICAgICAgY29uc3Qgc3VtID0gZGlzdC5yZWR1Y2UoKGFjYywgdmFsKSA9PiBhY2MgKyB2YWwsIDApO1xuICAgICAgICBkaXN0ID0gZGlzdC5tYXAoeCA9PiB4IC8gc3VtKTtcblxuICAgICAgICAvLyBDb25zdHJ1Y3QgdGhlIHJlc3VsdGluZyBrZXJuZWwuIFNpbmNlIHRoZXJlIGlzIG5vIGNvcnJlbGF0aW9uIGJldHdlZW4gYXhlcywganVzdCBtdWx0aXBseSB0d28gMS1EIGdhdXNzaWFuIGRpc3RyaWJ1dGlvbnNcbiAgICAgICAgLy8gdG8gZmluZCB0aGUgdmFsdWUgb2YgMi1EIGdhdXNzaWFuIGRpc3RyaWJ1dGlvbiBhdCBhbnkgcG9zaXRpb24uXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgdGhpcy5vcHRzLm47IHgrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLm9wdHMubjsgeSsrKSB7XG4gICAgICAgICAgICAgICAgbWF0cml4W3hdW3ldID0gZGlzdFt4XSAqIGRpc3RbeV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maWx0ZXIgPSBuZXcgQmFzaWNGaWx0ZXIobWF0cml4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEbyBhIGNvbnZvbHV0aW9uIGFuZCByZXR1cm4gdGhlIHJlc3VsdC4gVGhpcyBtZXRob2QgZG9lcyBub3QgbXV0YXRlIHRoZSBvcmlnaW5hbCBpbWFnZS5cbiAgICAgKiBAcGFyYW0gc291cmNlIC0gU291cmNlIGltYWdlLlxuICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggcmVzdWx0aW5nIGltYWdlICh3aXRoIG9yaWdpbmFsIGNoYW5uZWwgY291bnQpLlxuICAgICAqL1xuICAgIHJ1bihzb3VyY2U6IEJpdG1hcCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXIucnVuKHNvdXJjZSk7XG4gICAgfVxufVxuXG5leHBvcnQgbmFtZXNwYWNlIEdhdXNzaWFuQmx1ciB7XG4gICAgLyoqXG4gICAgICogUmVwcmVzZW50cyBvcHRpb25zIGZvciB0aGUgZ2F1c3NpYW4gYmx1cnJpbmcuXG4gICAgICovXG4gICAgZXhwb3J0IGludGVyZmFjZSBPcHRzIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN0YW5kYXJkIGRldmlhdGlvbiBvZiB0aGUgZ2F1c3NpYW4gZGlzdHJpYnV0aW9uXG4gICAgICAgICAqL1xuICAgICAgICBzaWdtYT86IG51bWJlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNpemUgb2YgdGhlIGtlcm5lbFxuICAgICAgICAgKi9cbiAgICAgICAgbj86IG51bWJlcjtcbiAgICB9XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIHNvYmVsIGZpbHRlci5cbiAqL1xuZXhwb3J0IGNsYXNzIFNvYmVsIHtcbiAgICAvKipcbiAgICAgKiBUaGUga2VybmVsIHRoYXQgZXN0aW1hdGVzIGhvcml6b250YWwgZ3JhZGllbnQuIFRyYW5zcG9zZSBvZiB0aGlzIHVzZWQgdG8gZXN0aW1hdGUgdGhlIHZlcnRpY2FsIGdyYWRpZW50LlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgZHhGaWx0ZXI6IEJhc2ljRmlsdGVyO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgc29iZWwgZmlsdGVyLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmR4RmlsdGVyID0gbmV3IEJhc2ljRmlsdGVyKFtcbiAgICAgICAgICAgIFsxLCAwLCAtMV0sXG4gICAgICAgICAgICBbMiwgMCwgLTJdLFxuICAgICAgICAgICAgWzEsIDAsIC0xXVxuICAgICAgICBdKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSdW4gdGhlIGZpbHRlci4gVGhpcyBtZXRob2QgZG9lcyBub3QgbXV0YXRlIHRoZSBzb3VyY2UgaW1hZ2UuXG4gICAgICogQHBhcmFtIHNvdXJjZSAtIFRoZSBzb3VyY2UgaW1hZ2UuXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgcmVzdWx0aW5nIGltYWdlICh3aXRoIHNpbmdsZSBjaGFubmVsKS5cbiAgICAgKi9cbiAgICBydW4oc291cmNlOiBCaXRtYXApIHtcbiAgICAgICAgLy8gTWFrZSB0aGUgaW1hZ2UgZ3JheXNjYWxlLCBpZiBub3QuXG4gICAgICAgIGlmIChzb3VyY2UuY2hhbm5lbE51bWJlciA+IDEpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IHNvdXJjZS50b0dyYXlTY2FsZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgIHRoaXMuZHhGaWx0ZXIucnVuKHNvdXJjZSksIC8vIEhvcml6b250YWwgZ3JhZGllbnRzLlxuICAgICAgICAgICAgdGhpcy5keEZpbHRlci50cmFuc3Bvc2UoKS5ydW4oc291cmNlKSAvLyBWZXJ0aWNhbCBncmFkaWVudHMuXG4gICAgICAgIF0pLnRoZW4oKFtneCwgZ3ldKSA9PiB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGltYWdlIG9iamVjdCB0aGF0IGhvbGRzIHRoZSBtYWduaXR1ZGUgb2YgdGhlIGdyYWRpZW50cy5cbiAgICAgICAgICAgIGNvbnN0IGcgPSBuZXcgQml0bWFwKHNvdXJjZS53aWR0aCwgc291cmNlLmhlaWdodCk7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGltYWdlIG9iamVjdCB0aGF0IGhvbGRzIHRoZSBkaXJlY3Rpb24gb2YgdGhlIGdyYWRpZW50cy5cbiAgICAgICAgICAgIGNvbnN0IHRoZXRhID0gbmV3IEJpdG1hcChzb3VyY2Uud2lkdGgsIHNvdXJjZS5oZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyBGaWxsIGltYWdlIG9iamVjdHMgd2l0aCBhcHByb3ByaWF0ZSB2YWx1ZXMuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZS5oZWlnaHQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc291cmNlLndpZHRoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhldGEuc2V0KGksIGosIE1hdGguYXRhbjIoZ3kuZ2V0KGksIGopLCBneC5nZXQoaSwgaikpKTtcbiAgICAgICAgICAgICAgICAgICAgZy5zZXQoaSwgaiwgTWF0aC5zcXJ0KE1hdGgucG93KGd5LmdldChpLCBqKSwgMikgKyBNYXRoLnBvdyhneC5nZXQoaSwgaiksIDIpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHsgZywgdGhldGEgfTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgR2F1c3NpYW5CbHVyLCBTb2JlbCB9IGZyb20gJy4vZmlsdGVyJztcbmltcG9ydCB7IEJpdG1hcCB9IGZyb20gJy4vaW1hZ2UnO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBjYW5ueSBlZGdlIGRldGVjdGlvbi5cbiAqL1xuZXhwb3J0IGNsYXNzIENhbm55IHtcblxuICAgIC8qKlxuICAgICAqIFRoZSBvcHRpb25zLlxuICAgICAqL1xuICAgIHByaXZhdGUgb3B0czogUmVxdWlyZWQ8Q2FubnkuT3B0cz4gPSB7XG4gICAgICAgIGxvd1RocmVzaG9sZFJhdGlvOiAwLjIsXG4gICAgICAgIGhpZ2hUaHJlc2hvbGRSYXRpbzogMC41LFxuICAgICAgICBnYXVzc2lhbkJsdXJPcHRzOiB7XG4gICAgICAgICAgICBuOiA1LFxuICAgICAgICAgICAgc2lnbWE6IDFcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBjYW5ueSBlZGdlIGRldGVjdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIG9wdHMgLSBUaGUgb3B0aW9ucy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvcHRzPzogQ2FubnkuT3B0cykge1xuICAgICAgICBpZiAob3B0cykge1xuICAgICAgICAgICAgdGhpcy5zZXRPcHRzKG9wdHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBvcHRpb25zLlxuICAgICAqIEBwYXJhbSBvcHRzIC0gVGhlIG5ldyBvcHRpb25zLlxuICAgICAqL1xuICAgIHNldE9wdHMob3B0czogQ2FubnkuT3B0cykge1xuICAgICAgICBpZiAob3B0cy5nYXVzc2lhbkJsdXJPcHRzKSB7XG4gICAgICAgICAgICB0aGlzLm9wdHMuZ2F1c3NpYW5CbHVyT3B0cyA9IE9iamVjdC5hc3NpZ24odGhpcy5vcHRzLmdhdXNzaWFuQmx1ck9wdHMsIG9wdHMuZ2F1c3NpYW5CbHVyT3B0cyk7XG4gICAgICAgICAgICBkZWxldGUgb3B0cy5nYXVzc2lhbkJsdXJPcHRzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub3B0cyA9IE9iamVjdC5hc3NpZ24odGhpcy5vcHRzLCBvcHRzKTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdHMubG93VGhyZXNob2xkUmF0aW8gIT09ICdudW1iZXInIHx8IHR5cGVvZiB0aGlzLm9wdHMuaGlnaFRocmVzaG9sZFJhdGlvICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIaWdoIGFuZCBsb3cgdGhyZXNob2xkIHZhbHVlcyBzaG91bGQgYmUgcmVhbCBudW1iZXJzIGJldHdlZW4gMCBhbmQgMScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdHMubG93VGhyZXNob2xkUmF0aW8gPj0gdGhpcy5vcHRzLmhpZ2hUaHJlc2hvbGRSYXRpbykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb3cgdGhyZXNob2xkIHZhbHVlIHNob3VsZCBiZSBzbWFsbGVyIHRoYW4gaGlnaCB0aHJlc2hvbGQgdmFsdWUuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtIG5vbi1tYXhpbXVtIHN1cHByZXNzaW9uLiBUaGlzIGlzIHRoZSBmaXJzdCBzdGVwIG9mIGNhbm55IGVkZ2UgZGV0ZWN0aW9uIGFuZFxuICAgICAqIGlzIHVzZWQgdG8gbWFrZSB0aGUgZWRnZXMgZGV0ZWN0ZWQgYnkgU29iZWwgdGhpbm5lci5cbiAgICAgKiBAcGFyYW0gZyAtIFRoZSBiaXRtYXAgaW1hZ2UgdGhhdCBob2xkcyB0aGUgZ3JhZGllbnQgbWFnbml0dWRlcy5cbiAgICAgKiBAcGFyYW0gdGhldGEgLSBUaGUgYml0bWFwIGltYWdlIHRoYXQgY29udGFpbnMgdGhlIGdyYWRpZW50IGRpcmVjdGlvbnMuXG4gICAgICogQHJldHVybnMgQSBiaXRtYXAgaW1hZ2UgdGhhdCBjb250YWlucyB0aGlubmVkIGVkZ2VzXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBub25NYXhpbXVtU3VwcHJlc3Npb24oZzogQml0bWFwLCB0aGV0YTogQml0bWFwKSB7XG4gICAgICAgIGNvbnN0IHRoaW5uZWRFZGdlcyA9IG5ldyBCaXRtYXAoZy53aWR0aCwgZy5oZWlnaHQpO1xuICAgICAgICBmb3IgKGxldCBpID0gMjsgaSA8IHRoaW5uZWRFZGdlcy5oZWlnaHQgLSAyOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAyOyBqIDwgdGhpbm5lZEVkZ2VzLndpZHRoIC0gMjsgaisrKSB7XG4gICAgICAgICAgICAgICAgLy8gYSBhbmQgYiByZXByZXNlbnRzIHRoZSBuZWlnaGJvciBwaXhlbHMgb2YgdGhlIGN1cnJlbnQgcGl4ZWwgYWxvbmcgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZ3JhZGllbnQuXG4gICAgICAgICAgICAgICAgbGV0IGEgPSAyNTUsIGIgPSAyNTU7XG4gICAgICAgICAgICAgICAgbGV0IGFuZ2xlID0gdGhldGEuZ2V0KGksIGopICogMTgwIC8gTWF0aC5QSTtcbiAgICAgICAgICAgICAgICBpZiAoYW5nbGUgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuZ2xlICs9IDE4MDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBEZXRlcm1pbmUgYSBhbmQgYidzIHZhbHVlcyBhY2NvcmRpbmcgdG8gdGhlIGdyYWRpZW50IGRpcmVjdGlvbi5cbiAgICAgICAgICAgICAgICBpZiAoKDAgPD0gYW5nbGUgJiYgYW5nbGUgPCAyMi41KSB8fCAoMTU3LjUgPD0gYW5nbGUgJiYgYW5nbGUgPD0gMTgwKSkge1xuICAgICAgICAgICAgICAgICAgICBhID0gZy5nZXQoaSwgaiArIDEpO1xuICAgICAgICAgICAgICAgICAgICBiID0gZy5nZXQoaSwgaiAtIDEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoMjIuNSA8PSBhbmdsZSAmJiBhbmdsZSA8IDY3LjUpIHtcbiAgICAgICAgICAgICAgICAgICAgYSA9IGcuZ2V0KGkgKyAxLCBqICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBnLmdldChpIC0gMSwgaiAtIDEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoNjcuNSA8PSBhbmdsZSAmJiBhbmdsZSA8IDExMi41KSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSBnLmdldChpICsgMSwgaik7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBnLmdldChpIC0gMSwgaik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgxMTIuNSA8PSBhbmdsZSAmJiBhbmdsZSA8IDE1Ny41KSB7XG4gICAgICAgICAgICAgICAgICAgIGEgPSBnLmdldChpIC0gMSwgaiArIDEpO1xuICAgICAgICAgICAgICAgICAgICBiID0gZy5nZXQoaSArIDEsIGogLSAxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJZiBjdXJyZW50IHBpeGVsIGlzIG5vdCB0aGUgbG9jYWwgbWF4aW11bSwgc3VwcHJlc3MgaXQuXG4gICAgICAgICAgICAgICAgaWYgKGcuZ2V0KGksIGopID49IGEgJiYgZy5nZXQoaSwgaikgPj0gYikge1xuICAgICAgICAgICAgICAgICAgICB0aGlubmVkRWRnZXMuc2V0KGksIGosIGcuZ2V0KGksIGopKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlubmVkRWRnZXMuc2V0KGksIGosIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlubmVkRWRnZXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2F0ZWdvcml6ZSB0aGUgcGl4ZWxzIGludG8gdHdvIGdyb3VwczogYExvdyA8PSBXZWFrIDwgSGlnaGAgYW5kIGBIaWdoIDwgU3Ryb25nYCBhY2NvcmRpbmcgdG8gdGhlIGdpdmVuIHRocmVzaG9sZCB2YWx1ZXMuXG4gICAgICogU3VwcHJlc3MgdGhlIHBpeGVscyB0aGF0IGFyZSBsb3dlciB0aGFuIHRoZSBsb3cgdGhyZXNob2xkLlxuICAgICAqIEBwYXJhbSBnIC0gVGhlIGJpdG1hcCBpbWFnZSB0aGF0IGhvbGRzIHRoZSBncmFkaWVudCBtYWduaXR1ZGVzLlxuICAgICAqIEBwYXJhbSBsb3cgLSBUaGUgbG93IHRocmVzaG9sZCB2YWx1ZS5cbiAgICAgKiBAcGFyYW0gaGlnaCAtIFRoZSBoaWdoIHRocmVzaG9sZCB2YWx1ZS5cbiAgICAgKiBAcmV0dXJucyBBIGJpdG1hcCBpbWFnZSB0aGF0IGNvbnRhaW5zIGNhdGVnb3JpemVkIHBpeGVscy5cbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIHRocmVzaG9sZChnOiBCaXRtYXAsIGxvdzogbnVtYmVyLCBoaWdoOiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgcmVzID0gZy5jbG9uZSgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMjsgaSA8IHJlcy5oZWlnaHQgLSAyOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAyOyBqIDwgcmVzLndpZHRoIC0gMjsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGl4ZWwgPSByZXMuZ2V0KGksIGopO1xuICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IGxvdykge1xuICAgICAgICAgICAgICAgICAgICByZXMuc2V0KGksIGosIDApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGl4ZWwgPCBoaWdoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5zZXQoaSwgaiwgQ2FubnkuV0VBSyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnNldChpLCBqLCBDYW5ueS5TVFJPTkcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gaHlzdGVyZXNpcyB0byBvbmx5IGtlZXAgc3Ryb25nIGVkZ2VzLlxuICAgICAqIEBwYXJhbSBnIC0gVGhlIGJpdG1hcCBpbWFnZSB0aGF0IGhvbGRzIHRoZSBncmFkaWVudCBtYWduaXR1ZGVzLlxuICAgICAqIEByZXR1cm5zIEEgYml0bWFwIGltYWdlIHRoYXQgY29udGFpbnMgb25seSB0aGUgc3Ryb25nIGVkZ2VzLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHByaXZhdGUgaHlzdGVyZXNpcyhnOiBCaXRtYXApIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDI7IGkgPCBnLmhlaWdodCAtIDI7IGkrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDI7IGogPCBnLndpZHRoIC0gMjsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGl4ZWwgPSBnLmdldChpLCBqKTtcbiAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPT09IENhbm55LldFQUspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGcuZ2V0KGkgLSAxLCBqIC0gMSkgPT09IENhbm55LlNUUk9ORyB8fCBnLmdldChpIC0gMSwgaikgPT09IENhbm55LlNUUk9OR1xuICAgICAgICAgICAgICAgICAgICAgICAgfHwgZy5nZXQoaSAtIDEsIGogKyAxKSA9PT0gQ2FubnkuU1RST05HIHx8IGcuZ2V0KGksIGogLSAxKSA9PT0gQ2FubnkuU1RST05HXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCBnLmdldChpLCBqICsgMSkgPT09IENhbm55LlNUUk9ORyB8fCBnLmdldChpICsgMSwgaiAtIDEpID09PSBDYW5ueS5TVFJPTkdcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8IGcuZ2V0KGkgKyAxLCBqKSA9PT0gQ2FubnkuU1RST05HIHx8IGcuZ2V0KGkgKyAxLCBqICsgMSkgPT09IENhbm55LlNUUk9OR1xuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGcuc2V0KGksIGosIENhbm55LlNUUk9ORyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnLnNldChpLCBqLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCB0aGUgZWRnZSBkZXRlY3Rpb24uIFRoaXMgZG9lcyBub3QgbXV0YXRlIHRoZSBzb3VyY2UgaW1hZ2UuXG4gICAgICogQHBhcmFtIHNvdXJjZSAtIFRoZSBzb3VyY2UgaW1hZ2UuXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCByZXN1bHRpbmcgaW1hZ2UgKHdpdGggc2luZ2xlIGNoYW5uZWwpLlxuICAgICAqL1xuICAgIHJ1bihzb3VyY2U6IEJpdG1hcCkge1xuICAgICAgICByZXR1cm4gbmV3IEdhdXNzaWFuQmx1cih0aGlzLm9wdHMuZ2F1c3NpYW5CbHVyT3B0cykucnVuKHNvdXJjZSlcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiBuZXcgU29iZWwoKS5ydW4ocmVzKSlcbiAgICAgICAgICAgIC50aGVuKCh7IGcsIHRoZXRhIH0pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBoaWdoVGhyZXNob2xkID0gc291cmNlLm1heCgpICogdGhpcy5vcHRzLmhpZ2hUaHJlc2hvbGRSYXRpbztcbiAgICAgICAgICAgICAgICBjb25zdCBsb3dUaHJlc2hvbGQgPSBoaWdoVGhyZXNob2xkICogdGhpcy5vcHRzLmxvd1RocmVzaG9sZFJhdGlvO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmh5c3RlcmVzaXModGhpcy50aHJlc2hvbGQodGhpcy5ub25NYXhpbXVtU3VwcHJlc3Npb24oZywgdGhldGEpLCBsb3dUaHJlc2hvbGQsIGhpZ2hUaHJlc2hvbGQpKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBDYW5ueSB7XG4gICAgLyoqXG4gICAgICogUmVwcmVzZW50cyBvcHRpb25zIGZvciBjYW5ueSBlZGdlIGRldGVjdGlvbi5cbiAgICAgKi9cbiAgICBleHBvcnQgaW50ZXJmYWNlIE9wdHMge1xuICAgICAgICAvKipcbiAgICAgICAgICogQSB2YWx1ZSB0aGF0IGlzIHVzZWQgdG8gZGV0ZXJtaW5lIGxvdyB0aHJlc2hvbGQgdmFsdWUgd2hpbGUgcGVyZm9ybWluZyB0aHJlc2hvbGRpbmcuXG4gICAgICAgICAqIFRoZSBmb3JtdWxhOiBgTG93IFRocmVzaG9sZCBWYWx1ZSA9IEhpZ2ggVGhyZXNob2xkIFZhbHVlIHggTG93IFRocmVzaG9sZCBSYXRpb2BcbiAgICAgICAgICovXG4gICAgICAgIGxvd1RocmVzaG9sZFJhdGlvPzogbnVtYmVyO1xuICAgICAgICAvKipcbiAgICAgICAgICogQSB2YWx1ZSB0aGF0IGlzIHVzZWQgdG8gZGV0ZXJtaW5lIGhpZ2ggdGhyZXNob2xkIHZhbHVlIHdoaWxlIHBlcmZvcm1pbmcgdGhyZXNob2xkaW5nLlxuICAgICAgICAgKiBUaGUgZm9ybXVsYTogYEhpZ2ggVGhyZXNob2xkIFZhbHVlID0gTWF4aW11bSBQaXhlbCBWYWx1ZSBpbiB0aGUgU291cmNlIEltYWdlIHggSGlnaCBUaHJlc2hvbGQgUmF0aW9gXG4gICAgICAgICAqL1xuICAgICAgICBoaWdoVGhyZXNob2xkUmF0aW8/OiBudW1iZXI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPcHRpb25zIGZvciBnYXVzc2lhbiBibHVycmluZyB0aGF0IGlzIHBlcmZvcm1lZCBiZWZvcmUgc3RhcnRpbmcgZWRnZSBkZXRlY3Rpb24uXG4gICAgICAgICAqL1xuICAgICAgICBnYXVzc2lhbkJsdXJPcHRzPzogR2F1c3NpYW5CbHVyLk9wdHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29uc3RhbnQgdmFsdWUgZm9yIHBpeGVscyBjYXRlZ29yaXplZCB3ZWFrLlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGV4cG9ydCBjb25zdCBXRUFLID0gMTAwO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RhbnQgdmFsdWUgZm9yIHBpeGVscyBjYXRlZ29yaXplZCBzdHJvbmcuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgZXhwb3J0IGNvbnN0IFNUUk9ORyA9IDI1NTtcbn1cbiIsImltcG9ydCB7IHJhbmRvbSB9IGZyb20gJy4vdXRpbCc7XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIEstTWVhbnMgY2x1c3RlcmluZy5cbiAqL1xuZXhwb3J0IGNsYXNzIEtNZWFucyB7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgb3B0aW9ucy5cbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIG9wdHMgPSB7IG1heEl0ZXJhdGlvbnM6IDAsIGNsdXN0ZXJOdW1iZXI6IDIgfTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIEstTWVhbnMgY2x1c3RlcmluZyBvYmplY3QuXG4gICAgICogQHBhcmFtIG9wdHMgLSBUaGUgb3B0aW9ucy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvcHRzPzogS01lYW5zLk9wdHMpIHtcbiAgICAgICAgaWYgKG9wdHMpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0T3B0cyhvcHRzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgb3B0aW9ucy5cbiAgICAgKiBAcGFyYW0gb3B0cyAtIFRoZSBuZXcgb3B0aW9ucy5cbiAgICAgKi9cbiAgICBzZXRPcHRzKG9wdHM6IEtNZWFucy5PcHRzKSB7XG4gICAgICAgIHRoaXMub3B0cyA9IE9iamVjdC5hc3NpZ24odGhpcy5vcHRzLCBvcHRzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBjbHVzdGVyaW5nLlxuICAgICAqIEBwYXJhbSBzYW1wbGVzIC0gVGhlIHNhbXBsZXMuXG4gICAgICogQHJldHVybnMgQW4gb2JqZWN0IHdpdGggdHdvIGZpZWxkczpcbiAgICAgKiAgLSBgY2x1c3RlcnNgOiBhbiBhcnJheSB0aGF0IGhvbGRzIGNsdXN0ZXIgaW5kZXggZm9yIGVhY2ggc2FtcGxlLlxuICAgICAqICAtIGBjZW50cm9pZHNgOiBhbiBhcnJheSB0aGF0IGhvbGRzIHRoZSBjZW50cm9pZCBvZiBlYWNoIGNsdXN0ZXIuXG4gICAgICovXG4gICAgcnVuKHNhbXBsZXM6IEtNZWFucy5TYW1wbGVzKTogUHJvbWlzZTx7IGNsdXN0ZXJzOiBudW1iZXJbXSwgY2VudHJvaWRzOiBudW1iZXJbXVtdIH0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgY2VudHJvaWRzIHdpdGggMC5cbiAgICAgICAgICAgICAgICBjb25zdCBjZW50cm9pZHM6IG51bWJlcltdW10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiB0aGlzLm9wdHMuY2x1c3Rlck51bWJlciB9LFxuICAgICAgICAgICAgICAgICAgICAoKSA9PiBuZXcgQXJyYXkoc2FtcGxlcy5kaW1lbnNpb25OdW1iZXIpLmZpbGwoMCkpO1xuICAgICAgICAgICAgICAgIC8vIEFuIGFycmF5IGhvbGRzIHRoZSBjbHVzdGVyIGluZGV4IG9mIGVhY2ggc2FtcGxlLiBBbGwgcG9pbnRzIGJlbG9uZyB0byB0aGUgZmlyc3QgY2x1c3RlciBhdCB0aGUgYmVnaW5uaW5nLlxuICAgICAgICAgICAgICAgIGNvbnN0IHNhbXBsZUNsdXN0ZXJJZHhlczogbnVtYmVyW10gPSBuZXcgQXJyYXkoc2FtcGxlcy5sZW5ndGgpLmZpbGwoMCk7XG4gICAgICAgICAgICAgICAgbGV0IG51bWJlck9mSXRlcmF0aW9ucyA9IDA7XG4gICAgICAgICAgICAgICAgbGV0IGNlbnRyb2lkc0RvTm90Q2hhbmdlRm9yID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgY2x1c3RlcnNEb05vdENoYW5nZUZvciA9IDA7XG5cbiAgICAgICAgICAgICAgICBjb25zdCByYW5kb21DZW50cm9pZHM6IG51bWJlcltdW10gPSBbXTtcblxuICAgICAgICAgICAgICAgIC8vIERldGVybWluZSB1bmlxdWUgY2VudHJvaWRzLlxuICAgICAgICAgICAgICAgIHdoaWxlIChyYW5kb21DZW50cm9pZHMubGVuZ3RoIDwgdGhpcy5vcHRzLmNsdXN0ZXJOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmFuZElkeCA9IHJhbmRvbShzYW1wbGVzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICByYW5kb21DZW50cm9pZHMuZmlsdGVyKGNlbnRyb2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2VudHJvaWQubWFwKCh2LCBkKSA9PiB2IC0gc2FtcGxlcy5nZXQocmFuZElkeCwgZCkpLmZpbHRlcih2ID0+IHYgPT09IDApLmxlbmd0aCA9PT0gY2VudHJvaWQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgKS5sZW5ndGggPCAxXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VudHJvaWRzW3JhbmRvbUNlbnRyb2lkcy5sZW5ndGhdID0gY2VudHJvaWRzW3JhbmRvbUNlbnRyb2lkcy5sZW5ndGhdLm1hcCgoXywgZCkgPT4gc2FtcGxlcy5nZXQocmFuZElkeCwgZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmFuZG9tQ2VudHJvaWRzLnB1c2goY2VudHJvaWRzW3JhbmRvbUNlbnRyb2lkcy5sZW5ndGhdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNsdXN0ZXJDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHNhbXBsZUlkeCA9IDA7IHNhbXBsZUlkeCA8IHNhbXBsZXMubGVuZ3RoOyBzYW1wbGVJZHgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNsb3Nlc3RDZW50cm9pZElkeCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2xvc2VzdENlbnRyb2lkRGlzdGFuY2UgPSBJbmZpbml0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGNsdXN0ZXJJZHggPSAwOyBjbHVzdGVySWR4IDwgY2VudHJvaWRzLmxlbmd0aDsgY2x1c3RlcklkeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRpc3RhbmNlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBkID0gMDsgZCA8IHNhbXBsZXMuZGltZW5zaW9uTnVtYmVyOyBkKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2UgKz0gTWF0aC5wb3coY2VudHJvaWRzW2NsdXN0ZXJJZHhdW2RdIC0gc2FtcGxlcy5nZXQoc2FtcGxlSWR4LCBkKSwgMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gTWF0aC5zcXJ0KGRpc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPCBjbG9zZXN0Q2VudHJvaWREaXN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0Q2VudHJvaWREaXN0YW5jZSA9IGRpc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0Q2VudHJvaWRJZHggPSBjbHVzdGVySWR4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjbHVzdGVyQ2hhbmdlZCAmJiBzYW1wbGVDbHVzdGVySWR4ZXNbc2FtcGxlSWR4XSAhPT0gY2xvc2VzdENlbnRyb2lkSWR4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2x1c3RlckNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlQ2x1c3RlcklkeGVzW3NhbXBsZUlkeF0gPSBjbG9zZXN0Q2VudHJvaWRJZHg7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoY2x1c3RlckNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJzRG9Ob3RDaGFuZ2VGb3IgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2x1c3RlcnNEb05vdENoYW5nZUZvcisrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IG5ld0NlbnRyb2lkcyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IHRoaXMub3B0cy5jbHVzdGVyTnVtYmVyIH0sICgpID0+IG5ldyBBcnJheShzYW1wbGVzLmRpbWVuc2lvbk51bWJlcikuZmlsbCgwKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgc2FtcGxlSWR4ID0gMDsgc2FtcGxlSWR4IDwgc2FtcGxlcy5sZW5ndGg7IHNhbXBsZUlkeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBkID0gMDsgZCA8IHNhbXBsZXMuZGltZW5zaW9uTnVtYmVyOyBkKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDZW50cm9pZHNbc2FtcGxlQ2x1c3RlcklkeGVzW3NhbXBsZUlkeF1dW2RdICs9IHNhbXBsZXMuZ2V0KHNhbXBsZUlkeCwgZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBuZXdDZW50cm9pZHMgPSBuZXdDZW50cm9pZHMubWFwKChjZW50cm9pZCwgY2x1c3RlcklkeCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRyb2lkLm1hcCh4ID0+IHggLyBzYW1wbGVDbHVzdGVySWR4ZXMuZmlsdGVyKGlkeCA9PiBpZHggPT09IGNsdXN0ZXJJZHgpLmxlbmd0aCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCBjZW50cm9pZHNDaGFuZ2VkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgY2VudHJvaWRJZHggPSAwOyBjZW50cm9pZElkeCA8IGNlbnRyb2lkcy5sZW5ndGg7IGNlbnRyb2lkSWR4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGQgPSAwOyBkIDwgc2FtcGxlcy5kaW1lbnNpb25OdW1iZXI7IGQrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjZW50cm9pZHNbY2VudHJvaWRJZHhdW2RdICE9PSBuZXdDZW50cm9pZHNbY2VudHJvaWRJZHhdW2RdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRyb2lkc1tjZW50cm9pZElkeF1bZF0gPSBuZXdDZW50cm9pZHNbY2VudHJvaWRJZHhdW2RdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZW50cm9pZHNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoY2VudHJvaWRzQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VudHJvaWRzRG9Ob3RDaGFuZ2VGb3IgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VudHJvaWRzRG9Ob3RDaGFuZ2VGb3IrKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBudW1iZXJPZkl0ZXJhdGlvbnMrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgd2hpbGUgKCEoXG4gICAgICAgICAgICAgICAgICAgIChjZW50cm9pZHNEb05vdENoYW5nZUZvciA+IDIpIHx8XG4gICAgICAgICAgICAgICAgICAgIChjbHVzdGVyc0RvTm90Q2hhbmdlRm9yID4gMikgfHxcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMub3B0cy5tYXhJdGVyYXRpb25zICE9PSAwICYmIG51bWJlck9mSXRlcmF0aW9ucyA+IHRoaXMub3B0cy5tYXhJdGVyYXRpb25zKVxuICAgICAgICAgICAgICAgICkpO1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh7IGNsdXN0ZXJzOiBzYW1wbGVDbHVzdGVySWR4ZXMsIGNlbnRyb2lkcyB9KTtcblxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBLTWVhbnMge1xuXG4gICAgLyoqXG4gICAgICogUmVwcmVzZW50cyBvcHRpb25zIGZvciBLLU1lYW5zLlxuICAgICAqL1xuICAgIGV4cG9ydCBpbnRlcmZhY2UgT3B0cyB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbnVtYmVyIG1heGltdW0gaXRlcmF0aW9ucy4gV2hlbiBpdCBpcyBleGNlZWRlZCwgYWxnb3JpdGhtIHN0b3BzIGltbWVkaWF0ZWx5LlxuICAgICAgICAgKi9cbiAgICAgICAgbWF4SXRlcmF0aW9ucz86IG51bWJlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgY2x1c3RlcnMuXG4gICAgICAgICAqL1xuICAgICAgICBjbHVzdGVyTnVtYmVyPzogbnVtYmVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcHJlc2VudHMgdGhlIGlucHV0IG9mIGEgSy1NZWFucyBhbGdvcml0aG0uIEFsbCBpbnB1dHMgc2hhbGwgaW1wbGVtZW50IHRoaXMgaW50ZXJmYWNlLlxuICAgICAqL1xuICAgIGV4cG9ydCBpbnRlcmZhY2UgU2FtcGxlcyB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbnVtYmVyIG9mIHNhbXBsZXMuXG4gICAgICAgICAqL1xuICAgICAgICByZWFkb25seSBsZW5ndGg6IG51bWJlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBkaW1lbnNpb24gb2YgdGhlIHNhbXBsZXMuXG4gICAgICAgICAqL1xuICAgICAgICByZWFkb25seSBkaW1lbnNpb25OdW1iZXI6IG51bWJlcjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgZ2V0dGVyIG1ldGhvZCB0aGF0IHJldHVybnMgaS10aCBzYW1wbGUncyB2YWx1ZSBpbiBgZGltZW5zaW9uYC10aCBkaW1lbnNpb24uXG4gICAgICAgICAqL1xuICAgICAgICBnZXQoaWR4OiBudW1iZXIsIGRpbWVuc2lvbjogbnVtYmVyKTogbnVtYmVyO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEJpdG1hcCB9IGZyb20gJy4vaW1hZ2UnO1xuaW1wb3J0IHsgS01lYW5zIH0gZnJvbSAnLi9rLW1lYW5zJztcblxuLyoqXG4gKiBBIGNsYXNzIHRoYXQgbWFrZXMge0BsaW5rIEJpdG1hcH1zIHVzYWJsZSBhcyBpbnB1dCBvZiBLLU1lYW5zIGJ5IGltcGxlbWVudGluZyB7QGxpbmsgS01lYW5zLlNhbXBsZXN9LlxuICogQGV4dGVuZHMgQml0bWFwXG4gKi9cbmV4cG9ydCBjbGFzcyBLTWVhbnNTZWdtZW50YXRpb25CaXRtYXAgZXh0ZW5kcyBCaXRtYXAgaW1wbGVtZW50cyBLTWVhbnMuU2FtcGxlcyB7XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3QgYW4gc2FtcGxlcyBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCBhcyBpbnB1dCBvZiBLLU1lYW5zLlxuICAgICAqIEBwYXJhbSBpbWFnZSAtIFRoZSBvcmlnaW5hbCBpbWFnZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihpbWFnZTogQml0bWFwKSB7XG4gICAgICAgIHN1cGVyKGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQsIGltYWdlLmNoYW5uZWxOdW1iZXIsIGltYWdlLnBpeGVscyk7XG4gICAgfVxuXG4gICAgZ2V0KGlkeDogbnVtYmVyLCBkaW1lbnNpb246IG51bWJlcikge1xuICAgICAgICByZXR1cm4gdGhpcy5waXhlbHNbaWR4ICogdGhpcy5jaGFubmVsTnVtYmVyICsgZGltZW5zaW9uXTtcbiAgICB9XG5cbiAgICBnZXQgbGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0O1xuICAgIH1cbiAgICBnZXQgZGltZW5zaW9uTnVtYmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVsTnVtYmVyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIEstTWVhbnMgc2VnbWVudGF0aW9uIG9uIGltYWdlcy5cbiAqL1xuZXhwb3J0IGNsYXNzIEtNZWFuc1NlZ21lbnRhdGlvbiB7XG4gICAgLyoqXG4gICAgICogVGhlIG9wdGlvbnMuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBvcHRzOiBSZXF1aXJlZDxLTWVhbnNTZWdtZW50YXRpb24uT3B0cz4gPSB7IGJ5SW50ZW5zaXR5OiBmYWxzZSwgY29sb3JzOiAzIH07XG4gICAgLyoqXG4gICAgICogVGhlIGFjdHVhbCBLbWVhbnMgY2x1c3RlcmluZyBvYmplY3QgdGhhdCBwZXJmb3JtcyBzZWdtZW50YXRpb24uXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHJpdmF0ZSBrbWVhbnM6IEtNZWFucztcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIEstTWVhbnMgc2VnbWVudGF0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0gb3B0cyAtIFRoZSBvcHRpb25zLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKG9wdHM/OiBLTWVhbnNTZWdtZW50YXRpb24uT3B0cykge1xuICAgICAgICBpZiAob3B0cykge1xuICAgICAgICAgICAgdGhpcy5zZXRPcHRzKG9wdHMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlS21lYW5zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIEtNZWFucyBjbHVzdGVyaW5nIG9iamVjdCBhY2NvcmRpbmcgdG8gdGhlIGN1cnJlbnQgb3B0aW9ucy5cbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIHVwZGF0ZUttZWFucygpIHtcbiAgICAgICAgdGhpcy5rbWVhbnMgPSBuZXcgS01lYW5zKHtcbiAgICAgICAgICAgIGNsdXN0ZXJOdW1iZXI6IEFycmF5LmlzQXJyYXkodGhpcy5vcHRzLmNvbG9ycykgPyB0aGlzLm9wdHMuY29sb3JzLmxlbmd0aCA6IHRoaXMub3B0cy5jb2xvcnMsXG4gICAgICAgICAgICBtYXhJdGVyYXRpb25zOiAxMFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIG9wdGlvbnMuXG4gICAgICogQHBhcmFtIG9wdHMgLSBUaGUgbmV3IG9wdGlvbnMuXG4gICAgICovXG4gICAgc2V0T3B0cyhvcHRzOiBLTWVhbnNTZWdtZW50YXRpb24uT3B0cykge1xuICAgICAgICB0aGlzLm9wdHMgPSBPYmplY3QuYXNzaWduKHRoaXMub3B0cywgb3B0cyk7XG4gICAgICAgIHRoaXMudXBkYXRlS21lYW5zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnQgc2VnbWVudGF0aW9uLiBUaGlzIG1ldGhvZCBkb2VzIG5vdCBtdXRhdGUgdGhlIHNvdXJjZSBpbWFnZS5cbiAgICAgKiBAcGFyYW0gc291cmNlIC0gU291cmNlIGltYWdlXG4gICAgICogQHJldHVybnMgQSBwcm9taXNlIHRoYXQgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0aW5nIGltYWdlLlxuICAgICAqIChzaW5nbGUgY2hhbm5lbCBpZiBgYnlJbnRlbnNpdHlgIGlzIHNldCBpbiB7QGxpbmsgS01lYW5zU2VnbWVudGF0aW9uLk9wdHN9KVxuICAgICAqL1xuICAgIHJ1bihzb3VyY2U6IEJpdG1hcCkge1xuICAgICAgICBjb25zdCBzYW1wbGVzID0gbmV3IEtNZWFuc1NlZ21lbnRhdGlvbkJpdG1hcCh0aGlzLm9wdHMuYnlJbnRlbnNpdHkgPyBzb3VyY2UudG9HcmF5U2NhbGUoKSA6IHNvdXJjZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmttZWFucy5ydW4oc2FtcGxlcykudGhlbigoeyBjbHVzdGVycywgY2VudHJvaWRzIH0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMub3B0cy5ieUludGVuc2l0eSA/IHNhbXBsZXMudG9NdWx0aUNoYW5uZWwoMykgOiBzYW1wbGVzO1xuXG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGhpcy5vcHRzLmNvbG9ycykpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdC53aWR0aCAqIHJlc3VsdC5oZWlnaHQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucGl4ZWxzW2kgKiAzXSA9IGNlbnRyb2lkc1tjbHVzdGVyc1tpXV1bMF07XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5waXhlbHNbaSAqIDMgKyAxXSA9IGNlbnRyb2lkc1tjbHVzdGVyc1tpXV1bdGhpcy5vcHRzLmJ5SW50ZW5zaXR5ID8gMCA6IDFdO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucGl4ZWxzW2kgKiAzICsgMl0gPSBjZW50cm9pZHNbY2x1c3RlcnNbaV1dW3RoaXMub3B0cy5ieUludGVuc2l0eSA/IDAgOiAyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0LndpZHRoICogcmVzdWx0LmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5waXhlbHNbaSAqIDNdID0gdGhpcy5vcHRzLmNvbG9yc1tjbHVzdGVyc1tpXV1bMF07XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5waXhlbHNbaSAqIDMgKyAxXSA9IHRoaXMub3B0cy5jb2xvcnNbY2x1c3RlcnNbaV1dWzFdO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQucGl4ZWxzW2kgKiAzICsgMl0gPSB0aGlzLm9wdHMuY29sb3JzW2NsdXN0ZXJzW2ldXVsyXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgS01lYW5zU2VnbWVudGF0aW9uIHtcbiAgICAvKipcbiAgICAgKiBSZXByZXNlbnRzIG9wdGlvbnMgZm9yIEstTWVhbnMgc2VnbWVudGF0aW9uIG9uIGltYWdlcy5cbiAgICAgKi9cbiAgICBleHBvcnQgaW50ZXJmYWNlIE9wdHMge1xuICAgICAgICAvKipcbiAgICAgICAgICogU2VnbWVudCBjb3VudC4gSXQgaXMgbmFtZWQgY29sb3JzLCBiZWNhdXNlIGl0IGNhbiBhbHNvIGJlIHVzZWQgdG8gZGlyZWN0bHkgc3BlY2lmeSB0aGUgb3V0cHV0IGNvbG9yIG9mIHRoZSBzZWdtZW50cy5cbiAgICAgICAgICogVG8gc3BlY2lmeSBjb2xvcnMsIHByb3ZpZGUgYW4gYXJyYXkgdGhhdCBjb250YWlucyBjb2xvcnMgYXMgYXJyYXkgb2YgUkdCIHZhbHVlcywgZS5nIGBbWzAsMCwwXSwgWzEwMCwxMDAsMTAwXV1gIG1lYW5zXG4gICAgICAgICAqIGNyZWF0ZSAyIHNlZ21lbnRzIGFuZCB1c2UgUjowLCBHOjAsIEI6MCBmb3IgdGhlIGZpcnN0IHNlZ21lbnQgYW5kIFI6MTAwLCBHOjEwMCwgQjoxMDAgZm9yIHRoZSBzZWNvbmQgb25lLlxuICAgICAgICAgKiBJZiBvbmx5IGEgbnVtYmVyIGlzIHN1cHBsaWVkLCB0aGVuIHRoZSBjb2xvcnMgd2lsbCBiZSBkZXJpdmVkIGZyb20gdGhlIG1lYW4gb2YgdGhlIHNlZ21lbnRzLCBpLmUgcmVkdWNlIHRoZSBiaXQtZGVwdC5cbiAgICAgICAgICovXG4gICAgICAgIGNvbG9ycz86IG51bWJlcltdW10gfCBudW1iZXI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTcGVjaWZpZXMgd2hldGhlciBpbnRlbnNpdHkgKHRyZWF0IGFzIGdyYXlzY2FsZSkgb3IgdGhlIGFjdHVhbCBSR0IgdmFsdWVzIGFyZSB1c2VkIGZvciBkb2luZyBzZWdtZW50YXRpb24gd2hlblxuICAgICAgICAgKiB0aGUgaW1hZ2UgaXMgUkdCIGNvbG9yZWQuXG4gICAgICAgICAqL1xuICAgICAgICBieUludGVuc2l0eT86IGJvb2xlYW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQml0bWFwLCBEcmF3YWJsZSB9IGZyb20gJy4uL3NyYy9pbWFnZSc7XG5pbXBvcnQgeyBHYXVzc2lhbkJsdXIsIFNvYmVsLCBCYXNpY0ZpbHRlciB9IGZyb20gJy4uL3NyYy9maWx0ZXInO1xuaW1wb3J0IHsgQ2FubnkgfSBmcm9tICcuLi9zcmMvZmVhdHVyZSc7XG5pbXBvcnQgeyBLTWVhbnNTZWdtZW50YXRpb24gfSBmcm9tICcuLi9zcmMvc2VnbWVudGF0aW9uJztcbmltcG9ydCB7IHJhbmRvbSB9IGZyb20gJy4uL3NyYy91dGlsJztcblxuY29uc3QgQ0FOVkFTX1NJWkUgPSA4MDA7XG5cbmNsYXNzIERlbW9BcHAge1xuXG4gICAgRUxTID0ge1xuICAgICAgICBhcHA6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhcHAnKSBhcyBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgb3ZlcmxheTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKSBhcyBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgaW5wdXQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dCcpIGFzIEhUTUxDYW52YXNFbGVtZW50LFxuICAgICAgICBpbWFnZUlucHV0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW1hZ2VJbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIGxvYWRJbWFnZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRJbWFnZScpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBsb2FkSW1hZ2UyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZEltYWdlMicpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICB1bmRvOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW5kbycpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICByZWRvOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVkbycpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBncmF5c2NhbGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdncmF5c2NhbGUnKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgc29iZWw6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb2JlbCcpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICBwb3B1cHM6IHtcbiAgICAgICAgICAgIGtlcm5lbDoge1xuICAgICAgICAgICAgICAgIG9wZW46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXJuZWxPcGVuJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgcG9wdXA6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXJuZWxQb3B1cCcpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICAgICAgICAgIHNpemU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXJuZWxPcHRpb25zU2l6ZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgbWF0cml4OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2VybmVsT3B0aW9uc01hdHJpeCcpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICAgICAgICAgIGFwcGx5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2VybmVsQXBwbHknKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBjYW5jZWw6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXJuZWxDYW5jZWwnKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBlcnJvcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tlcm5lbEVycm9yJykgYXMgSFRNTERpdkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgdHJhbnNwb3NlOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2VybmVsVHJhbnNwb3NlJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnYXVzczoge1xuICAgICAgICAgICAgICAgIG9wZW46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYXVzc09wZW4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBwb3B1cDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhdXNzUG9wdXAnKSBhcyBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgICAgICAgICBzaXplOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2F1c3NTaXplJykgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgICAgICAgICBzaWdtYTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhdXNzU2lnbWEnKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIGFwcGx5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2F1c3NBcHBseScpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIGNhbmNlbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhdXNzQ2FuY2VsJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYXVzc0Vycm9yJykgYXMgSFRNTERpdkVsZW1lbnRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYW5ueToge1xuICAgICAgICAgICAgICAgIG9wZW46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5ueU9wZW4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBwb3B1cDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55UG9wdXAnKSBhcyBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgICAgICAgICBsb3c6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5ueUxvdycpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgaGlnaDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55SGlnaCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgc2l6ZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55R2F1c3NTaXplJykgYXMgSFRNTElucHV0RWxlbWVudCxcbiAgICAgICAgICAgICAgICBzaWdtYTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55R2F1c3NTaWdtYScpIGFzIEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgYXBwbHk6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5ueUFwcGx5JykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FubnlDYW5jZWwnKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBlcnJvcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm55RXJyb3InKSBhcyBIVE1MRGl2RWxlbWVudFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlZ21lbnQ6IHtcbiAgICAgICAgICAgICAgICBvcGVuOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudE9wZW4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBwb3B1cDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlZ21lbnRQb3B1cCcpIGFzIEhUTUxEaXZFbGVtZW50LFxuICAgICAgICAgICAgICAgIG51bWJlcjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlZ21lbnROdW1iZXInKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIHJnYjogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlZ21lbnRSR0InKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIGludGVuc2l0eTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlZ21lbnRJbnRlbnNpdHknKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIGFwcGx5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudEFwcGx5JykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgY2FuY2VsOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudENhbmNlbCcpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIGVycm9yOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VnbWVudEVycm9yJykgYXMgSFRNTERpdkVsZW1lbnRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21wcmVzczoge1xuICAgICAgICAgICAgICAgIG9wZW46IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21wcmVzc09wZW4nKSBhcyBIVE1MQnV0dG9uRWxlbWVudCxcbiAgICAgICAgICAgICAgICBwb3B1cDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXByZXNzUG9wdXAnKSBhcyBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgICAgICAgICBkZXB0aDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXByZXNzRGVwdGgnKSBhcyBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIGFwcGx5OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tcHJlc3NBcHBseScpIGFzIEhUTUxCdXR0b25FbGVtZW50LFxuICAgICAgICAgICAgICAgIGNhbmNlbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXByZXNzQ2FuY2VsJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21wcmVzc0Vycm9yJykgYXMgSFRNTERpdkVsZW1lbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBpbWFnZVdpZHRoOiBudW1iZXI7XG4gICAgaW1hZ2VIZWlnaHQ6IG51bWJlcjtcblxuICAgIGtlcm5lbDoge1xuICAgICAgICBzaXplOiBudW1iZXI7XG4gICAgICAgIG1hdHJpeDogQmFzaWNGaWx0ZXI7XG4gICAgfTtcblxuICAgIGdhdXNzID0gbmV3IEdhdXNzaWFuQmx1cigpO1xuXG4gICAgY2FubnkgPSBuZXcgQ2FubnkoKTtcblxuICAgIHNlZ21lbnRhdGlvbiA9IG5ldyBLTWVhbnNTZWdtZW50YXRpb24oKTtcblxuICAgIGNvbXByZXNzaW9uID0gbmV3IEtNZWFuc1NlZ21lbnRhdGlvbigpO1xuXG4gICAgaGlzdG9yeTogQml0bWFwW10gPSBbXTtcbiAgICBoaXN0b3J5SW5kZXg6IG51bWJlcjtcblxuICAgIHByaXZhdGUgY3JlYXRlRWxlbWVudChodG1sOiBzdHJpbmcpOiBDaGlsZE5vZGUge1xuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGl2LmlubmVySFRNTCA9IGh0bWwudHJpbSgpO1xuICAgICAgICByZXR1cm4gZGl2LmZpcnN0Q2hpbGQhO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2hvdyhlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWw/LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaGlkZShlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWw/LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2hvd1BvcHVwKGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICB0aGlzLnNob3coZWwpO1xuICAgICAgICB0aGlzLnNob3codGhpcy5FTFMub3ZlcmxheSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoaWRlUG9wdXAoZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuaGlkZShlbCk7XG4gICAgICAgIHRoaXMuaGlkZSh0aGlzLkVMUy5vdmVybGF5KTtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcblxuICAgICAgICB0aGlzLmhpZGUodGhpcy5FTFMub3ZlcmxheSk7XG5cbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5FTFMucG9wdXBzKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxzID0gKHRoaXMuRUxTLnBvcHVwcyBhcyBhbnkpW25hbWVdIGFzIHsgW2tleTogc3RyaW5nXTogSFRNTEVsZW1lbnQgfTtcbiAgICAgICAgICAgIHRoaXMuaGlkZShlbHMucG9wdXApO1xuICAgICAgICAgICAgdGhpcy5oaWRlKGVscy5lcnJvcik7XG4gICAgICAgICAgICBlbHMub3Blbi5vbmNsaWNrID0gKCkgPT4gdGhpcy5zaG93UG9wdXAoZWxzLnBvcHVwKTtcbiAgICAgICAgICAgIGVscy5jYW5jZWwub25jbGljayA9ICgpID0+IHRoaXMuaGlkZVBvcHVwKGVscy5wb3B1cCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuRUxTLnVuZG8ub25jbGljayA9ICgpID0+IHRoaXMudW5kbygpO1xuICAgICAgICB0aGlzLkVMUy5yZWRvLm9uY2xpY2sgPSAoKSA9PiB0aGlzLnJlZG8oKTtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgJiYgZXZlbnQua2V5ID09PSAneicpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuZG8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5ICYmIGV2ZW50LmtleSA9PT0gJ3knKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWRvKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuRUxTLmdyYXlzY2FsZS5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kbygoKSA9PiB0aGlzLnJlbmRlckltYWdlKHRoaXMuRUxTLmlucHV0LCBCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCkpKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgb25HYXVzc0NoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5lcnJvcik7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IHBhcnNlSW50KHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5zaXplLnZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2lnbWEgPSBwYXJzZUZsb2F0KHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5zaWdtYS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5nYXVzcy5zZXRPcHRzKHsgc2lnbWEsIG46IHNpemUgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5lcnJvci5pbm5lclRleHQgPSBlcnI7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93KHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgb25DYW5ueUNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5lcnJvcik7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IHBhcnNlSW50KHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5zaXplLnZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2lnbWEgPSBwYXJzZUZsb2F0KHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5zaWdtYS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbG93ID0gcGFyc2VGbG9hdCh0aGlzLkVMUy5wb3B1cHMuY2FubnkubG93LnZhbHVlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBoaWdoID0gcGFyc2VGbG9hdCh0aGlzLkVMUy5wb3B1cHMuY2FubnkuaGlnaC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW5ueS5zZXRPcHRzKHtcbiAgICAgICAgICAgICAgICAgICAgbG93VGhyZXNob2xkUmF0aW86IGxvdyxcbiAgICAgICAgICAgICAgICAgICAgaGlnaFRocmVzaG9sZFJhdGlvOiBoaWdoLFxuICAgICAgICAgICAgICAgICAgICBnYXVzc2lhbkJsdXJPcHRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuOiBzaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2lnbWFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLkVMUy5wb3B1cHMuY2FubnkuZXJyb3IuaW5uZXJUZXh0ID0gZXJyO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvdyh0aGlzLkVMUy5wb3B1cHMuY2FubnkuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IG9uU2VnbWVudENoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50LmVycm9yKTtcbiAgICAgICAgICAgICAgICBjb25zdCBudW1iZXIgPSBwYXJzZUludCh0aGlzLkVMUy5wb3B1cHMuc2VnbWVudC5udW1iZXIudmFsdWUsIDEwKTtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbnVtYmVyICE9PSAnbnVtYmVyJyB8fCAhTnVtYmVyLmlzSW50ZWdlcihudW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2VnbWVudCBudW1iZXIgc2hvdWxkIGJlIGFuIGludGVnZXIuJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgcmdiID0gdGhpcy5FTFMucG9wdXBzLnNlZ21lbnQucmdiLmNoZWNrZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWdtZW50YXRpb24uc2V0T3B0cyh7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yczogQXJyYXkuZnJvbSh7IGxlbmd0aDogbnVtYmVyIH0sICgpID0+IFtyYW5kb20oMjU1LCAxMCksIHJhbmRvbSgyNTUsIDEwKSwgcmFuZG9tKDI1NSwgMTApXSksXG4gICAgICAgICAgICAgICAgICAgIGJ5SW50ZW5zaXR5OiAhcmdiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50LmVycm9yLmlubmVyVGV4dCA9IGVycjtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3codGhpcy5FTFMucG9wdXBzLnNlZ21lbnQuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IG9uQ29tcHJlc3NDaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZSh0aGlzLkVMUy5wb3B1cHMuY29tcHJlc3MuZXJyb3IpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlcHRoID0gcGFyc2VJbnQodGhpcy5FTFMucG9wdXBzLmNvbXByZXNzLmRlcHRoLnZhbHVlLCAxMCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRlcHRoICE9PSAnbnVtYmVyJyB8fCAhTnVtYmVyLmlzSW50ZWdlcihkZXB0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb2xvciBkZXB0aCBzaG91bGQgYmUgYW4gaW50ZWdlci4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc2lvbi5zZXRPcHRzKHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3JzOiBNYXRoLnBvdygyLCBkZXB0aCksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jb21wcmVzcy5lcnJvci5pbm5lclRleHQgPSBlcnI7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93KHRoaXMuRUxTLnBvcHVwcy5jb21wcmVzcy5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmNvbXByZXNzLmRlcHRoLm9ua2V5dXAgPSBvbkNvbXByZXNzQ2hhbmdlO1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50Lm51bWJlci5vbmtleXVwID0gb25TZWdtZW50Q2hhbmdlO1xuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuc2VnbWVudC5yZ2Iub25jaGFuZ2UgPSBvblNlZ21lbnRDaGFuZ2U7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5zZWdtZW50LmludGVuc2l0eS5vbmNoYW5nZSA9IG9uU2VnbWVudENoYW5nZTtcblxuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuY2Fubnkuc2lnbWEub25rZXl1cCA9IG9uQ2FubnlDaGFuZ2U7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jYW5ueS5zaXplLm9ua2V5dXAgPSBvbkNhbm55Q2hhbmdlO1xuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuY2FubnkubG93Lm9ua2V5dXAgPSBvbkNhbm55Q2hhbmdlO1xuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuY2FubnkuaGlnaC5vbmtleXVwID0gb25DYW5ueUNoYW5nZTtcblxuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuZ2F1c3Muc2lnbWEub25rZXl1cCA9IG9uR2F1c3NDaGFuZ2U7XG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5zaXplLm9ua2V5dXAgPSBvbkdhdXNzQ2hhbmdlO1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwudHJhbnNwb3NlLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmtlcm5lbC5tYXRyaXgudHJhbnNwb3NlKCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMua2VybmVsLnNpemU7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5rZXJuZWwuc2l6ZTsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGtlcm5lbENlbGxfJHtpfV8ke2p9YCkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgZWwudmFsdWUgPSAnJyArIHRoaXMua2VybmVsLm1hdHJpeC5nZXQoaSwgaik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwuc2l6ZS5vbmtleXVwID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oaWRlKHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwuZXJyb3IpO1xuICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IHBhcnNlSW50KHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwuc2l6ZS52YWx1ZSwgMTApO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzaXplICE9PSAnbnVtYmVyJyB8fCBzaXplICUgMiA9PT0gMCB8fCBzaXplIDwgMykge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwuZXJyb3IuaW5uZXJUZXh0ID0gJ0tlcm5lbCBzaXplIHNob3VsZCBiZSBhbiBvZGQgbnVtYmVyIGdyZWF0ZXIgdGhhbiAzLic7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93KHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwuZXJyb3IpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgbWF0cml4ID0gbmV3IEJhc2ljRmlsdGVyKHNpemUsIHNpemUsIDApO1xuXG4gICAgICAgICAgICBtYXRyaXguc2V0KChzaXplIC0gMSkgLyAyLCAoc2l6ZSAtIDEpIC8gMiwgMSk7XG5cbiAgICAgICAgICAgIHRoaXMua2VybmVsID0ge1xuICAgICAgICAgICAgICAgIG1hdHJpeCxcbiAgICAgICAgICAgICAgICBzaXplXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLkVMUy5wb3B1cHMua2VybmVsLm1hdHJpeC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5FTFMucG9wdXBzLmtlcm5lbC5tYXRyaXguYXBwZW5kQ2hpbGQoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlRWxlbWVudChgXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImQtZmxleFwiPlxuICAgICAgICAgICAgICAgICAgICAke25ldyBBcnJheShzaXplKS5maWxsKHVuZGVmaW5lZCkubWFwKChfLCBqKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IGlkPVwia2VybmVsQ2VsbF8ke2l9XyR7an1cIiB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZm9ybS1jb250cm9sIHRleHQtY2VudGVyXCIgb25jaGFuZ2U9XCJcIiB2YWx1ZT1cIiR7bWF0cml4LmdldChpLCBqKX1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmBcbiAgICAgICAgICAgICAgICAgICAgKS5qb2luKCcnKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIGApKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNpemU7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBrZXJuZWxDZWxsXyR7aX1fJHtqfWApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWwub25jaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0cml4LnNldChpLCBqLCBwYXJzZUZsb2F0KGVsLnZhbHVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5jb21wcmVzcy5hcHBseS5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAodGhpcy5FTFMucG9wdXBzLmNvbXByZXNzLnBvcHVwKTtcbiAgICAgICAgICAgIHRoaXMuY29tcHJlc3Npb24ucnVuKEJpdG1hcC5mcm9tSW1hZ2VEYXRhKHRoaXMuZ2V0SW1hZ2VEYXRhKHRoaXMuRUxTLmlucHV0KSwgMykpXG4gICAgICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHRoaXMuZG8oKCkgPT4gdGhpcy5yZW5kZXJJbWFnZSh0aGlzLkVMUy5pbnB1dCwgcmVzdWx0KSkpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiBhbGVydChlcnIpKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuc2VnbWVudC5hcHBseS5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAodGhpcy5FTFMucG9wdXBzLnNlZ21lbnQucG9wdXApO1xuICAgICAgICAgICAgb25TZWdtZW50Q2hhbmdlKCk7XG4gICAgICAgICAgICB0aGlzLnNlZ21lbnRhdGlvbi5ydW4oQml0bWFwLmZyb21JbWFnZURhdGEodGhpcy5nZXRJbWFnZURhdGEodGhpcy5FTFMuaW5wdXQpLCAzKSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4gdGhpcy5kbygoKSA9PiB0aGlzLnJlbmRlckltYWdlKHRoaXMuRUxTLmlucHV0LCByZXN1bHQpKSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IGFsZXJ0KGVycikpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwuYXBwbHkub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKHRoaXMuRUxTLnBvcHVwcy5rZXJuZWwucG9wdXApO1xuICAgICAgICAgICAgdGhpcy5rZXJuZWwubWF0cml4LnJ1bihCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCksIDMpKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB0aGlzLmRvKCgpID0+IHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIHJlc3VsdCkpKVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gYWxlcnQoZXJyKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmdhdXNzLmFwcGx5Lm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCh0aGlzLkVMUy5wb3B1cHMuZ2F1c3MucG9wdXApO1xuXG4gICAgICAgICAgICB0aGlzLmdhdXNzLnJ1bihCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCksIDMpKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB0aGlzLmRvKCgpID0+IHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIHJlc3VsdCkpKVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gYWxlcnQoZXJyKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMuc29iZWwub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKHRoaXMuRUxTLnBvcHVwcy5nYXVzcy5wb3B1cCk7XG4gICAgICAgICAgICBuZXcgU29iZWwoKS5ydW4oQml0bWFwLmZyb21JbWFnZURhdGEodGhpcy5nZXRJbWFnZURhdGEodGhpcy5FTFMuaW5wdXQpLCAzKSlcbiAgICAgICAgICAgICAgICAudGhlbigoeyBnIH0pID0+IHRoaXMuZG8oKCkgPT4gdGhpcy5yZW5kZXJJbWFnZSh0aGlzLkVMUy5pbnB1dCwgZykpKVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gYWxlcnQoZXJyKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmNhbm55LmFwcGx5Lm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCh0aGlzLkVMUy5wb3B1cHMuY2FubnkucG9wdXApO1xuXG4gICAgICAgICAgICB0aGlzLmNhbm55LnJ1bihCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCksIDMpKVxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB0aGlzLmRvKCgpID0+IHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIHJlc3VsdCkpKVxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gYWxlcnQoZXJyKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmtlcm5lbC5zaXplLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdrZXl1cCcpKTtcbiAgICAgICAgdGhpcy5FTFMucG9wdXBzLmdhdXNzLnNpemUuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2tleXVwJykpO1xuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuc2VnbWVudC5udW1iZXIuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2tleXVwJykpO1xuICAgICAgICB0aGlzLkVMUy5wb3B1cHMuY29tcHJlc3MuZGVwdGguZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2tleXVwJykpO1xuXG4gICAgICAgIFt0aGlzLkVMUy5pbnB1dF0uZm9yRWFjaChjYW52YXMgPT4ge1xuICAgICAgICAgICAgY2FudmFzLndpZHRoID0gQ0FOVkFTX1NJWkU7XG4gICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gQ0FOVkFTX1NJWkU7XG4gICAgICAgICAgICBjYW52YXMub253aGVlbCA9IGUgPT4ge1xuICAgICAgICAgICAgICAgIGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpPy5zY2FsZSgyLCAyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsZWFyQ2FudmFzKGNhbnZhcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuRUxTLmxvYWRJbWFnZS5vbmNsaWNrID0gKCkgPT4gdGhpcy5FTFMuaW1hZ2VJbnB1dC5jbGljaygpO1xuICAgICAgICB0aGlzLkVMUy5sb2FkSW1hZ2UyLm9uY2xpY2sgPSAoKSA9PiB0aGlzLkVMUy5pbWFnZUlucHV0LmNsaWNrKCk7XG5cbiAgICAgICAgdGhpcy5FTFMuaW1hZ2VJbnB1dC5vbmNoYW5nZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuRUxTLmdyYXlzY2FsZS5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5FTFMuc29iZWwuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuRUxTLmxvYWRJbWFnZTIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuRUxTLnBvcHVwcykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbHMgPSAodGhpcy5FTFMucG9wdXBzIGFzIGFueSlbbmFtZV0gYXMgeyBba2V5OiBzdHJpbmddOiBIVE1MRWxlbWVudCB9O1xuICAgICAgICAgICAgICAgIChlbHMub3BlbiBhcyBIVE1MQnV0dG9uRWxlbWVudCkuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5FTFMuaW1hZ2VJbnB1dC5maWxlcz8uWzBdO1xuICAgICAgICAgICAgY29uc3QgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgICAgICBmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSEpO1xuICAgICAgICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICAgICAgICAgICAgaW1nLnNyYyA9IGZpbGVSZWFkZXIucmVzdWx0IS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VXaWR0aCA9IGltZy5uYXR1cmFsV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VIZWlnaHQgPSBpbWcubmF0dXJhbEhlaWdodDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbWFnZVdpZHRoID4gQ0FOVkFTX1NJWkUgfHwgdGhpcy5pbWFnZUhlaWdodCA+IENBTlZBU19TSVpFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbWFnZVdpZHRoID4gdGhpcy5pbWFnZUhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VIZWlnaHQgPSB0aGlzLmltYWdlSGVpZ2h0ICogKENBTlZBU19TSVpFIC8gdGhpcy5pbWFnZVdpZHRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmltYWdlV2lkdGggPSBDQU5WQVNfU0laRTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZVdpZHRoID0gdGhpcy5pbWFnZVdpZHRoICogKENBTlZBU19TSVpFIC8gdGhpcy5pbWFnZUhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZUhlaWdodCA9IENBTlZBU19TSVpFO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIGltZyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeSA9IFtCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCksIDMpXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaXN0b3J5SW5kZXggPSAwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLkVMUy5pbWFnZUlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkbyhjYjogKCkgPT4gdm9pZCkge1xuICAgICAgICBpZiAodGhpcy5oaXN0b3J5SW5kZXggIT09IHRoaXMuaGlzdG9yeS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICB0aGlzLmhpc3RvcnkgPSB0aGlzLmhpc3Rvcnkuc2xpY2UoMCwgdGhpcy5oaXN0b3J5SW5kZXggKyAxKTtcbiAgICAgICAgfVxuICAgICAgICBjYigpO1xuICAgICAgICB0aGlzLmhpc3RvcnkucHVzaChCaXRtYXAuZnJvbUltYWdlRGF0YSh0aGlzLmdldEltYWdlRGF0YSh0aGlzLkVMUy5pbnB1dCksIDMpKTtcbiAgICAgICAgdGhpcy5oaXN0b3J5SW5kZXgrKztcbiAgICAgICAgdGhpcy5FTFMucmVkby5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuRUxTLnVuZG8uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVuZG8oKSB7XG4gICAgICAgIGlmICh0aGlzLmhpc3RvcnlJbmRleCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuaGlzdG9yeUluZGV4LS07XG4gICAgICAgICAgICB0aGlzLnJlbmRlckltYWdlKHRoaXMuRUxTLmlucHV0LCB0aGlzLmhpc3RvcnlbdGhpcy5oaXN0b3J5SW5kZXhdKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpc3RvcnlJbmRleCA8IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLkVMUy51bmRvLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmhpc3RvcnlJbmRleCA8IHRoaXMuaGlzdG9yeS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5FTFMucmVkby5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWRvKCkge1xuICAgICAgICBpZiAodGhpcy5oaXN0b3J5SW5kZXggPCB0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgdGhpcy5oaXN0b3J5SW5kZXgrKztcbiAgICAgICAgICAgIHRoaXMucmVuZGVySW1hZ2UodGhpcy5FTFMuaW5wdXQsIHRoaXMuaGlzdG9yeVt0aGlzLmhpc3RvcnlJbmRleF0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUluZGV4ID09PSB0aGlzLmhpc3RvcnkubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnJlZG8uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGlzdG9yeUluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuRUxTLnVuZG8uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBBdWRpbygnL2FsZXJ0Lm1wMycpLnBsYXkoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY2xlYXJDYW52YXMoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCkge1xuICAgICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSE7XG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSAnI2NjYyc7XG4gICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0SW1hZ2VEYXRhKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpIS5nZXRJbWFnZURhdGEoXG4gICAgICAgICAgICAoQ0FOVkFTX1NJWkUgLSB0aGlzLmltYWdlV2lkdGgpIC8gMixcbiAgICAgICAgICAgIChDQU5WQVNfU0laRSAtIHRoaXMuaW1hZ2VIZWlnaHQpIC8gMixcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VXaWR0aCxcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VIZWlnaHRcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlckltYWdlKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIGltZzogSFRNTEltYWdlRWxlbWVudCk6IHZvaWQ7XG4gICAgcHJpdmF0ZSByZW5kZXJJbWFnZShjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LCBpbWc6IERyYXdhYmxlKTogdm9pZDtcbiAgICBwcml2YXRlIHJlbmRlckltYWdlKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIGltZzogSFRNTEltYWdlRWxlbWVudCB8IERyYXdhYmxlKSB7XG4gICAgICAgIHRoaXMuY2xlYXJDYW52YXMoY2FudmFzKTtcbiAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xuICAgICAgICBjb25zdCBkeCA9IChDQU5WQVNfU0laRSAtIHRoaXMuaW1hZ2VXaWR0aCkgLyAyO1xuICAgICAgICBjb25zdCBkeSA9IChDQU5WQVNfU0laRSAtIHRoaXMuaW1hZ2VIZWlnaHQpIC8gMjtcbiAgICAgICAgaWYgKGltZyBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCBkeCwgZHksIHRoaXMuaW1hZ2VXaWR0aCwgdGhpcy5pbWFnZUhlaWdodCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHgucHV0SW1hZ2VEYXRhKGltZy50b0ltYWdlRGF0YSgpLCBkeCwgZHkpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCBtYWluID0gKCkgPT4ge1xuICAgIGNvbnN0IGRlbW8gPSBuZXcgRGVtb0FwcCgpO1xuICAgICh3aW5kb3cgYXMgYW55KS5hcHAgPSBkZW1vO1xufTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIG1haW4pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==